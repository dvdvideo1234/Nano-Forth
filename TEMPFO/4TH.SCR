231 EDIT                                                                                                                                                                                        ERWE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ 11 LOAD \ 0 74 LISTS                                                                                                            36 42  THRU  \ MACRO                                                                                                          \ FLOAD AUTO.TX                                                                                                                  \ 2      LOAD  \ STREAM LOADER  \ SHELL                          \  8 9    THRU  \ TOOLS                                         PAGE                                                            CR CR                                                                                                                            .( GLVFORTH V.1.0   2011.03.12  11:50)  CR CR                \  KBD                                                                                                                                                                                                                                                          \   EXPECT3                                                     TO HIDDEN  FORTH  ALSO                                                                                                          FUNC: EXPECT3 ( _ADR _CNT / _IND _K )                             BEGIN  KEY B>W DUP TO _K                                         CASE                                                              cr OF  _IND  TO _CNT ENDOF                                      bs OF _IND                                                        IF AT _IND 1-! bs EMIT SPACE bs EMIT THEN ENDOF               #LEN _K U< IF _K  _ADR  AT _IND @1+! + C! _K EMIT THEN        ENDCASE     _IND _CNT =                                        UNTIL _IND TO SPAN ;                                          \ : TIB? BLK 0= ;                                                 1 2 +THRU     ;METHOD                                                                                                                                                                         \ FREAD  - READ FILE OF TEXT  TO BLOCKS                         \ 210 LOAD  \ EXPECT3                                           FUNC: FREAD ( _NBLK / _ADR _LIN _BLK _HND )                       HANDLES TO _HND  BLK TO _BLK   FOPEN TO HANDLES FIO -1 TO BLK   BEGIN  _LIN  1H 1- =                                              IF AT _NBLK 1+!  0 TO _LIN  0 TO _ADR THEN                           _ADR 0=                                                    IF _NBLK BLOCK DUP 1K BLANK  UPDATE TO _ADR  THEN _LIN          IF _ADR 1L   EXPECT3 CR  THEN                                   1L AT _ADR +!  AT _LIN 1+!                                      _HND  HANDLES =                                               UNTIL   FLUSH  _BLK TO BLK  _NBLK 1+ TO SCR  ;                                                                                                                                                                                                                                                                                \ STREEM EVALUATION  - SEVAL   USING EXPECT3                  \\VARIABLE LINES  ( ' CO ALIAS ;:  210 LOAD)  |                   : OK? BLK IF CO CR ;THEN CR ." ><o " CO SPACE ;                 | : 1LINE OK?  0 TO >IN  TIB 80 EXPECT3 CO                              TIB SPAN + TO 0 TO INTERPRET ;                          | : ?IO DUP NOT IF SIO ;THEN FIO ;                              | : FOPEN HANDLES bs - 0= ?? FOPEN DUP 0< A" OPEN ERR" ;        FUNC: SEVAL ( _HANDLE _NBLK / _IN _BLK _TIB _HND _LINE )           >IN TO _IN   BLK TO _BLK  TIB TO _TIB                           RP 84 - DUP  TO RP  TO TIB    HANDLES TO _HND                   _HANDLE TO HANDLES   _NBLK TO BLK                              BEGIN   AT _LINE 1+!  1LINE  _HND  HANDLES =  UNTIL             _BLK ?IO TO BLK  _TIB TO TIB _IN TO >IN  _LINE LINES +! ;     : ;S HANDLES 0; AT HANDLES BLK 1+ 0= IF CLOSE THEN DROP ;       : FLOAD FOPEN  -1 ?IO SEVAL ;  : KBD  0 0 ?IO SEVAL ;           PRUNE                                                           \  REORDER  OF VOCABULARY                                       VOCABULARY TEMP   0 VALUE P1    0 VALUE P2                      : ?GET1 CONTEXT @ DUP TO P1  ?DUP                                   IF  N>C 2- @ CONTEXT ! THEN ;                               : PUT1  CURRENT @  P1 N>C 2- !  P1 CURRENT ! ;                  : ?SAME CONTEXT CURRENT XOR ;                                   : ?INSERT  CURRENT @ TO P2 P2 P1 U< IF PUT1 ;THEN                 BEGIN P2 DUP PUSH N>C 2- @ TO P2  P1 P2 U<                      WHILE RDROP REPEAT                                              P2  P1 N>C 2- !  P1 POP  N>C 2- ! ;                                                                                           : >LIST  ?SAME 0;  BEGIN ?GET1 P1 WHILE PUT1 REPEAT ;           : XLIST CONTEXT CURRENT TO CONTEXT TO CURRENT ;                 : <LIST  ?SAME 0;  XLIST                                            BEGIN ?GET1 P1 WHILE  ?INSERT  REPEAT XLIST ;                                                                               \ INFIX                                                         VOCABULARY  INFIX   FORTH ALSO INFIX DEFINITIONS                   ' < LIKE > 0 C, 0 C, -1 C,                                     -HEADERS                                                      0 STACK> OPRC HERE 2+ DUP , AT OPRC !  100 ALLOT                : >OPRC> PUSH BEGIN  OPRC DUP R@ < -WHILE DROP OPRC               1 ?, REPEAT TO OPRC RDROP ;                                   : 2-OP RESCAN 0= ?? CREATE IMMEDIATE ,  ,                           DOES> 2@ PUSH PUSH R@ >OPRC> POP POP TO OPRC TO OPRC ;      |  : 1-OP 9 2-OP ;                                                                                                                                                                              -->                                                                                                                                                                                                                                                             \ INFIX 2                                                                                                                         4 2-OP =      5 2-OP <     5 2-OP >                             2 2-OP OR      2 2-OP XOR    3 2-OP AND   7 2-OP MOD            6 2-OP +       6 2-OP -      7 2-OP *     7 2-OP /              1-OP ABS      1-OP NEGATE  1-OP NOT                                                                                           : ( 0 TO OPRC ; IMMEDIATE                                       : ) 1 >OPRC> OPRC DROP ; IMMEDIATE                              ' TO ALIAS =:  IMMEDIATE                                        : )) [',] ) ;METHOD ; IMMEDIATE                                 TO FORTH                                                        : (( ALSO INFIX DEFINITIONS [',] ( ; IMMEDIATE                  ;METHOD       PRUNE                                                                                                                                                                             \ TOOLS: - INDEX COPYBL LISTER   '$    STRING  DEFINITIONS      F83 TO HIDDEN                                                   : INDEX SCR + SCR DO CR I BLOCK I .LINE I 1+ TO SCR LOOP ;      : COPYBL FOR 2DUP COPY 1+ SWAP 1+ SWAP NEXT 2DROP ;             : LISTER 1+ SWAP DO I LIST LOOP ;                                                                                               \ : C"INS SP 1 "INS DROP ;   STRING  DEFINITIONS                : "OVER "N "PUSH ;  : "NIP "SWAP "DROP ;                        : "DEL SWAP "CUT "SWAP "CUT "DROP "+ ;                          : "INSERT "CUT "SWAP "INS "+ ;                                                                                                  \ CALLS AFD                                                     : '$ ' @ $TEST ;                                                F83                                                                                                                                                                                             (  BLOCKS TO FILE   297 314                              )      F83 TO HIDDEN                                                                                                                   : FWRITE   ( FROM_BLOCK  TO_BLOCK / FILE_NAME - )               MAC: C!ADR   PUSH COUNT R@ C! POP 1+ ;                          MAC: !LINE   1L FOR C!ADR NEXT PUSH cr R@ C! POP 1+ ;           MAC: !BLOCK  SWAP PUSH BLOCK POP 1H FOR !LINE NEXT NIP ;        MAC: !BLOCKS PAD -ROT 1+ SWAP DO I !BLOCK LOOP PAD 2- ! ;                                                                          !BLOCKS  FLUSH SCRH TO HANDLES FOPEN TO SCRH                    PAD 2- STR OVER -  1K /MOD SWAP IF 1+ THEN                      FOR DUP DUP PAD -  1K / BLOCK                                       1K CMOVE UPDATE 1K FLUSH +                                  NEXT DROP -USE  AT HANDLES TO SCRH ;                         F83                                                                                                                             ( DO A CALL  CALL A DOS FUNCTION   PERFORM INTERRUPT  #       ) 0 VALUE RAX  0 VALUE RBX  0 VALUE RCX  0 VALUE RDX  0 VALUE RFL CREATE _INT HEX   ASM  21 #, INT, RET,   END-CODE               CODE _CALL BX DI MOV, ' RFL 4 + /// PUSH, POPF,                 ' RAX 4 + /// AX MOV, ' RBX 4 + /// BX MOV, ' RCX 4 + /// CX    MOV,  ' RDX 4 + /// DX MOV,  DI CALL,  AX ' RAX 4 + /// MOV,    BX ' RBX 4 + /// MOV,  CX ' RCX 4 + /// MOV,   DX ' RDX 4 + /// MOV,  PUSHF,  ' RFL 4 + /// POP,    BX POP, NEXT,   END-CODE    : DO_INT [ _INT 1+ ] LITERAL C! _INT _CALL ;                    : DO_DOS 21 DO_INT ;                                            : FCUT ( SCR) 1K M* TO RCX TO RDX  4200 TO RAX SCRH TO RBX         DO_DOS 0 TO RCX 4000 TO RAX DO_DOS ;                         : FSIZE ( SCR) 0 TO RCX 0 TO RDX  4202 TO RAX SCRH TO RBX          DO_DOS  RAX RDX  1K  TO U/MOD NIP ;                          DECIMAL                                                                                                                                                                                         : LISTS 1+ SWAP ?DO I LIST LOOP ;                                                                   EXIT                        : BLONK BLOCK DUP 1K + SWAP DO I C@                                bl < IF bl I C! THEN LOOP UPDATE ;                            : BLONKS 1+ SWAP DO I BLONK UPDATE LOOP FLUSH ;                EXIT                                                                                                                            : GET-ORDER ORDER# WCOUNT 2* CNTDO ?DO I @ 2 +LOOP                          CONTEXT ORDER# @ 1+ ;                               : SET-ORDER 1- DUP ORDER# ! SWAP TO CONTEXT                              FOR R@ 2* ORDER# + ! NEXT ;                            : SEARCH-WORDLIST >R "MAKE -1 SWAP R> FIND                         NEGATE DUP 0= IF NIP THEN ;                                                                                                                                                                  ( PRUNED DICTIONARY ???????  % SWITCH  <%  %>              )                                                                        -HEADERS                                                                 VARIABLE %!%                                       ' HEADER 6 + CONSTANT %?%                                       :  #% @ IF %!% %?% VSWAP THEN TO VSWAP ;                             HEADERS                                                    : <%  0 %!% ! %?% #% ;    ( START HI - CODE WITH NAMES)         : %>  %!% #% ;            ( END HI - CODE)                      | : >BASE CREATE C, IMMEDIATE DOES> BASE PUSH C@ TO BASE                  BLWORD  NUM ?? ?LITERAL POP TO BASE ; IMMEDIATE         16  >BASE $    10  >BASE #   2 >BASE %                           PRUNE           EXIT                                                                       0 QUAN ADDR                       : PATTERN TO ADDR 256 0 DO I 6 FOR DUP                              AT ADDR @1+! C! NEXT DROP   LOOP ;                          \ ?SAME & 2STACK                                                : @== ( A1 A2 -- A1' A2' F)                                         SWAP  COUNT  ROT COUNT  ROT - ;                             : ?SAME ( A1 A2 CNT) FOR @== IF 2DROP R@ 0 LEAVE THEN NEXT ;                                                                    FORGET IT  128 CONSTANT IT CREATE BUF  128 ALLOT                : IDUMP BUF IT DUMP ;  : ICLEAR BUF IT ERASE ; ICLEAR  IDUMP    ' IOV @   1 NM: 4 SWAP @+! 2! ;M   2 NM: -4 SWAP @+! 2@ ;M      3 MAKER 2STACK> ,     BUF 2STACK> BN>                                                                                           ' IOV @   1 NM: -4 SWAP @+! 2! ;M   2 NM: 4 SWAP @+! 2@ ;M      3 MAKER <2STACK ,     BUF IT + <2STACK <BN                                                                                                                                                                                                                                                                                      ( 2STACK                                                      ) FORGET IT  128 CONSTANT IT CREATE BUF  128 ALLOT                : IDUMP BUF IT DUMP ;  : ICLEAR BUF IT ERASE ; ICLEAR  IDUMP    ' IOV @   1 NM: 4 SWAP @+! 2! ;M   2 NM: -4 SWAP @+! 2@ ;M      3 MAKER 2STACK> ,     BUF 2STACK> BN>                                                                                           ' IOV @   1 NM: -4 SWAP @+! 2! ;M   2 NM: 4 SWAP @+! 2@ ;M      3 MAKER <2STACK ,     BUF IT + <2STACK <BN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ TEST -IF                                                                                                                      MARKER MINI                                                                                                                                                                                      : INV -1 XOR ; \ : (-IF DUP 0< IF RP 2+! ;THEN POP @ PUSH ;    \ : -IF DUP 0< [',] IF ; IMMEDIATE                              : TT PUSH INV POP + INV S. ;                                    \ : MAX INV OVER + INV -IF DROP EXIT THEN + ;                   \ : MIN INV OVER + INV -IF + EXIT THEN DROP ;                   \ : U<  INV OVER +  -IF 1 ;THEN 0 ;                             : > INV OVER + INV 0< ;                                         : PROBA TT S. XOR S. ;                                                                                                                                                                                                                                          \ 0 VALUE HDR                                                    : CATCH SP  PUSH     HDR PUSH   RP TO HDR                        EXEC                                                            HDR TO RP    POP TO HDR   RDROP  0 ;                           : THROW ?DUP IF  ( E/ )       POP                                   ( EA /   )  HDR   TO     RP                                     ( EA / SH)  POP   TO     HDR                                    ( EA / S )  POP   -ROT   PUSH                                   ( SE / A )  PUSH  TO SP  DROP   POP                         THEN ;                                                                                                                          : SAFE/  ?DUP IF / ;THEN  5 THROW ;                             : PROBA ['] SAFE/ CATCH IF DROP ." ZERO DIVIDE"  THEN ;                                                                                                                                                                                                        \ TO DO LIST                                                    BLOCK  WORD  FIND   '     [']   ?'    ?,                        [      ]     W"     B"    BZ"   ",    B",  W",  ALLOT           C@     1+    C@T+   C,    FOR   NEXT                            CREATE DOES> HEADER EXEC  ALIAS CFA   VSWAP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     MARKER -SEARCH       10 LOAD                                    : BSEARCH   BLOCK 1024  HERE COUNT  TO -TEXT  ;                 : SEARCH  BLWORD DROP  SCR FSIZE 1+ SWAP                            DO I BSEARCH NIP 1+ IF I EDIT LEAVE THEN  LOOP ;            EXIT                                                            0 VALUE T   0 VALUE #SLOT  0 VALUE WR     : ,2* DUP , 2* ;      : CLIP 2DUP U< IF DROP ;THEN OVER 1+ IF 2DROP 0 ;THEN + ;       CLASS: LSO   NOOP F: POS  ;F 2Z,                                    NOOP F: DATA OVER + + ;F ALLOT                                     5 F: CLIP? @ CLIP  ;F ,2*   ;CLASS                       METHOD: LSO      : POS! CLIP? POS ! ;  : POS@ POS @ ;            : TOP@ POS@ DATA @ ;         : TOP! POS@ DATA ! ;               : !DATA CLIP? DATA ! ;       : @DATA CLIP? DATA @ ;             : POS++ POS@ 1+ POS! ;       : S!+  TOP! POS++ ;                : S@+  TOP@ POS++ ;   : S-!  POS@ 1- POS! TOP! ;  ;METHOD                                                                      ( DO A CALL  CALL A DOS FUNCTION   PERFORM INTERRUPT  #       ) F83   MARKER  -REGS                                             CLASS: REGS:      F: _SP ;F 2Z,  F: _DS ;F   ,  F: _ES ;F   ,    0 F: _BP ;F 2Z,  F: _DI ;F 2Z,  F: _SI ;F 2Z,  F: _DX ;F 2Z,    0 F: _CX ;F 2Z,  F: _BX ;F 2Z,  F: _AX ;F 2Z,  F: _FL ;F 2Z,   ;CLASS                                                          METHOD: REGS:  <% : LABEL: HERE <% CONSTANT %> ;                : SUBF' ' HEADER STR , @ + , COMPILE EXIT ; %> 1 SUBF' _AX _AH   1 SUBF' _BX _BH   1 SUBF' _CX  _CH    1 SUBF' _DX _DH           2 ALIGNED 0 C,      LABEL: JMPA  $ EA C, 4 ALLOT                 LABEL: OSTK 4 ALLOT                                             LABEL: STO_OR         ASM  BP DI MOV,                            AX POP,  SI PUSH,   DI PUSH,  DX PUSH, PUSHF,                    OSTK /// DI LES,  ES PUSH, DI PUSH,  DS PUSH, BX PUSH,          SP OSTK /// MOV,    SS OSTK 2+ ///  MOV,                      BX SI MOV,   AX JMP,       END-CODE       -->                 LABEL: LOD_NR      ASM                                           10 #, CX MOV,  BEGIN, LODSW,  AX PUSH,   CXNZ, NOT,  UNTIL,      DS POP, ES POP, BP POP, DI POP, SI POP, DX POP, CX POP,         BX POP, AX POP, POPF,   RET, END-CODE                                                                                         LABEL: STO_R  ASM   CS: OSTK 4 - /// POP,                         CS: OSTK 2+ /// SS MOV,  CS:  OSTK /// SP XCHG,                 CS: OSTK /// PUSH,  DS PUSH, ES PUSH,   BP PUSH,  DI PUSH,      SI PUSH, DX PUSH, CX PUSH, BX PUSH, AX PUSH,  PUSHF,  CLD,      11 #, CX MOV,  SP BP MOV,  22 /BP DI LES, BEGIN,  AX POP,       STOSW,  CXNZ, NOT, UNTIL,  AX CX MOV,  BX POP, DS POP,          CS AX MOV,   OSTK 2- #, DI MOV,  STOSW, AX POP, STOSW,          AX POP, STOSW,   POPF,  DX POP,  DI POP, SI POP,                 JMPA JMP,  END-CODE                                          -->                                                                                                                             ASM    <% : SWITCH, SP BP XCHG, ; %>   END-CODE                 | CODE _CALL  AX POP,  AH AH OR, 0=, IF,  AL -1 ///  MOV,           HERE 2- TO ON;  STO_OR #, CALL,  LOD_NR #, CALL,  0 INT,        HERE 1- ON; ! ( FIXING .) STO_R #, CALL,                    LABEL: X_CALL  DI BP MOV,  BX POP,  NEXT,  THEN,                  AH -1 /// MOV,  HERE 2- TO ON;                                  AX POP,  AX JMPA 3 + /// MOV,  AX POP,  AX JMPA 1+ ///  MOV,    BP DI MOV, SWITCH, STO_OR 2+ #, CALL, SWITCH, LOD_NR #, CALL,   CS PUSH,  HERE 1- ON; ! ( FIXING ..)                                     JMPA #, CALL,  STO_R #, CALL, SWITCH,                  CX SP MOV,  X_CALL JMP,  END-CODE                             : FCALL $ 0E00 SELF _CALL ; : NCALL ?CS: $ 9000 SELF _CALL ;      : ICALL  $ FF AND  SELF _CALL ;                                 : SHOW CR SELF 11 FOR STR U. NEXT DROP ;                      \ CREATE PROBA ASM 10 #, AX MOV, RET, END-CODE                  ;METHOD    PRUNE                                                MARKER -MVO          \  MINI VECTORS  OBJECT                    CLASS: MVO:  |  0  F: VT ;F ,  |  0 F: VC ;F ,                               |  0  F: VG ;F ,  |  0 F: VA ;F ,    ;CLASS        METHOD: MVO:        0 0 0 1 MVO: 1A                               1 0 0 0 MVO: 1T   0 1 0 0 MVO: 1C   0 0 1 0 MVO: 1G             : V@ VT @ VC @  VG @  VA @ ;   : V! VA !  VG !  VT !  VC ! ;    : V+ DUP PUSH * VA +!  R@ * VG +!  R@ * VC +! POP * VT +!       V@ MIN MIN MIN ?DUP IF DUP 2DUP -1 RECURCE THEN ;             | : 1V+ CREATE , DOES> SWAP PUSH PERFORM  TO SEND V@  POP  V+ ; ' 1T 4 + 1V+ T   ' 1C 4 + 1V+ C ' 1G 4 + 1V+ G ' 1A 4 + 1V+ A     : SHOW VT ? VC ? VG ? VA ? ;                                  ;METHOD      PRUNE                                                                                                                                                                                                                                                                                                                                                                                 ?CS: ?CS: REGS: MVO   MVO DEFINITIONS                           1 _BX !   CREATE TEXT =" 12345890 1234567890 "  'STR,                                                                        : VCALL $ 10 ICALL ;                                            : VTYPE $ 1300 _AX ! _CX ! _BP ! VCALL ;                        : V". COUNT VTYPE ;                                                                                                                                                                             (  nf '("'      ; (" (". ".                                      tLITSTR:dw  jsr2             ;(LIT"                             t_SDOT: DW  JSR3             ;(".                               tSDOT:  DW  JSR3,tSKPs,texit ; ".                                       Dw   tSKPs,tCouNT,tTYPE,texit                          )                                                                                                                               ( 16 CMD FORTH PROJECT  TOP ACC REGISTER                       )( DROP DUP NOP OVER SWAP LIT @+ !+ + XOR AND PUSH POP ; IF CAL ): +JUMP POP @+ + PUSH ;  MAC: JUMP  "LIT PUSH EXIT", , ;        : ;: POP XCHG PUSH ;                                            : INV -1 XOR ;    : NEGATE INV 1 + ;  : - NEGATE + ;            : (MOVE PUSH @+ SWAP POP !+ ;                                   : (?FOR IF -1 + POP SWAP PUSH 1 + PUSH EXIT                             THEN DROP POP @+ + PUSH  ;                              : (NEXT POP POP  IF -1 + PUSH @+ + PUSH  EXIT                                    THEN DROP @+ PUSH DROP ;                       : MOVE ?FOR (MOVE NEXT DROP DROP ;                              : COUNT @+ -1 + SWAP 255 AND ;                                  : TYPE ?FOR COUNT EMIT NEXT DROP ;                                                                                                                                                                                                                              ( DROP DUP NOP OVER SWAP LIT @+ !+ + XOR AND PUSH POP ; IF CAL )( COUNT 0= C@ C!  A! A @A !A !A+ @A+ SP! SP@ RP! RP@ OR INV      U/MOD UM* +C 2/ U2/C ;: (EXEC BLIT (VECT (?FOR (NEXT            (-IF (IFC (JB+ (JA NATIVE  )                                   : 2SWAP PUSH -ROT POP -ROT ;                                    : (DOVAR POP ;                                                  : (DOVAL! POP 4 + ! ;                                           : (DOCON LIT ;                                                  : (DOVECT                                                       : (?FOR XCHG C@+% POP IF 1- PUSH DROP PUSH ;THEN DROP + PUSH ;  : (NEXT POP C@+% POP IF 1- PUSH + PUSH ;THEN DROP DROP PUSH ;   : MOVE SWAP A! ?FOR WCOUNT !A+ NEXT DROP ;                      : TYPE ?FOR COUNT EMIT NEXT DROP ;                              : (VECT POP COUNT DUP -ROT + @ SWAP PUSH PUSH ;                                                                                                                                                 ( MACROSES )                                                    : @ @+ DROP ;                                                   : ! !+ DROP ;                                                   : WCOUNT @+ SWAP ;                                              : SWAP! SWAP ! ;                                                : XCHG POP SWAP PUSH ;                                          : NIP SWAP DROP ;                                               : RDROP POP DROP ;                                              : RNIP  POP RDROP PUSH ;                                        : ROT PUSH SWAP POP SWAP ;                                      : -ROT SWAP PUSH SWAP POP ;                                     : 2DUP OVER OVER ;                                              : 2DROP DROP DROP ;                                                                                                                                                                                                                                             ( NOP  CALL   NEXT  IF     -IF   IFC    UNEXT INV                 DROP DUP    +     +C     2/    U2/C   XOR    AND                ;    JUMP   A!    A      BCHG  XCHG   PUSH  POP                 @A   !A     !A+   @A+    @P+   !P+    @B+   -!B   )           : SWAP PUSH XCHG POP ;      : -ROT SWAP PUSH SWAP POP ;         : 2* DUP + ;   : 2*C DUP +C ;      : NIP PUSH DROP POP ;        : OVER PUSH DUP XCHG POP ;  : TUCK DUP -ROT ;                   : ;: POP XCHG PUSH ;   : 1+ 1 + ;  : 2DUP OVER OVER ;           : MOVE  PUSH A! BCHG DROP  BEGIN @B+ !A+ UNEXT ;                : +* A 2/ DROP IFC OVER + THEN U2/C A U2/C A! ;                 : UM* A! 0 15 FOR +* NEXT PUSH A POP ;                          : -/ A 2* A! 2*C 2DUP + IFC A 1+ A! NIP ;THEN DROP ;            : (U/MOD PUSH NEGATE SWAP A! POP 15 FOR -/ NEXT PUSH A POP ;    : U/MOD 0 (U/MOD ;  : UMOD U/MOD DROP ; : U/ U/MOD NIP ;        : UM/MOD TUCK U/MOD PUSH (U/MOD POP ;                           : B! BCHG DROP ; : B BCHG DUP PUSH BCHG POP ;                                                                                                                                                     : TRACE ' TR EXEC TO TR ; IMMEDIATE                             ' EXIT 4 + ALIAS BYE                                            : C" TO WORD 1+ C@ [',] LITERAL ; IMMEDIATE                     : ['] ' ?C TO , AT , , ; IMMEDIATE                              : 1Z, 0 C, ;                                                    : ( C" ) WORD DROP ; IMMEDIATE                                  : LIKE @ HEADER , ;    ' bl LIKE 1K  1024 ,                     : -HEAD AT HERE SPTR 1K AT 2* - AT VSWAP TO ! 0 TO HEADER ;     -HEAD                                                           : NM: NEGATE HERE SWAP [TO] DOES> HERE 2- AT + ] ;              : M: HERE AT , [ ' WORD @ 1+ DUP @ + 2+ , ] [AT] DOES> ] ;      : JM: M: 5 HERE 2- AT + ;                                       : LBL: HEADER TO , [ ' INTERPRET 2+ @ , ]  ] ;                                                                                                                                                                                                                  ' (" 4 + ALIAS ".  ' (" 2+ ALIAS (".                            : LINK+ HERE TO >< , ;                                          : W, TO COUNT , ;    ' >MARK 4 + ALIAS 2Z,                      : N,   (FOR [ >MARK ]  ,       TO (FOR [ TO >MARK ]  ;          : NW,  (FOR [ >MARK ]  W,      TO (FOR [ TO >MARK ]  ;          : STR, (FOR [ >MARK ] COUNT C, TO (FOR [ TO >MARK ] DROP ;      : MAKER CREATE DUP C,  N, ' , DOES> COUNT HEADER NW, AT EXEC ;                                                                AT FORTH 2- DUP @ SWAP  2- DUP @ SWAP 2- @ 3 MAKER MAKEVOC 2 Z,   : WORDLIST VOCLINK LINK+ ;                                      : VOCABULARY TO FORTH MAKEVOC WORDLIST ;                                                                                                                                                                                                                                                                                        MAKEVOC MACROS     2Z,                                          VOCABULARY HIDDEN                                               VOCABULARY ASSEMBLER                                                                                                            ' bl       @  1 MAKER CONSTANT ,                                ' SCRH  TO @  2 MAKER VALUE ,                                   ' INITW TO @  2 MAKER VECTOR ,                                  : PREVIOUS  AT ORDER# TO CONTEXT ;                              : ALSO CONTEXT TO ORDER# ;                                      : DEFINITIONS CONTEXT TO CURRENT ;                              : ONLY ORDER# TO 0 FORTH ALSO MACROS ALSO HIDDEN ALSO ;         ONLY                                                                                                                                                                                                                                                                                                                                                                                           (       FLOAD CONSTANT.TX )                                                                                                       1028 CONSTANT B/BUF                                               16 CONSTANT 1H                                                  31 CONSTANT #LEN                                                64 CONSTANT 1L                                                                                                                                                                                                                                               1 TO HEADER                                                     : 'C CREATE , IMMEDIATE DOES>  ?C @ ,  C" " WORD ", ;                                                                                                                                                                                                                                                                            ' IOV @  ' SCRH  TO @ 1- SWAP 1- SWAP 3 MAKER QUAN  ,           ' IOV @  1 NM: AT 2+ ! ;M 2 NM: AT 2- @ ;M 3 MAKER STACK> ,     ' IOV @  1 NM: AT 2- ! ;M 2 NM: AT 2+ @ ;M 3 MAKER <STACK ,     ' IOV @  1 MAKER VARIABLE 2Z,                                                                                                    256 DUP <STACK ON; ,   ( "," FOR FAST COMPARING BELOW)                                                                                                                                                                                                       (        FLOAD ENGINEM.TX       )                                                                                                                                                                  0 VALUE MH                                                      HERE C" ; STACK> MAC: ,                                                                                                                                                                         : EXECUTE >R ;                                                                                                                4 TO HEADER                                                       TIB DUP <STACK MS ,                                              : SWAPH    HERE MH TO HERE TO MH ;                           LBL: >IO_POS  TO >IN TO BLK TO INTERPRET [                      LBL: _TEVAL   0 SWAP TIB - >IO_POS [                                                                                              0 NM: BLK >R >IN >R EXECUTE R> TO >IN R> TO BLK ;M                                                                              HEADER         LOAD , ] 0 >IO_POS [                             ' LOAD LIKE    EVAL   ] _TEVAL [                                                                                                  0  ( SAVE PLACE FOR "C"-STYLE STRING "LENGTH" PROCEDURE )                                                                                                                                       M: TO MH AT MACROS ! ;M                                         M: AT MACROS @ MH ;M                                          HEADER MAC , , ,                                                                                                              1 TO HEADER                                                       : MAC> CREATE AT MAC: @  WORD COUNT STR, 1Z,                         IMMEDIATE DOES>                                                 AT DROP BLK >IN TO MS TO MS _TEVAL ; AT ALLOT            : >MAC SWAPH CURRENT >R TO MACROS EXEC R> TO CURRENT SWAPH ;                                                                       M: ['] MAC> >MAC ;M                                             ' MAC: !                                                        : ?MAC ' 2+ AT MAC TYPE ;                                       M: AT MAC: @ [',] C" AT MAC: ! MAC: AT MAC: ! ;M                                                                                                                                                ' MAC: 2+ !                                                     : -MAC TIB DUP AT MS TO ! 0 MPTR TO MAC ;                    LBL: _EOL AT MS TO @ - 0; MS MS >IO_POS [                            -MAC ' _EOL TO                                                                                                                                                                                                                                            (        FLOAD MACRO.TX)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -MAC F83          \ WORK WITH F1.COM :==: NOW FORTH.COM          MAC: RECOVER AT ALLOT;        MAC: CELL+ 2+ ;                   MAC: >RESOLVE TO >MARK;       MAC: CELL- 2- ;                   MAC: WCOUNT TO COUNT;         MAC: CELLS 2* ;                   MAC: DABS TO ABS;             MAC: BYTES NOOP ;                 MAC: SCIND TO SCLST;          MAC: BYTE+ 1+ ;                   MAC: SCANW TO SCAN;           MAC: BYTE- 1- ;                   MAC: WBLK TO NBLK;            MAC: BYTE 1 ;                     MAC: VBLK AT NBLK;            MAC: CELL 2 ;                     MAC: OPEN TO FOPEN;           MAC: XCHG POP SWAP PUSH ;         MAC: FCLOSE TO CLOSE;         MAC: >BODY 2+ ;                   MAC: ?EXEC TO EXEC;           MAC: COMPILE, , ;                 MAC: PERFORM AT EXEC;         MAC: /STRING /STR ;                                             MAC: -@! TO @+! ;                 MAC: C@W TO C@;               MAC: SELF! TO SELF ;                                                                                                                                              MAC: ?BRANCH TO (BR;    MAC: @+ WCOUNT SWAP ;                   MAC: DCOMPILE TO D,;    MAC: #IF DUP IF ;                       MAC: DLIT AT D,;        MAC: ~IF DUP 0=  IF ;                   MAC: COMPILE TO ,;      \ MAC: -IF DUP 0< IF ;                  MAC: LIT AT ,;          MAC: TILL 0= UNTIL ;                    MAC: BCOMPILE TO C,;    MAC: ~WHILE ~IF ;                       MAC: BLIT AT C,;        MAC: C@+ COUNT SWAP ;                   MAC: RP! TO RP;         MAC: ODD 1 AND ;                        MAC: CNTDO AT (DO;      MAC: BSELF BLOCK SELF! ;                MAC: 4TH> TO LEAVE;     MAC: %IF DUP ODD IF ;                   MAC: BREAK. AT LEAVE;   \ MAC: -WHILE -IF ;                     MAC: HOLD TO HLD;       MAC: #WHILE #IF ;                       MAC: BRANCH (BR;                                                                                                                                                                                                                                                MAC: CMOVE> TO CMOVE;                                           MAC: MOVE AT CMOVE;                                             MAC: DNEGATE TO NEGATE;                                         MAC: TUCK AT DUP;                                               MAC: ?KEY TO EMIT;                                              MAC: J TO I;                                                    MAC: K AT I;                                                    MAC: HI TO B>W;                                                 MAC: 2OVER TO OVER;                                             MAC: PICK AT OVER;                                              MAC: D+ TO +;                                                   MAC: +! AT +;                                                   MAC: -ROT TO ROT;                                               MAC: ROLL AT ROT;                                                                                                               MAC: BLWORD TO WORD;          MAC: 2DROP TO DROP;               MAC: RDROP AT DROP;                                             MAC: 2DUP TO DUP;                                               MAC: 2SWAP TO SWAP;                                             MAC: FLIP ><;                                                   MAC: 1-! TO 1-;                                                 MAC: 1-!@ AT 1-;                                                MAC: 2-! TO 2-;                                                 MAC: 2-!@ AT 2-;                                                MAC: 1+! TO 1+;                                                 MAC: @1+! AT 1+;                                                MAC: 2+! TO 2+;                                                 MAC: @2+! AT 2+;                                                MAC: vUSER AT U0;             MAC: EX CO ;                                                                                                                                                                                                                      MAC: UF2 TO U-FUNC;                                             MAC: UF4 AT U-FUNC;                                             MAC: D- TO -;                                                   MAC: HEAD HEADER;                                               MAC: 2^ TO SHIFT;                                               MAC: 2! TO !;                                                   MAC: 2@ TO @;                                                   MAC: 0MIN TO MIN;                                               MAC: PACK TO UNPACK;                                            MAC: @UNPACK AT UNPACK;                                         MAC: PC2+ TO PC1+;                                              MAC: XOR! TO XOR;                                               MAC: | 1 TO HEADER;                                             MAC: HEADERS 0 TO HEADER;                                                                                                                                                                       MAC: -HEADERS -1 TO HEADER;                                     MAC: ON TO -1;                                                  MAC: OFF TO 0;                                                  MAC: AT-XY GOTOXY;                                              MAC: R>M AT 2/;                                                 MAC: NOT -1 XOR;                                                MAC: LATEST AT CURRENT N>C; MAC: RUN LATEST EXEC;               MAC: SMUDGE AT IMMEDIATE;  ( MAC: | NOOP;  ( DONGLE)            ( MAC: -HEADERS NOOP;  )    MAC: REVERCE AT ><;                 MAC: N>LINK N>C 2-;         MAC: V>LINK   2-;                 TO MAC: ! ;THEN EXIT THEN !                                       MAC: PUSH >R ;              MAC: POP R> ;                       MAC: U/ U/MOD NIP ;         MAC: UMOD U/MOD DROP ;                                                                                                                                                                          MAC: NP USING NP.SCR;               MAC: PYG USING PYGMY.SCR;   MAC: NEWH USING HACKNEW.SCR;        MAC: TC USING TCOMP.SCR;    MAC: ROOT USING 4TH.SCR 42 LIST;    MAC: OLDF USING 4TH2.SCR;   MAC: KER  USING KERNEL.SCR;         MAC: SRC  USING SOURCE.SCR; MAC: CLR  USING COLOR.SCR;          MAC: TCN  USING TCOMP2.SCR; MAC: NCLR USING NCOLOR.SCR;         MAC: EDI USING NP.SCR 226 EDIT ;  MAC: DEAS USING DESASM.SCR;   MAC: PP  DOS COMMAND /C P FLOAD MIN.F;                          MAC: LMI USING ASM386.SCR;  MAC: MINI DOS MINI;                 MAC: FRT1 USING FRT01.SCR;                                      MAC: EDF3 ED NF3.ASM;                                           MAC: EDF2 ED NF2.ASM;                                                                                                                                                                                                                                                                                                         ( COMPILE.TX)                                                     : WITHIN OVER - >R - R> U< ;  : ?BLK 1 -1 WITHIN ;              : CLARY HERE OVER ERASE ALLOT ;                                 : BARY HEADER TO , [ ' ORIGIN+ 2+ @ 2+ 2+ , ] CLARY ;           | : ARRAY CREATE , DOES> HEADER  @ ,                                  HERE DUP PUSH 2- EXEC POP - CLARY ;                       ' ORIGIN+ 2+ @ 2+    ARRAY WARY                                 ' ORIGIN+ 2+ @       ARRAY QARY                                 ' ORIGIN+ 2+ @ 2-    ARRAY 5ARY                                 ' ORIGIN+ 2+ @ 2- 2- ARRAY TARY                               ' (". 'C ."         ' (" 'C "          ' ABORT 2+ 'C  A"        : 'STR, DUP C, STR, ;                                           : ," TO WORD ", ;                                               : .( C" ) WORD ". ; IMMEDIATE                                   : 0" HERE 2+ [',] " 1Z, TO 1+ ; IMMEDIATE                                                                                       (        FLOAD CONTROL.TX)                                                                                                      : BLKNL 1L 1- OR 1+ ;           : SKIPL -1 WORD DROP ;          : >HERE >MARK HERE ;   : ,>MARK  , TO >MARK ;                   : <MARK HERE TO ON; ;  : ,<MARK ON; , ;                                                                                         : (( HEADER COMPILE [ ' DO: @ , ] , , IMMEDIATE ;               ' >MARK ' (BR       (( SKIP   ' >MARK    ' (BR 2+     ((   IF   ' >MARK ' (BR 2+ 2+ (( -IF    ' >MARK 2+ ALIAS THEN  IMMEDIATE  : ELSE [',] SKIP  SWAP [',] THEN ; IMMEDIATE                    : \ BLK ?BLK IF >IN BLKNL TO >IN ELSE SKIPL THEN ;  IMMEDIATE   ' ,<MARK ' (BR     ((  AGAIN    ' ,<MARK ' (BR 2+  ((   UNTIL   ' ,<MARK ' (BR 2+ 2+ (( -UNTIL  ' -IF  ALIAS -WHILE IMMEDIATE   ' <MARK ALIAS  BEGIN IMMEDIATE  ' IF ALIAS   WHILE  IMMEDIATE                                                                                                                                                                                                   : REPEAT  [',] AGAIN [',] THEN ; IMMEDIATE                      ' >HERE  ' (DO     ((  DO       ' >HERE  ' (DO 2+  (( ?DO       ' ,>MARK ' (LP     ((  LOOP     ' ,>MARK ' (LP 2+  (( +LOOP     ' >MARK  ' (FOR    ((  FOR      ' >MARK 2+  ' (FOR 2+  (( NEXT                                  ' >MARK   ' (OF  ((   OF                                                                        : CSP! CSP SP TO CSP ;                                          : ?CSP SP CSP - A" SP CHG!" TO  CSP ;                           ' CSP! ALIAS CASE  IMMEDIATE                                    ' ELSE   ALIAS  ENDOF   IMMEDIATE                               : ENDCASE TO , DROP  BEGIN SP CSP -                               WHILE [',] THEN  REPEAT TO CSP ; IMMEDIATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \        FLOAD MAKERS.TX                                                                                                         TO HIDDEN                                                                                                                       ( WITH-ADDR  ROOTLINK_ADR WITH-ADDR  - )                         M: ( FIXLINX) BEGIN OVER TO >< ?DUP -UNTIL DROP ;M  TO ON;   0 NM: AT CURRENT N>C OVER ( FIXLINX) [ >MARK TO ON; ] TO 0 ;M                                                                       1 NM: LINK+ ;M                                                2 MAKER RECUR ,                                                                                                                 TO FORTH                ( AT RECURCE - FIXLINX)                   0 RECUR RECURCE  HERE ON; !  ON; ,  IMMEDIATE                                                                                                                                                                                                                                                                                     M: ON; >R ;M       ( THIS IS "AT CO")                           M: R> TO ON; AT ,  [ >MARK TO ON;   ] TO ON; ;M                 ' RP 4 + @ (  v--       --v  "DO" ">RELEASE" TRICKY WAY)    TO HIDDEN                                                       HEADER CO  3 N,  HERE 2- ON; !                                                                                                  TO FORTH                                                        : ; [',] ; [TO] RECURCE                                              BEGIN AT ON; TO @ - WHILE ON; EXEC REPEAT ; IMMEDIATE                                                                                                                                     \                                                                                                                                                                                                                                                              \  (CELL SIZE LEN STRING  WORDS) STRINGS.TX  STR  TO STR=S!     \ STR (A - A' N)=WCOUNT  TO STR ( A1 N A2 - )  = S!             TO HIDDEN                                                                                                                         : S+C! ( C A - ) SWAP PUSH RP 1 ROT  AT STR RDROP ;             : "T SPTR STR ; ( -- A N )   : "N SPTR STR + STR ;              : "DROP "T + TO SPTR ;                                          : "POP ( A --) "T ROT SWAP CMOVE "DROP  ;                       : "ALLOT ( N -- N A )  DUP 2+ AT SPTR TO @+! ;                  : "BUFF  ( C N -- ) "ALLOT ! "T ROT FILL ;                    : "PUSH  ( A N -- ) "ALLOT OVER PUSH 2+ SWAP MOVE POP SPTR ! ;    : "INS   ( A N -- ) "T PUSH TO SPTR "PUSH POP SPTR +! ;         | : ?INS" ( C -) CREATE C, DOES> PUSH SP POP C@ "INS DROP ;     1 ?INS" C"INS       2 ?INS" W"INS                                                                                                                                                               \ AT STR ( A1 N A2 - )  = S+!                                 : ">' SPTR "DROP COUNT OVER C! ;    : NUP PUSH DUP POP ;        : 2REV DUP PUSH NUP REVERCE NUP REVERCE POP REVERCE ;           : "SWAP SPTR 2 FOR DUP STR + NEXT 2REV ;                        : "CUT ( N --) "T ROT 2DUP 0 WITHIN -IF DROP DUP THEN ( A N N)    -ROT PUSH 2DUP + 2- TO SPTR SWAP "PUSH POP SPTR @ - "T + ! ;  : "+ "SWAP "T "DROP "INS ;   : '>" COUNT "PUSH ;                : =' C" " WORD '>" ">' ;     : =" =' COUNT ;                    : "EVAL "PUSH 0 1 "BUFF "+ "T DROP EVAL "DROP ;                 : "OVER "N "PUSH ;  : "NIP "SWAP "DROP ;                        : "DEL SWAP "CUT "SWAP "CUT "DROP "+ ;                          : "INSERT "CUT "SWAP "INS "+ ;                                                                                                   0. "PUSH  0.  "PUSH    ( EMPTY STACK ELEMENT )     TO FORTH                                                                                                                                    \   BARY PAD SPACES <# #> # #S SIGN D# D.R D. .R . U.           : DIG. ALPHA EMIT ;  : PAD HERE 320 + ; : 1H. 1H 1- AND DIG. ;    : SPACES TO MAX FOR SPACE NEXT ;     : 1B. 1H /MOD 1H. 1H. ;  : 1W. UNPACK 1B. 1B. ;  : 1D. 1W. 1W. ;    : .H 1W. SPACE ;       : UM/MOD TUCK U/MOD PUSH  SWAP TO U/MOD POP ;                   : 1# BASE UM/MOD  AT HLD 1+! ;                                  : S# AT HLD  OFF BEGIN 1# 2DUP OR -UNTIL 2DROP ;                : D# IF DABS S# -10 AT HLD 1+! EXIT THEN S# ;                   : D.R PUSH D# POP HLD - SPACES HLD FOR DIG. NEXT ;            : D. S>D 0 D.R SPACE ; : . S>D D. ; : .R PUSH S>D S>D POP D.R ; : U.R  0 0 ROT D.R ; : UD. 0 0 D.R SPACE ; : UD.R 0 SWAP D.R ;  : #>" S# HLD "ALLOT ! "T CNTDO DO ALPHA I C! LOOP ; : U. 0 D. ; : N>" 0 #>" ;                                                   : A>" BASE PUSH HEX N>" N>"  C" : C"INS  "+  POP TO BASE ;                                                                                                                                       \        FLOAD CMD.TX                                          : "P>OS "PUSH bl C"INS "+ ">' SHELL ;  : FED " EDT" '>" "P>OS ; : REMOVE " DEL" '>" "P>OS ;         | : CMD0  CREATE =" 'STR, ;   | : CMD1N CMD0 DOES> '>" ?CS: A>" "T "DROP "P>OS ;              | : CMD2" CMD0 DOES> '>" =" "P>OS ;                             CMD2" DOS COMMAND /C"                                           CMD2" ED EDT"                                                   CMD2" DIR DIR /O"                                               CMD2" DEL DEL"                                                  CMD2" CD CD"                                                    CMD2" RD RD"                                                    CMD2" REN REN" ( CMD1" CLS CLS")                                CMD2" ATEST ..\AFD.COM"                                         CMD1N $TEST ..\AFD.COM"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \        FLOAD LOCALS.TX                                         ( ARGS /ARGS  ?END                                            )                                                                                                                                                                                                 ONLY HIDDEN ALSO FORTH DEFINITIONS                              : /LOCALS COMPILE [ 1 FRM , ] ; IMMEDIATE                                                                                       TO HIDDEN                                                       : ?END >IN  >R BLWORD COUNT 1-     IF DROP -1 ELSE C@ THEN         SWAP COUNT  ROT SCAN 1+ DUP   IF RDROP ELSE R> TO >IN THEN   ;                                                               | : 1VAR DUP 1 9 WITHIN                                                                                                                                                                             IF LIT [ 7 FRM @ , ] SWAP AT 2* NEGATE + ALIAS                  ELSE HEADER 2 FRM W, W, W, 2* NEGATE , IMMEDIATE THEN       ;                                                               MAC  CSP!                                                                                                                       MAC: LVAR  ['] 1VAR >MAC ;                                                                                                                                                                                                                                     \ FLOAD  LOCALMAC.TXT                                                                                                                                                                            ( USE MACRO LOCALS                                            )                                                                                                                                                                                                 MAC: CADR 7 FRM @ SWAP 8 * -; MAC: SADR CADR 2+ , ];            MAC: LOC/ [ 6 FRM , ];        MAC: /LOC [ 1 FRM , ];            MAC: LADR CADR , ];           MAC: ^ADR CADR 4 + , ];           MAC: L1@ [ 1 LADR;   MAC: L1! [ 1 SADR;   MAC: L1 [ 1 ^ADR;     MAC: L2@ [ 2 LADR;   MAC: L2! [ 2 SADR;   MAC: L2 [ 2 ^ADR;     MAC: L3@ [ 3 LADR;   MAC: L3! [ 3 SADR;   MAC: L3 [ 3 ^ADR;     MAC: L4@ [ 4 LADR;   MAC: L4! [ 4 SADR;   MAC: L4 [ 4 ^ADR;     MAC: L5@ [ 5 LADR;   MAC: L5! [ 5 SADR;   MAC: L5 [ 5 ^ADR;     MAC: L6@ [ 6 LADR;   MAC: L6! [ 6 SADR;   MAC: L6 [ 6 ^ADR;     MAC: L7@ [ 7 LADR;   MAC: L7! [ 7 SADR;   MAC: L7 [ 7 ^ADR;     MAC: L8@ [ 8 LADR;   MAC: L8! [ 8 SADR;   MAC: L8 [ 8 ^ADR;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ( (ARGS LOCALS( PROC                                          )                                                                 | : (ARGS  1 769 LOC/                                             BEGIN 0" /)" ?END DUP 2 < ( 0 WRD 1 /)                          WHILE IF L1@ IF 0 L1! ELSE 1 A" / >1 ?" THEN                          ELSE  L2@ 1+ DUP L2!  LVAR  L1@                                    IF L3 ELSE L4 THEN    1+!                                    THEN                                                      REPEAT DROP  L3@ L4@ PACK /LOC                                ;                                                               ?CSP TO MAC      TO FORTH                                                                                                                                                                                                                                       : LOCALS( (ARGS COMPILE [ 0 FRM , ] ,                           ; IMMEDIATE                                                                TO FORTH                                             : ':  HEADER DO: ;                                              : : MAC CSP! : TO CO ?CSP TO MAC ;                              : :: :  RECOVER  ['] INTERPRET STR , @ , ;                                                                                        8 FRM ALIAS RETURN  ( DEFINE RETURN PROCEDURE )               : FUNC: : RECOVER  ( MOVE H BACK 1 CELL TO CLEAR XNEST)           C" ( BLWORD 1+ C@ =? (ARGS                                          COMPILE [ 5 FRM @ , ] ,    TO CO                                RECOVER ( EXIT TOKEN )   COMPILE RETURN  ;                 F83                                                                                                                                                                                                                                                                                                                                                                                           \        FLOAD MISC.TX                                                                                                           ( FIXES ON WORDS)                                               : ALIGN 1- SWAP 1- OR 1+ ;                                      : RESCAN >IN -FIND ROT TO >IN ;                                                                                                   M: RESCAN NIP 0; CR   HERE ". ."  EXIST ! "                       BLK 1- 0>= 0; ." IN BLK " BLK .  ;M                                                                                           260 !   ( 104 IN HEX)                                                                                                                                                                                                                                         M: DUP BEGIN COUNT -UNTIL 1- OVER - ;M      ' MAC 4 + !                                                                         : .. BASE PUSH DECIMAL .R POP TO BASE ;                         : HOME 0 0 GOTOXY ;                                             : PAGE (CLSC HOME ;                                             : ?EMIT DUP bl < IF DROP C" . THEN EMIT ;                       : ?TYPE FOR COUNT ?EMIT NEXT DROP ;                             : .LINE 3 .. SPACE 1L ?TYPE ;                                   : .BLOCK CR ." Scr# " SCR 6 .. 1H 0                                   DO CR DUP I .LINE 1L + LOOP DROP ;                        : CTRL TO WORD 1+ C@ #LEN AND [',] LITERAL ; IMMEDIATE                                                                                                                                                                                                                                                                                                                                         \        FLOAD DEBUG.TX                                                                                                          : TRACE ' TR EXEC TO TR ; IMMEDIATE                             : WW DUP H. DUP @ DUP H. ?ID. 2+ ;  ( DEBUG ONE ADDRESS)        | : DUMPLINE  CR DUP 1W. 1H 2DUP FOR COUNT SPACE 1B.            NEXT DROP SPACE C" [  EMIT ?TYPE C" ] EMIT ;                    : DUMP 1H ALIGN 1H / FOR DUP DUMPLINE 1H + NEXT DROP ;          \ : 'W DUP H. TO COUNT DUP H. ;                                 \ : 'B DUP H. COUNT DUP H. ;                                    \ : 'S DUP H. DUP ". COUNT + ;                                  : WDS FOR CR WW NEXT ;  : SEE ' 2+  1H WDS ;                    : ? @ . ;                                                       ( : #S. 2- OVER MAX ?DO I @ . -2 +LOOP ;)                       | : #S. CR ".                                                                                                                                                                                   [     MAC: -WCOUNT 2- DUP @ ;                                         MAC: ?ITEMS TO DUP - NIP 2 / 1- ;                               MAC: ?STACK DUP 0< A" STACK UNDERFLOW" ;                  ]   ?ITEMS ?STACK FOR -WCOUNT . NEXT DROP C" ] EMIT ;           : S. S0 SP " S[ " #S. ;  : R. R0 RP " R[ " #S. ;                                                                                                                                                                                                               \        FLOAD BLOCKS.TX                                                                                                          0 NM: C@ PREV C! ;M  DUP     TO HIDDEN                           HEADER DISCARD ,   0 C,     TO FORTH                            HEADER UPDATE  ,  -1 C,                                                                                                                                                                                                                                       TO HIDDEN                                                       : EMPTY-BUFFERS FIRST LIMIT OVER - ERASE                            LIMIT FIRST DO  -1 I 1+ ! B/BUF +LOOP ;                                                                                     EMPTY-BUFFERS                                                   | : +BUF B/BUF + DUP LIMIT = IF DROP FIRST THEN DUP PREV - ;    | : BUFFER USE DUP >R  BEGIN +BUF UNTIL TO USE R@ COUNT            IF DUP TO COUNT TO NBLK 0 R@ C! THEN  R@ TO PREV ! R> 3+ ;   : SAVE-BUFFERS LIMIT FIRST ?DO I C@ IF I COUNT I TO XOR             TO COUNT TO NBLK THEN B/BUF +LOOP ;                         : -USE SCRH 1+ IF SCRH CLOSE DROP -1 TO SCRH THEN ;             TO FORTH                                                        : FLUSH SAVE-BUFFERS EMPTY-BUFFERS ;                            : USING FLUSH -USE FOPEN TO SCRH ;                                                                                                                                                              : BLOCK >R PREV DUP 1+ @ R@ - IF                                   BEGIN +BUF 0=  IF DROP R@ BUFFER DUP R@ NBLK 2- 1- THEN           DUP 1+ @ R@ =                                                 UNTIL   DUP TO PREV  THEN                                         AT DROP 3+ DERR ?DUP                                            IF CR DISCARD ." I/O ERROR " . 0 TO DERR ABORT THEN ;          ' BLOCK  ' NBLK 10 + !                                                                                                      : LIST DUP TO SCR  BLOCK .BLOCK ;                               | : ?LD BLK 0= A" LOADING?" ;                                   : --> ?LD 0 TO >IN BLK 1+ TO BLK ; IMMEDIATE                    : COPY  SWAP BLOCK SWAP BLOCK 1K CMOVE UPDATE FLUSH ;           : THRU  1+ SWAP  DO I LOAD LOOP ;                               : +THRU BLK DUP D+ THRU ;                                                                                                                                                                                                                                                                                                                                                                      \        FLOAD FORGET.TX                                                                                                        0  VALUE FENCE                                                   : forget   DUP FENCE                                               U< A" fence !" >R  (  - R@ )                         BEGIN  VOCLINK                                               (      - )                  @ ?DUP R@ U<                                               (  -     ?)                                -WHILE @ VOCLINK !                                           (    -      )                                                                                                                                                REPEAT                                                          VOCLINK                                                      (      - )                 BEGIN DUP 2-                                                 (         )                     BEGIN @ DUP                                                ( -     -   )                 R@ U<                                                    ( -  -     ?)                                -WHILE N>C 2-                                              ( -    -   )                              REPEAT                                                     ( -    -v  )                                        OVER 2- !                                                                                                                                                                                  (    )                                           @ ?DUP                                                     (      ?)                                   -UNTIL  FORTH                                                 ( FORTH -> CONTEXT)                                                TO FORTH  R>                                                 ( FORTH -> CURRENT)                                                TO HERE                                                      ( R>    -> HERE   )                                                DROP ;                                                       ( VOCLINK @ )                                                   : FORGET ' C>N DROP forget ;                                    HERE TO FENCE                                                                                                                                                                                 \        FLOAD WORDS.TX                                         : WORDS  CR 10 TO CSP CONTEXT  -1 0 DO @ ?DUP                        IF DUP                                                             C@ 31 AND 6 + OUTC + 80 <                                       -IF CR CSP ?DUP                                                    IF 1- TO CSP                                                    ELSE  10 TO CSP KEY B>W 27 =                                       IF DROP I " LISTED"  LEAVE THEN                              THEN                                                         THEN         DUP .H DUP ID.                                     1H OUTC OVER MOD ?DUP                                           -IF DUP THEN -     DUP 13 < -IF DROP 1 THEN                         OUTC 64 < -IF 1- THEN SPACES                                N>C 2-                                                       ELSE CR I " TOTAL" LEAVE THEN                                 LOOP ". ."  WORDS = " . ;                                                                                                                                                                      \      FLOAD CLASS.TX                                          \        FLOAD PRUNE.TX                                          F83                                                                                                                                                                                             \ : WORD. DUP H. ID. ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ : VOC. 2- C>N DROP CR ." VOCABULARY : " WORD. ;               \ : VOCS. VOCLINK BEGIN ?DUP                                    \      WHILE DUP 2-  VOC. @ REPEAT ;                            \ : WORDS.  DUP VOC. BEGIN @ ?DUP                               \      WHILE DUP WORD. N>LINK REPEAT ;                          \ : HERE<.  DUP VOC. BEGIN @ ?DUP WHILE DUP                     \      HERE U<  IF DUP WORD. THEN N>LINK REPEAT ;               \ : HERE>.  DUP VOC. BEGIN @ ?DUP WHILE DUP                     \      HERE U< -IF DUP WORD. THEN N>LINK REPEAT ;               \ : ALL-W. VOCLINK BEGIN ?DUP                                   \      WHILE DUP V>LINK WORDS. @ REPEAT ;                                                                                       : PRUNE VOCLINK                                                  BEGIN    DUP  >R                                                                                                                                                                               \                                                   V>LINK                                                   \                                          BEGIN @ DUP                                                  \                                           HERE U<                                                     \      >= HERE                                          -WHILE N>LINK REPEAT                                          \                                               DUP R@ V>LINK !                                              \          < HERE                                                                             \                                      ?DUP IF DUP >R                                                                                                                                                                            \      -                                     BEGIN N>LINK                                               \                                                         @ ?DUP                                                    \                                                               WHILE DUP HERE U<                                          \         < HERE                                   IF DUP R>                                                \                                                        N>LINK                                               \                                                   ! DUP >R                                               \                                                                      THEN                                                                                                                                                                                     \                                                                    REPEAT                                                     \                                                                    0 R> N>LINK !                                              \                                         THEN                                                         \                                                                R> @ ?DUP -UNTIL                                               \                                                   -HEAD                                                          ;                                                                                                                                                                                                                                                                                                                             -MAC FORGET REG                                                  0 VALUE REG   MAC: PUSH >R ;   MAC: POP R> ;                   TO MAC: ! ;THEN EXIT THEN !     MAC: RDROP POP DROP ;           MAC: NOT -1 XOR ;      : NEW0; DUP -IF RDROP THEN ;             : IN+ >IN + TO >IN ;   : SOURCE BLK AT NBLK >IN + AT MAC ;      FUNC: ?WS ( A1 L1 ) A1 L1 FOR COUNT 33 U<                             -IF DROP R@ NOT L1 + RETURN THEN NEXT DROP L1 ;           FUNC: ?NWS ( A1 L1 D1 / C1 ) A1 L1 DUP TO C1 FOR COUNT D1 =           IF R@ TO C1 LEAVE THEN NEXT DROP C1 NOT L1 + ;            \ EXIT  !!                                                      : PARSE TO REG SOURCE NEW0; REG 33 U<                                IF ?WS IN+ SOURCE NEW0; THEN  REG ?NWS                          DUP 0< IF DROP SOURCE DUP IN+ ;THEN                          PUSH SOURCE  1+ IN+ POP ;                                                                                                                                                                     \ HEADER                                                        :1 HEADER :089A A ?DUP                                                 IF 1- TO HEADER HERE TO CFA ALIAS TO VSWAP ;THEN            TO CREATE HERE TO CFA ;                                                                                                      :1 CREATE :136A HEADER COMPILE :02D8 ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          : :C ' COMPILE COMPILE , ; IMMEDIATE                            : :X ' , ; IMMEDIATE                                            : :N BASE BLWORD NUMBER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (  TIME DATE                                                  ) MARKER -TIME                                                    : LIST: CREATE DOES> SWAP 255 AND TO SCLST ;                    LIST: DAYS ,"  ,"  ,"  ,"                         ,"  ,"  ,"  ," ?           CODE DOS4 ( DX CX BX AX - DX CX BX AX ERROR )                    BX AX MOV, BX POP, CX POP, DX POP, 33 #, INT,                   DX PUSH, CX  PUSH, BX PUSH, AX PUSH, BX BX SBB, NEXT, END-CODE : DOS13 DUP DUP DUP DOS4 TO DERR NIP ;                          : GET-TIME $ 2C00 DOS13 DROP ;                                  : GET-DATE $ 2A00 DOS13 7 AND ;                                 : .TIME GET-TIME UNPACK . . UNPACK . . ;                        : .DATE GET-DATE DAYS ". SPACE . UNPACK . . ;                                                                                                                                                                                                                   : LIST: CREATE DOES> SWAP 255 AND TO SCLST ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    FUNC: FPLACE ( ADDRESS BLOCKS / OLDSCRH NBLK1 )                   FLUSH                                                             SCRH TO OLDSCRH   -1 TO SCRH  USING   BLOCKS 1- TO NBLK1        BLOCKS FOR NBLK1 R@ - BLOCK ADDRESS 1K 2DUP + PUSH CMOVE                 POP TO ADDRESS NEXT                                  FLUSH                                                            -USE  OLDSCRH TO SCRH ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      MARKER -PROBA   -HEADERS 0 QUAN SRSADR  | 0 VALUE SRSOFS        : ADR! TO SRSADR ;  : OFS! TO SRSOFS ; : ADR? SRSADR ; -HEADERS : OFS- SRSOFS - ; : SADR@ SRSADR OFS- ;   0 VALUE LASTBYTE       0 VALUE NOSHOW  0 VALUE LASTCMD 0 VALUE LASTADR  1 2 +THRU     : ?SHOW NOSHOW IF RDROP THEN ;                : OFS+ SRSOFS + ; | : SADR+ AT SRSADR +! ;  : SADR! OFS+ TO SRSADR ; -HEADERS     : GETBYTE SRSADR COUNT TO LASTBYTE TO SRSADR ;                  : GETWORD SRSADR WCOUNT TO LASTCMD TO SRSADR ;                  : ?N CREATE C, DOES> COUNT LASTCMD TO SCAN 1+ ;                 : 2SHOW GETWORD ?SHOW ." | " LASTCMD DUP H. OFS+ ?WORD ;        : 4SHOW GETWORD LASTCMD TO LASTBYTE ?SHOW                          LASTCMD LASTBYTE OVER OVER H. H. D. ;                        : 1SHOW GETBYTE ?SHOW LASTBYTE  DUP H. C/NUM ;                  : 3SHOW 1SHOW GETWORD SADR@ LASTCMD + C/NUM ;                   : "SHOW GETBYTE LASTBYTE SADR+ ?SHOW ADR? LASTBYTE - 1- "STR" ;               3 4 +THRU     PRUNE     $ 8000 ADR! $ 7F00 OFS!   \ ?EMIT ?TYPE DUMPLINE DUMP                                     : >EMIT? 33 127 WITHIN ;                                        : 'C CREATE [',] C" C, DOES> C@ EMIT ;                            'C `" "     'C `' '     'C `# #                                 'C `[ [     'C `] ]     'C `. .                               : #NUM `# 0 .R SPACE ;    : 'CHAR' `' EMIT `' SPACE ;           : "STR"  `" COUNT ?TYPE `" SPACE ;                              : ?STACK POP WCOUNT SWAP PUSH SP PUSH ?EXEC  POP SP - #NUM ;    : UNNEST POP RDROP RDROP RDROP PUSH ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           : C/NUM DUP >EMIT? IF 'CHAR' ;THEN #NUM ;                       : ?STR C>N 0= IF 1 ;THEN      \ CODE TO NAME                           COUNT DUP 31 AND       \ A N  #LEN                              SWAP 96 AND            \ A #LEN  &96                            OVER 0= OR             \ A (1)  ((2)  (1) 0=) OR                IF DROP ;THEN          \ A CNT / A  INVALID LENGTH              FOR COUNT >EMIT?       \ A' C                                     0= IF UNNEST ;THEN   \ A' - UNPRINTABLE CHARACTER             NEXT DUP XOR ;         \ 0  - OK                         : ?WORD DUP ?STR IF OFS- C/NUM ;THEN ?ID. ;                                                                                                                                                                                                                                                                                                                                                                                                                     (   2 ?N IS_1+? ] BLIT BCOMPILE [  1 ?N IS_3+? ] ;code [          11 ?N  IS_2+? ] (BR TO (BR AT (BR (FOR LIT (OF (DO TO (DO         (LP TO (LP COMPILE [  2 ?N  IS_4+? ] DCOMPILE DLIT [           3 ?N IS_STR? ] TO ABORT (" TO (" [                           )                                                                  2 ?N IS_1+? ] BLIT BCOMPILE [                                   1 ?N IS_3+? ] ;code [                                          11 ?N  IS_2+? ] (BR TO (BR AT (BR (FOR LIT (OF (DO TO (DO         (LP TO (LP COMPILE [                                           2 ?N  IS_4+? ] DCOMPILE DLIT [                                  3 ?N IS_STR? ] TO ABORT (" TO (" [                                                                                                                                                                                                                                                                                                                                                           | : WW CR SADR@ H. 2SHOW        IS_2+?  IF 2SHOW  ;THEN             IS_4+?  IF 4SHOW ;THEN      IS_3+?  IF 3SHOW  ;THEN             IS_STR? IF "SHOW ;THEN      IS_1+?  IF 1SHOW  THEN ;        : L WW WW WW WW WW WW WW ;                                      : H CR SADR@ H. 1H FOR GETBYTE LASTBYTE 1B. SPACE NEXT               `[ ADR? 1H - 1H ?TYPE `] ;                                 : LH  H H H H H H H ;                                           : @SEE SADR! L ;                                                : SEE ' @SEE ;                                                  : 'SEE SADR+ SADR@ N>C DUP SADR! ?WORD L ;                      : +SEE SADR+ L ;                                                : /SEE -14 SADR+ ;                                              : .SEE SADR@ PUSH L POP SADR! ;                                                                                                                                                                                                                                 ( 286 MNEM  0-A1 1-A2 234-SH 5-G1 6-G2 7-G3)                                                                                    ," 0 ," 1 ," 2 ," 3 ," 4 ," 5 ," 6 ," 7                         ," ROL  ," ROR  ," RCL  ," RCR  ," RAR  ," SHL ," SHR           ," ADD  ," ADC  ," AND  ," XOR  ," OR   ," SUB  ," SBB  ," CMP  ," NOT  ," NEG  ," MUL  ," IMUL ," DIV  ," IDIV ," INC  ," DEC  ," LES  ," LDS  ," LEA  ," ESC  ," MOVMS                        ," CALL ," CALLF ," JMP ," JMPF   ," ARPL ," BOUND              ," XCHG ," PUSH ," POP  ," TEST ," MOV                                                 ," MOVMI  ," IMULMI  ," PUSHI            ," ADDI ," ADCI ," ANDI ," XORI ," ORI  ," SUBI ," SBBI ," CMPI           ," MOVRI                                              ," MOVA  ," TESTA                                               ," PUSHR ," POPR  ," INCR ," DECR ," XCHGR                      ," PUSHS  ," POPS                               -->                                                                             ( MNEMONICS 2) ," AL ," CL ," DL ," BL ," AH ," CH ," DH ," BH  ," AX ," CX ," DX ," BX ," SP ," BP ," SI ," DI                 ," ES  ," CS ," SS ," DS ," GS ," FS                            ," OFS  ," ADR  ," LOCK ," REP  ," REPZ ," PROT ," SAHF         ," <POP> ," <PUSH> ," POPF  ," PUSHF ," RET  ," RETF  ," IRET   ," CBW  ," CWD  ," INTO ," INT3  ," XLAT  ," LEAVE    ," NOP    ," CLI  ," STI  ," CLD  ," STD  ," CMC  ," CLC  ," STC          ," AAA  ," DAA  ," DAS  ," AAS  ," HALT ," WAIT ," LAHF         ," INT ," AAM ," AAD ," DFB ," INP ," OUTP ," IN ," OUT         ," MOVS ," CMPS ," SCAS ," LODS ," STOS ," INS  ," OUTS         ," JO   ," JNO  ," JB   ," JNB  ," JE   ," JNE  ," JBE  ," JNBE ," JS   ," JNS  ," JP   ," JNP  ," JL   ," JNL  ," JLE  ," JNLE ," JMPS ," JCXZ ," LOOP ," LOOPE ," LOOPNE ," CALLI ," JMPI     ," RETI ," RETFI  ," ENTER ," CALLFI ," JMPFI  ," ???                                                                                                                                           ( DISASM MAIN SCREEN                                          )  VOCABULARY DISASM   TO DISASM   ALSO DISASM                     0 QUAN IP                                                              \    -HEADERS                                                                                                           CREATE OPNAMES  -1 C,    ( SPECIAL 255 COUNT OF WORDS FIRST)      90 LOAD  ( OPNAMES)      <%                                   : IND? OPNAMES COUNT ROT SCLST ;                                : OP, TO WORD IND? 1+ ?DUP IF 1- C, ;THEN 1 ?? ;                : MO,  OP, 1- FOR  HERE 1- C@ C, NEXT ;                         : ROW,  8 FOR OP, NEXT ;                                        : [OP,] COMPILE BLIT OP, ; IMMEDIATE                            : VALUES FOR 0 VALUE NEXT ;                                     %>         =' ???" IND?  1+ OPNAMES C!                                                                   -->                                                                                    ( DISASM TABLE SCR 1                                   HEX   )  0 BARY OPTBL                                                    <% : ?OP CR BLK . HERE 0 OPTBL - DUP . H. ;  %>                  4 MO, ADD   2 MO, ADDI   OP, PUSHS    OP, POPS  ( 08)           4 MO, OR    2 MO, ORI    OP, PUSHS    OP, PROT  ( 10)           4 MO, ADC   2 MO, ADCI   OP, PUSHS    OP, POPS  ( 18)           4 MO, SBB   2 MO, SBBI   OP, PUSHS    OP, POPS  ( 20)           4 MO, AND   2 MO, ANDI   OP, ES       OP, DAA   ( 28)           4 MO, SUB   2 MO, SUBI   OP, CS       OP, DAS   ( 30)           4 MO, XOR   2 MO, XORI   OP, SS       OP, AAA   ( 38)           4 MO, CMP   2 MO, CMPI   OP, DS       OP, AAS   ( 40)          \ ?OP                                                            8 MO, INCR  8 MO, DECR   8 MO, PUSHR 8 MO, POPR ( 60) -->                                                                                                                                                                                                      ( DISASM TABLE SCR 2                                   HEX   )  ROW,  <PUSH>  <POP>  BOUND  ARPL   FS  GS  OFS  ADR      ( 68)  ROW,  PUSHI  IMULMI  PUSHI  IMULMI  INS  INS  OUTS  OUTS ( 70)  ROW,   JO    JNO   JB   JNB     JE  JNE   JBE  JNBE      ( 78)  ROW,   JS    JNS   JP   JNP     JL  JNL   JLE  JNLE      ( 80)  ROW,  0    0    1    1   TEST   TEST    XCHG    XCHG   ( 88)    ROW,  MOV   MOV   MOV  MOV   MOVMS   LEA   MOVMS   POP ( 90)      OP, NOP   7 MO, XCHGR                                ( 98)    ROW, CBW  CWD  CALLFI WAIT   PUSHF  POPF  SAHF  LAHF   ( A0)    4 MO, MOVA    2 MO, MOVS   2 MO, CMPS                  ( A8)    2 MO, TESTA   2 MO, STOS   2 MO, LODS   2 MO, SCAS     ( B0)                  16 MO, MOVRI                             ( C0)    ROW,  2  2  RETI  RET      LES  LDS  MOVMI  MOVMI      ( C8)    ROW, ENTER  LEAVE  RETFI  RETF  INT3  INT  INTO  IRET  ( D0)                                                              -->                                                                           ( NN = ESC 6)                                           ROW,   3   3   4   4   AAM   AAD  ???  XLAT          ( D8)      ROW,   ESC  ESC  ESC  ESC  ESC  ESC   ESC   ESC      ( E0)      ROW, LOOPNE LOOPE LOOP JCXZ  INP  INP  OUTP  OUTP    ( E8)      ROW, CALLI  JMPI JMPFI JMPS  IN   IN   OUT   OUT     ( F0)      ROW,  LOCK   ???   REP    REPZ   HALT   CMC   5   5  ( F8)      ROW,  CLC    STC    CLI   STI    CLD    STD   6   7  ( 100)      ?OP                                                            ROW,   ADD  OR   ADC  SBB  AND  SUB  XOR  CMP                   ROW,   ADD  ???  ADC  SBB  ???  SUB  ???  CMP                   ROW,   ROL  ROR  RCL  RCR  SHL  SHR  ???  RAR                   ROW,   TEST ???  NOT  NEG  MUL  IMUL DIV  IDIV                  ROW,   INC  DEC CALL CALLF JMP  JMPF PUSH ???                   ROW,   INC  DEC  ???  ???  ???   ???  ??? ???                          0 C, 1 C, 2 C, 2 C, 2 C, 3 C, 4 C, 5 C,                                                            -->                   ( OPERATION GROUPS )                                            0 BARY GROUPS ( SECONDARY BYTE OPCODE GROUPS)                     OP, 0       ( GROUP OF GROUPS 0)                                OP, ROL     ( MEM/R,R    1 )                                    OP, LES     ( R,MEM      2 )                                    OP, MOVMS   ( MEM/R,IMM  3 )                                    OP, MOVMI   ( MEM/R,IMM  3 )                                    OP, ADDI    ( A,IMM      4 )                                    OP, MOVRI   ( R,IMM      5 )                                    OP, MOVA    ( A,MEMORY ADDRESS  6 )                             OP, PUSHR   ( WORD REGISTER OPERATION ONLY  7 )                 OP, PUSHS   ( SEGMENT REGISTER OPERATION ONLY  8 )                                                      -->                                                                                                                                                                                                                   ( GROUPS   SECOND )                                             OP, AL OP, ES ( ONE BYTE OPCODES PREFIX  9 10)                    OP, SAHF    ( ONE BYTE OPCODES ONLY    11)                      OP, INT     ( ONE BYTE IMMEDIATE       12 )                     OP, INP     ( AREG ONEBYTE IMMEDIATE   13 )                     OP, IN      ( AREG STRING OPERATIONS   14)                      OP, JO         ( ONE BYTE RELATIVE BRANCH  15 )                 OP, CALLI      ( TWO BYTES RELATIVE BRANCH 16 )                 OP, RETI       ( IMMEDIATE  16             17 )                 OP, ENTER      ( IMM 16 , IMM 8            18 )                 OP, CALLFI     ( IMM 16 , IMM 16 SWAPPED   19 )                  -1 C,  ( NO OPERATION ASSIGNED - DEFINE BYTE / END)                0 QUAN FLAGS                                                                                          -->                                                                                                                                                 ( OP PROCS                                                    ) 10 VALUES OPC  OPI  DISP  IMMED  RMF  MF  RF IP1  GNI  GADR     : _OP. OPNAMES 1+ SWAP TO SCLST ". ;  : @BYTE AT IP  AT 1+ C@ ; : @WORD AT IP AT 2+ @ ;            : @SBYTE AT IP AT 1+ TO C@ ; : F-SET FLAGS OR TO FLAGS ; : F-CLR -1 XOR FLAGS AND TO FLAGS ; : F-GET FLAGS AND ;         : F-FLIP FLAGS XOR TO FLAGS ;       : XREG CREATE DOES> C@ SWAP [OP,] 7 AND + [OP,] AL + _OP. ;       XREG BREG. 0 C,  XREG WREG. 8 C,  XREG SREG. 16 C,            0 NM: @ F-SET ;M 1 NM: @ F-GET ;M  2 MAKER XSET ,                1 XSET XW   2 XSET XD   64 XSET XM                             256 XSET XO   512 XSET XWO  4 XSET XIS  16 XSET XA              128 XSET XR   32  XSET XI   8 XSET XG                           ( VARIABLE DISP   VARIABLE FLAGS  ( xxxxcc#ORMIAGSDW )          ( M=r/m; cc=reg count; I=immediate; A=accumulator; G=seg;)      ( S=imm.size; D=direction;  W=word or byte; R= REGISTER )       ( #=DISP.SIZE O=ONLY.DISP)                      -->             ( MOD R/M FIELD PERFORM)  : OFFS! TO XO TO XM TO DISP ;         : #D16 @WORD OFFS! TO XWO ;   : #D8 @SBYTE OFFS! ;              0 BARY ATBL  30 C, 31 C, 46 C, 47 C, 6 C, 7 C, 5 C, 3 C,        : R/R MF ATBL C@ 8 U/MOD ?DUP IF WREG. THEN C" / EMIT WREG. ;   : _IMM TO XI XIS -IF @WORD ;THEN @SBYTE ;   : ;SPC CO SPACE ;   : REL? _IMM IP + TO IMMED ; : IMM? _IMM TO IMMED ;              : IM8  TO XIS IMM? ;    : RELB TO XIS REL? ;                    : IM1 TO XIS TO XI 1 TO IMMED ; : IM? XW -IF TO XIS THEN IMM? ; : MEM?  @BYTE 1L /MOD TO RMF  8 /MOD TO RF TO MF   RMF CASE          0 OF  MF 6 = IF #D16 THEN  ENDOF                                1 OF  #D8   ENDOF      2 OF  #D16  ENDOF ENDCASE ;         : -SEG.  XW IF WREG. ;THEN BREG. ;                              : OPR? -IF IP1 TO IP [OP,] DFB TO OPI 12 TO GADR IM8                   RDROP THEN  ;  -->                                                                                                                                                                                                                                       : ?WB. IF 1W. ;THEN 1B. ;                                       : ;DISP CO ;SPC "  +/" XWO IF DROP "  //" THEN ". ;             : ;IMM CO  ;SPC "  B#" XIS -IF DROP "  W#" THEN ". ;            : IMM.  XI 0;   ;IMM    IMMED  XIS 0= ?WB. ;                    : DISP. XO 0;   ;DISP   DISP XWO ?WB. ;                         : ?REG. XG -IF -SEG. ;THEN SREG. ;    : RG. ;SPC RF ?REG. ;     : MR. ;SPC XM -IF -SEG. ;THEN                                    DISP. RMF -IF MF 6 - -IF ;THEN THEN R/R ;                       : MR/R. ['] RG. ['] MR.  XD IF SWAP THEN EXEC  EXEC ;          : XGTBL CREATE DOES> OVER + + PERFORM ;                         : _ROP 7 AND TO RF ;   : SEGOP TO XG OPC AT 2/ _ROP ;           : ROP TO XW OPC _ROP ; : AREG  0 TO RF 6 TO MF 0 TO RMF ;       : REL. IMMED 1W. SPACE ;  : FARI. REL. DISP 1W. SPACE ;         : AR,M AREG #D16 ;          : A,I AREG IM? ;                -->                                                                                                                                 : R,I ROP 8 OPC AND -IF 1 F-CLR THEN IM? ;                      : D,I8 #D16 IM8 ;                                               : D,I16 #D16 IMM? ;                                             : D,I. DISP. REL. ;                                             : R,I. REL.  RG. ;                                              : MR,I. MR. IMM. ;                                              : MR,CL. MR. 1 BREG. SPACE ;                                    : R16,M XM OPR? TO XD TO XW ;                                   : SEG,M XM OPR? TO XG ;                                         : AR. ;SPC 0 ?REG. ;                                            : PREF. POP CO C" : EMIT PUSH ;                                 : A,IM8 AREG IM8 ;                                                                                                                                                                     -->                                                                      \              0     1     2     3     4      5    6    7       XGTBL G2B@OP ] IM?   IM8   IM8   IM1   NOOP   NOOP NOOP NOOP [  XGTBL G2B.OP ] MR,I. MR,I. MR,I. MR,I. MR,CL. MR.  MR.  MR.  [  : XG2B  GNI G2B@OP ;   : XG2B. GNI G2B.OP ;                     XGTBL G@OP  ]                                                   \ O1    0       ROL     LES     MOVMS   MOVMI   ADDI    MOVRI           XG2B    NOOP    R16,M   SEG,M   IM?     A,I     R,I     \ O2    MOVA    PUSHR   PUSHS   AL      ES      SAHF    INT             AR,M    ROP     SEGOP   NOOP    NOOP    NOOP    IM8     \ O3    INP     IN      JO      CALLI   RETI    ENTER   CALLFI          A,IM8 NOOP    RELB    REL?    IMM?    D,I8    D,I16  [                                                                  XGTBL G.OP  ]  XG2B.  MR/R.  MR/R.  MR/R. MR,I. R,I.  R,I.        MR/R.  RG.    RG.   NOOP   PREF.  NOOP  IMM.  R,I.              AR.    REL.   REL.  IMM.   D,I.   FARI. [         -->                                                                         ( @OP .OP  GNI-GROUP.NAME.INDEX OPI-OPERATION.NI              ) : @OP IP TO IP1 @BYTE DUP  3 AND TO FLAGS  DUP TO OPC OPTBL C@     DUP DUP TO OPI TO GNI     [OP,] PUSHI <  IF MEM? THEN          0 BEGIN 1+ GNI OVER  GROUPS C@ < UNTIL 1- DUP  TO GADR         -IF 256 OPTBL DUP GNI + 48 + C@ 8 * + RF + C@ TO OPI THEN       OPI [OP,] ??? - OPR?  GADR G@OP ;                              : .OP CR @OP IP1 DUP 1W. BEGIN SPACE COUNT 1B. IP OVER =          UNTIL DROP  BEGIN SPACE OUTC 24 = UNTIL GADR G.OP OPI _OP. ;  : ND FOR .OP NEXT ;  : 'DIS TO IP 10 ND ;                       : DIS ' @ 'DIS ;     : L 20 ND ;                                                                                                \  PAD PATTERN  PAD 'DIS                                                                                                                                                                                                                                                                                                        ( DISASM TABLE SCR 1                                   HEX   )  HEX  OPT OPCODES                                                00  R, ADD, ADD, ADD, ADD, ADDI, ADDI,  SPUSH,  SPOP,           08  R,  OR,  OR,  OR,  OR, ORI,  ORI,   SPUSH,  PROT,           10  R, ADC, ADC, ADC, ADC, ADCI, ADCI,  SPUSH,  SPOP,           18  R, SBB, SBB, SBB, SBB, SBBI, SBBI,  SPUSH,  SPOP,           20  R, AND, AND, AND, AND, ANDI, ANDI,   ES,  DAA,   ( ES)      28  R, SUB, SUB, SUB, SUB, SUBI, SUBI,   CS,  DAS,   ( CS)      30  R, XOR, XOR, XOR, XOR, XORI, XORI,   SS,  AAA,   ( SS)      38  R, CMP, CMP, CMP, CMP, CMPI, CMPI,   DS,  AAS,   ( DS)      40  R, INCR, INCR, INCR, INCR, INCR, INCR, INCR, INCR,          48  R, DECR, DECR, DECR, DECR, DECR, DECR, DECR, DECR,          50  R, PUSHR, PUSHR, PUSHR, PUSHR, PUSHR, PUSHR, PUSHR, PUSHR,  58  R, POPR, POPR, POPR, POPR, POPR, POPR, POPR, POPR,                                                                 -->                                                                      ( DISASM TABLE SCR 2                                   HEX   )  60  R, PUSHA,  POPA, BOUND,  ARPL,    FS,    GS,   OFS,   ADR,  68  R, PUSHI, IMULMI, PUSHI, IMULMI, INSB, INSW, OUTSB, OUTSW,  70  R,    JO,   JNO,    JB,   JNB,    JE,   JNE,   JBE,  JNBE,  78  R,    JS,   JNS,    JP,   JNP,    JL,   JNL,   JLE,  JNLE,  80  R, AROP1   AROP1  AROP2  AROP2  TEST,  TEST,  XCHG,  XCHG,  88  R,   MOV,   MOV,   MOV,   MOV,  SMOV,   LEA,  SMOV,   POP,  90  R,   NOP,    XR,    XR,    XR,    XR,    XR,    XR,    XR,  98  R,   CBW,  CWD, CALLFI,  WAIT, PUSHF,  POPF,  SAHF,  LAHF,  A0  R,  LDAL,  LDAX,  STAL,  STAX, MOVSB, MOVSW, CMPSB, CMPSW,  A8 R, TESTAL, TESTAX, STOSB, STOSW, LODSB, LODSW, SCASB, SCASW, B0  R,  LIR,  LIR,  LIR,  LIR,  LIR,  LIR,  LIR,  LIR,          B8  R,  LIR,  LIR,  LIR,  LIR,  LIR,  LIR,  LIR,  LIR,          C0  R, SHFTOP  SHFTOP RETI,   RET,   LES,   LDS, MOVMI, MOVMI,  C8  R, ENTER, LEAVE, RETFI,  RETF,  INT3,   INT,  INTO,  IRET,                                               -->                D0 R, SHFTOP  SHFTOP SHFTOP SHFTOP   AAM,   AAD,  ???,  XLAT,   D8 R,   ESC,  ESC,  ESC,  ESC,  ESC,  ESC,   ESC,   ESC,        E0 R, LOOPNE, LOOPE, LOOP, JCXZ,  INP,  INP,  OUTP,  OUTP,      E8 R, RCALL,  RJMP, JMPFI, SJMP,  IN,   IN,   OUT,   OUT,       F0 R,  LOCK,   ???,   REP,  REPZ, HALT,   CMC,  GRP1  GRP1      F8 R,  CLC,    STC,    CLI,   STI,    CLD,    STD, GRP2 GRP3                                                                    DECIMAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         MARKER  -DIS   : ERR CSP $ 3689 ! E ;                           : OPT CREATE DOES> OVER + + @ ;                                 : '/,    '   ,   ;                                              : R, DROP 8 FOR '/, NEXT ;                                      : CREATOR FOR CREATE NEXT ;                                     38 CREATOR                                                         ADD,  OR,   ADC,  SBB,  AND,  SUB,  XOR,  CMP,                  ADDI, ORI,  ADCI, SBBI, ANDI, SUBI, XORI, CMPI,                 INCR,  DECR,  PUSHR, POPR,  XR,  LIR,                            JO,   JNO,    JB,   JNB,    JE,   JNE,   JBE,  JNBE,            JS,   JNS,    JP,   JNP,    JL,   JNL,   JLE,  JNLE,                  -->                                                                                                                                                                                                                                                                                                                   112 CREATOR                                                      PUSHA, POPA, FS, GS, OFS, ADR,   NOP,   CBW,  CWD,   WAIT,      PUSHF,  POPF,  SAHF,  LAHF, LOOPNE, LOOPE, LOOP, JCXZ,                              STOSB, STOSW, LODSB, LODSW, SCASB, SCASW,  RET, RETF, INT3, INT, INTO,  IRET,  MOVSB, MOVSW, CMPSB, CMPSW,   DAA, AAS, DAS,  ESC, CLC,   STC, CLI, STI, CLD,  STD,          SPUSH, SPOP,  SEG, SMOV,  CALLFI, LDAL, LDAX, STAL, STAX,      AAA, AAM,  AAD,  XLAT,  LOCK,  REP, REPZ, HALT,  CMC,           CALLF,  JMPF, PROT,   BOUND, ARPL, IMULMI,                      ROL,  ROR,  RCL,  RCR,  SHL,  SHR,  RAR,  INS, OUTS,            TEST, NOT,  NEG,  MUL,  IMUL,  DIV, IDIV, XCHG,                 INC,  DEC, CALL,  JMP, PUSH,  ???,  MOV,  LEA, POP,             TESTAL, TESTAX,   INP, OUTP,  IN, OUT,                           RETI,   LES,   LDS, LEAVE, RETFI,   MOVMI,                      ENTER, RCALL,  RJMP, JMPFI, SJMP,   PUSHI,                                  -->                                                : R, DROP  8 FOR ' , NEXT ;                                                                                                     OPT GRUPS                                                         0   R,  ADD,  OR,   ADC,  SBB,  AND,  SUB,  XOR,  CMP,          8   R,  ADD,  ???,  ADC,  SBB,  ???,  SUB,  ???,  CMP,         16   R,  ROL,  ROR,  RCL,  RCR,  SHL,  SHR,  ???,  RAR,         24   R, TEST, ???,  NOT,  NEG,  MUL,  IMUL,  DIV, IDIV,         32   R,  INC,  DEC, CALL, CALLF, JMP, JMPF, PUSH,  ???,         40   R,  INC,  DEC,  ???,   ???, ???,  ???,  ???,  ???,                                                                                104 LOAD                                                                                                                                                                                                                                                                                                                                                                                ( ENDBLOCK BLK>TXT )                                            MARKER -TXT                                                                                                                     FUNC: BLK>CHECK ( _BLK / _FIX ) _BLK BLOCK 1- 1H                  FOR 1L + DUP C@ bl XOR  IF  AT _FIX 1+! THEN NEXT DROP _FIX ; FUNC: CHECK ( BLK> >BLK / _FIX )  >BLK BLK> - 1+                   FOR >BLK R@ - BLK>CHECK IF AT _FIX 1+! >BLK R@ - . THEN         NEXT   _FIX IF ." PROBLEMS TOTAL = " _FIX THEN ;                                                                             : 1BLK>TXT BLOCK 1- 1H FOR 1L + OVER OVER C! NEXT DROP UPDATE ; : BLK>TXT ( CHR NBLK) FOR R@ 1BLK>TXT NEXT FLUSH ;                                                                                                                                                                                                                                                                                                                                              MARKER  -DIS   : ERR CSP $ 3689 ! E ;                           : OPT CREATE DOES> OVER + + @ ;      0 VALUE SRCADR             0 VALUE OPCODE  0 VALUE RMF     0 VALUE OPNAME  0 VECTOR ^OP    0 VALUE IMMED   0 VALUE WFLAG   0 VALUE DIRFLAG                 0 VALUE REGNUM  0 VALUE OFFSET  0 VALUE STARTADR                                                                                : @CHAR+ SRCADR  COUNT SWAP TO SRCADR ;                         : CHAR>BYTE 0 OVER PACK S>D NIP UNPACK NIP PACK ;               : @BYTE+ @CHAR+  CHAR>BYTE ;  : ?NAME 2- C>N DROP ;             : @WORD+ SRCADR WCOUNT SWAP TO SRCADR ; : ADR+. SRCADR + H. ;   : OPNAME! ?NAME TO OPNAME ;   : OPNAME.  OPNAME ID. ;           : OP! OPNAME! SRCADR TO STARTADR  @CHAR+  DUP TO OPCODE                DUP 2 AND TO DIRFLAG  1 AND TO WFLAG  0 TO REGNUM           0 TO OFFSET  0 TO IMMED ;                                    -->                                                                                                                             : WORDREL  CREATE DOES> OP! @WORD+ ADR+. ;                      : BYTEREL  CREATE DOES> OP! @BYTE+ ADR+. ;                      : SELF. CREATE DOES> 2- C>N DROP ID. ;                          : DEFS FOR DUP EXEC NEXT DROP ;                                 : SIMPLE CREATE DOES> OP! ;    SELF. []                         ' SELF. 28 DEFS AX CX DX BX SP BP SI DI AL CL DL BL AH CH DH BH ES CS SS DS [BX+SI] [BX+DI] [BP+SI] [BP+DI] [SI] [DI] [BP] [BX]                                                                 OPT REGISTER. ] AL CL DL BL AH CH DH BH                            AX CX DX BX SP BP SI DI                ES CS SS DS            [BX+SI] [BX+DI] [BP+SI] [BP+DI] [SI] [DI] [BP] [BX] [] [       : ;REG. CO REGISTER. ;  : 7AND 7 AND ;                          : [M]. ;REG. 191 OVER < IF  OFFSET H. 199 OVER AND 6 =                IF 28 ;THEN  7AND 20 + ;THEN  7AND ;    -->                                                                                                                                               ' BYTEREL   21 DEFS                                                 JO,   JNO,    JB,   JNB,    JE,   JNE,   JBE,  JNBE,            JS,   JNS,    JP,   JNP,    JL,   JNL,   JLE,  JNLE,          LOOPNE, LOOPE,  LOOP, JCXZ,   SJMP,                           ' WORDREL   2 DEFS     RCALL,  RJMP,                                                                                            ' SIMPLE 6 7 7 * + DEFS                                          ES, CS, SS, DS, GS, FS,                                         OFS, ADR, LOCK, REP, REPZ, PROT, SAHF,                          POPA, PUSHA, POPF, PUSHF, RET, RETF, IRET,                      CBW, CWD, INTO, INT3, XLAT, LEAVE, NOP,                         CLI, STI, CLD, STD, CMC, CLC, STC,                              AAA, DAA, DAS, AAS, HALT, WAIT, LAHF,                           MOVSB, CMPSB, SCASB, LODSB, STOSB, INSB, OUTSB,                 MOVSW, CMPSW, SCASW, LODSW, STOSW, INSW, OUTSW,                 -->                                                            : M/R @CHAR+ DUP DUP TO RMF  192 < IF  @WORD+ TO OFFSET THEN ;  : REGFLD 8 / 7AND ;  : SEG! REGFLD 3 AND 16 + TO REGNUM ;       : REG  M/R REGFLD WFLAG 8 * + TO REGNUM ;                       : SEGR M/R SEG! 8 TO WFLAG ;         : REG. REGNUM REGISTER. ;  : OPC2 M/R REGFLD TO REGNUM ;                                   : SEG_OP CREATE DOES> OP! OPCODE SEG! REG. ;                    ' SEG_OP  2  DEFS   SPUSH,  SPOP,                               : ;IMMED! CO TO IMMED ;                                         : ?REGA WFLAG IF AX ;THEN AL ;                                  : ?# ;IMMED! IF @WORD+ ;THEN @BYTE+ ;                           : #ACC_OP CREATE DOES> OP! WFLAG ?# IMMED H. ?REGA ;            ' #ACC_OP 8 DEFS                                                   ADDI, ORI,  ADCI, SBBI, ANDI, SUBI, XORI, CMPI,              -->                                                                                                                                                                                             : M. RMF [M]. ;                                                 : MREG. DIRFLAG IF REG. M. ;THEN M. REG. ;                      : M&R_OP CREATE DOES> OP! REG MREG. ;                           ' M&R_OP  10 DEFS                                                  ADD,  OR,   ADC,  SBB,  AND,  SUB,  XOR,  CMP, TEST, XCHG,   : GRP_OP CREATE , ,                                                     DOES> DUP OP! OPC2 WCOUNT REGNUM + ^OP  PERFORM M. ;    : SEG_MOV_OP CREATE DOES> OP! SEGR REG. ;                       ' SEG_MOV_OP  2  DEFS   SPUSH,  SPOP,                                                                                           ' NOOP  0 GRP_OP  AROP1    ' NOOP  8 GRP_OP  AROP2              ' NOOP 16 GRP_OP  SHFTOP   ' NOOP 24 GRP_OP  GRP1               ' NOOP 32 GRP_OP  GRP2     ' NOOP 40 GRP_OP  GRP3                                                                               -->                                                                                                                             : REG_OP CREATE DOES> OP! 8 TO WFLAG OPCODE REG. ;              ' REG_OP  5  DEFS   DECR, INCR, PUSHR, POPR,  XR,                                                                                                                                                  109 LOAD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ( DISASM MAIN SCREEN                                          )  VOCABULARY DISASM   TO DISASM   ALSO DISASM                     0 QUAN IP                                                              \    -HEADERS                                                                                                           CREATE OPNAMES  -1 C,    ( SPECIAL 255 COUNT OF WORDS FIRST)      90 LOAD  ( OPNAMES)      <%                                   : IND? OPNAMES COUNT ROT SCLST ;                                : OP, TO WORD IND? 1+ ?DUP IF 1- C, ;THEN 1 ?? ;                : MO,  OP, 1- FOR  HERE 1- C@ C, NEXT ;                         : ROW,  8 FOR OP, NEXT ;                                        : [OP,] COMPILE BLIT OP, ; IMMEDIATE                            : VALUES FOR 0 VALUE NEXT ;                                     %>         =' ???" IND?  1+ OPNAMES C!                                                                   -->                                                                                    ( DISASM TABLE SCR 1                                   HEX   )  0 BARY OPTBL                                                    <% : ?OP CR BLK . HERE 0 OPTBL - DUP . H. ;  %>                  4 MO, ADD   2 MO, ADDI   OP, PUSHS    OP, POPS  ( 08)           4 MO, OR    2 MO, ORI    OP, PUSHS    OP, PROT  ( 10)           4 MO, ADC   2 MO, ADCI   OP, PUSHS    OP, POPS  ( 18)           4 MO, SBB   2 MO, SBBI   OP, PUSHS    OP, POPS  ( 20)           4 MO, AND   2 MO, ANDI   OP, ES       OP, DAA   ( 28)           4 MO, SUB   2 MO, SUBI   OP, CS       OP, DAS   ( 30)           4 MO, XOR   2 MO, XORI   OP, SS       OP, AAA   ( 38)           4 MO, CMP   2 MO, CMPI   OP, DS       OP, AAS   ( 40)          \ ?OP                                                            8 MO, INCR  8 MO, DECR   8 MO, PUSHR 8 MO, POPR ( 60) -->                                                                                                                                                                                                      ( DISASM TABLE SCR 2                                   HEX   )  ROW,  <PUSH>  <POP>  BOUND  ARPL   FS  GS  OFS  ADR      ( 68)  ROW,  PUSHI  IMULMI  PUSHI  IMULMI  INS  INS  OUTS  OUTS ( 70)  ROW,   JO    JNO   JB   JNB     JE  JNE   JBE  JNBE      ( 78)  ROW,   JS    JNS   JP   JNP     JL  JNL   JLE  JNLE      ( 80)  ROW,  0    0    1    1   TEST   TEST    XCHG    XCHG   ( 88)    ROW,  MOV   MOV   MOV  MOV   MOVMS   LEA   MOVMS   POP ( 90)      OP, NOP   7 MO, XCHGR                                ( 98)    ROW, CBW  CWD  CALLFI WAIT   PUSHF  POPF  SAHF  LAHF   ( A0)    4 MO, MOVA    2 MO, MOVS   2 MO, CMPS                  ( A8)    2 MO, TESTA   2 MO, STOS   2 MO, LODS   2 MO, SCAS     ( B0)                  16 MO, MOVRI                             ( C0)    ROW,  2  2  RETI  RET      LES  LDS  MOVMI  MOVMI      ( C8)    ROW, ENTER  LEAVE  RETFI  RETF  INT3  INT  INTO  IRET  ( D0)                                                              -->                                                                           ( NN = ESC 6)                                           ROW,   3   3   4   4   AAM   AAD  ???  XLAT          ( D8)      ROW,   ESC  ESC  ESC  ESC  ESC  ESC   ESC   ESC      ( E0)      ROW, LOOPNE LOOPE LOOP JCXZ  INP  INP  OUTP  OUTP    ( E8)      ROW, CALLI  JMPI JMPFI JMPS  IN   IN   OUT   OUT     ( F0)      ROW,  LOCK   ???   REP    REPZ   HALT   CMC   5   5  ( F8)      ROW,  CLC    STC    CLI   STI    CLD    STD   6   7  ( 100)      ?OP                                                            ROW,   ADD  OR   ADC  SBB  AND  SUB  XOR  CMP                   ROW,   ADD  ???  ADC  SBB  ???  SUB  ???  CMP                   ROW,   ROL  ROR  RCL  RCR  SHL  SHR  ???  RAR                   ROW,   TEST ???  NOT  NEG  MUL  IMUL DIV  IDIV                  ROW,   INC  DEC CALL CALLF JMP  JMPF PUSH ???                   ROW,   INC  DEC  ???  ???  ???   ???  ??? ???                          0 C, 1 C, 2 C, 2 C, 2 C, 3 C, 4 C, 5 C,                                                            -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ( OP PROCS                                                    ) 10 VALUES OPC  OPI  DISP  IMMED  RMF  MF  RF IP1  GNI  GADR     : _OP. OPNAMES 1+ SWAP TO SCLST ". ;  : @BYTE AT IP  AT 1+ C@ ; : @WORD AT IP AT 2+ @ ;            : @SBYTE AT IP AT 1+ TO C@ ; : F-SET FLAGS OR TO FLAGS ; : F-CLR -1 XOR FLAGS AND TO FLAGS ; : F-GET FLAGS AND ;         : F-FLIP FLAGS XOR TO FLAGS ;       : XREG CREATE DOES> C@ SWAP [OP,] 7 AND + [OP,] AL + _OP. ;       XREG BREG. 0 C,  XREG WREG. 8 C,  XREG SREG. 16 C,            0 NM: @ F-SET ;M 1 NM: @ F-GET ;M  2 MAKER XSET ,                1 XSET XW   2 XSET XD   64 XSET XM                             256 XSET XO   512 XSET XWO  4 XSET XIS  16 XSET XA              128 XSET XR   32  XSET XI   8 XSET XG                           ( VARIABLE DISP   VARIABLE FLAGS  ( xxxxcc#ORMIAGSDW )          ( M=r/m; cc=reg count; I=immediate; A=accumulator; G=seg;)      ( S=imm.size; D=direction;  W=word or byte; R= REGISTER )       ( #=DISP.SIZE O=ONLY.DISP)                      -->             ( MOD R/M FIELD PERFORM)  : OFFS! TO XO TO XM TO DISP ;         : #D16 @WORD OFFS! TO XWO ;   : #D8 @SBYTE OFFS! ;              0 BARY ATBL  30 C, 31 C, 46 C, 47 C, 6 C, 7 C, 5 C, 3 C,        : R/R MF ATBL C@ 8 U/MOD ?DUP IF WREG. THEN C" / EMIT WREG. ;   : _IMM TO XI XIS -IF @WORD ;THEN @SBYTE ;   : ;SPC CO SPACE ;   : REL? _IMM IP + TO IMMED ; : IMM? _IMM TO IMMED ;              : IM8  TO XIS IMM? ;    : RELB TO XIS REL? ;                    : IM1 TO XIS TO XI 1 TO IMMED ; : IM? XW -IF TO XIS THEN IMM? ; : MEM?  @BYTE 1L /MOD TO RMF  8 /MOD TO RF TO MF   RMF CASE          0 OF  MF 6 = IF #D16 THEN  ENDOF                                1 OF  #D8   ENDOF      2 OF  #D16  ENDOF ENDCASE ;         : -SEG.  XW IF WREG. ;THEN BREG. ;                              : OPR? -IF IP1 TO IP [OP,] DFB TO OPI 12 TO GADR IM8                   RDROP THEN  ;  -->                                                                                                                                                                                                                                       : ?WB. IF 1W. ;THEN 1B. ;                                       : ;DISP CO ;SPC "  +/" XWO IF DROP "  //" THEN ". ;             : ;IMM CO  ;SPC "  B#" XIS -IF DROP "  W#" THEN ". ;            : IMM.  XI 0;   ;IMM    IMMED  XIS 0= ?WB. ;                    : DISP. XO 0;   ;DISP   DISP XWO ?WB. ;                         : ?REG. XG -IF -SEG. ;THEN SREG. ;    : RG. ;SPC RF ?REG. ;     : MR. ;SPC XM -IF -SEG. ;THEN                                    DISP. RMF -IF MF 6 - -IF ;THEN THEN R/R ;                       : MR/R. ['] RG. ['] MR.  XD IF SWAP THEN EXEC  EXEC ;          : XGTBL CREATE DOES> OVER + + PERFORM ;                         : _ROP 7 AND TO RF ;   : SEGOP TO XG OPC AT 2/ _ROP ;           : ROP TO XW OPC _ROP ; : AREG  0 TO RF 6 TO MF 0 TO RMF ;       : REL. IMMED 1W. SPACE ;  : FARI. REL. DISP 1W. SPACE ;         : AR,M AREG #D16 ;          : A,I AREG IM? ;                -->                                                                                                                                 : R,I ROP 8 OPC AND -IF 1 F-CLR THEN IM? ;                      : D,I8 #D16 IM8 ;                                               : D,I16 #D16 IMM? ;                                             : D,I. DISP. REL. ;                                             : R,I. REL.  RG. ;                                              : MR,I. MR. IMM. ;                                              : MR,CL. MR. 1 BREG. SPACE ;                                    : R16,M XM OPR? TO XD TO XW ;                                   : SEG,M XM OPR? TO XG ;                                         : AR. ;SPC 0 ?REG. ;                                            : PREF. POP CO C" : EMIT PUSH ;                                 : A,IM8 AREG IM8 ;                                                                                                                                                                     -->                                                                      \              0     1     2     3     4      5    6    7       XGTBL G2B@OP ] IM?   IM8   IM8   IM1   NOOP   NOOP NOOP NOOP [  XGTBL G2B.OP ] MR,I. MR,I. MR,I. MR,I. MR,CL. MR.  MR.  MR.  [  : XG2B  GNI G2B@OP ;   : XG2B. GNI G2B.OP ;                     XGTBL G@OP  ]                                                   \ O1    0       ROL     LES     MOVMS   MOVMI   ADDI    MOVRI           XG2B    NOOP    R16,M   SEG,M   IM?     A,I     R,I     \ O2    MOVA    PUSHR   PUSHS   AL      ES      SAHF    INT             AR,M    ROP     SEGOP   NOOP    NOOP    NOOP    IM8     \ O3    INP     IN      JO      CALLI   RETI    ENTER   CALLFI          A,IM8 NOOP    RELB    REL?    IMM?    D,I8    D,I16  [                                                                  XGTBL G.OP  ]  XG2B.  MR/R.  MR/R.  MR/R. MR,I. R,I.  R,I.        MR/R.  RG.    RG.   NOOP   PREF.  NOOP  IMM.  R,I.              AR.    REL.   REL.  IMM.   D,I.   FARI. [         -->                                                                         ( @OP .OP  GNI-GROUP.NAME.INDEX OPI-OPERATION.NI              ) : @OP IP TO IP1 @BYTE DUP  3 AND TO FLAGS  DUP TO OPC OPTBL C@     DUP DUP TO OPI TO GNI     [OP,] PUSHI <  IF MEM? THEN          0 BEGIN 1+ GNI OVER  GROUPS C@ < UNTIL 1- DUP  TO GADR         -IF 256 OPTBL DUP GNI + 48 + C@ 8 * + RF + C@ TO OPI THEN       OPI [OP,] ??? - OPR?  GADR G@OP ;                              : .OP CR @OP IP1 DUP 1W. BEGIN SPACE COUNT 1B. IP OVER =          UNTIL DROP  BEGIN SPACE OUTC 24 = UNTIL GADR G.OP OPI _OP. ;  : ND FOR .OP NEXT ;                                             : 'DIS TO IP 10 ND ;                                            : DIS ' @ 'DIS ;                                                : L 20 ND ;                                                                                                                     \  PAD PATTERN  PAD 'DIS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ DESASEMBLER PAGE 1                                            MARKER  -DIS   : ERR CSP $ 3689 ! E ;   -HEADERS                CREATE OPNAMES  -1 C,    ( SPECIAL 255 COUNT OF WORDS FIRST)    ," 0 ," 1 ," 2 ," 3 ," 4 ," 5 ," 6 ," 7                         ," ROL  ," ROR  ," RCL  ," RCR  ," RAR  ," SHL ," SHR           ," ADD  ," ADC  ," AND  ," XOR  ," OR   ," SUB  ," SBB  ," CMP  ," NOT  ," NEG  ," MUL  ," IMUL ," DIV  ," IDIV ," INC  ," DEC  ," LES  ," LDS  ," LEA  ," ESC  ," MOVMS                        ," CALL ," CALLF ," JMP ," JMPF   ," ARPL ," BOUND              ," MOVSB ," CMPSB ," SCASB ," LODSB ," STOSB ," INSB  ," OUTSB  ," MOVSW ," CMPSW ," SCASW ," LODSW ," STOSW ," INSW  ," OUTSW  ," XCHG ," PUSH ," POP  ," TEST ," MOV                          ," MOVMI  ," IMULMI  ," PUSHI  ," MOVRI  ," MOVA  ," TESTA      ," ADDI ," ADCI ," ANDI ," XORI ," ORI  ," SUBI ," SBBI ," CMPI ," PUSHR ," POPR  ," INCR ," DECR ," XCHGR ," PUSHS  ," POPS -->                                                                ( 286 MNEM  0-A1 1-A2 234-SH 5-G1 6-G2 7-G3)                    ( MNEMONICS 2) ," AL ," CL ," DL ," BL ," AH ," CH ," DH ," BH  ," AX ," CX ," DX ," BX ," SP ," BP ," SI ," DI                 ," ES  ," CS ," SS ," DS ," GS ," FS                            ," OFS  ," ADR  ," LOCK ," REP  ," REPZ ," PROT ," SAHF         ," <POP> ," <PUSH> ," POPF  ," PUSHF ," RET  ," RETF  ," IRET   ," CBW  ," CWD  ," INTO ," INT3  ," XLAT  ," LEAVE    ," NOP    ," CLI  ," STI  ," CLD  ," STD  ," CMC  ," CLC  ," STC          ," AAA  ," DAA  ," DAS  ," AAS  ," HALT ," WAIT ," LAHF         ," INT ," AAM ," AAD ," INP ," OUTP ," IN ," OUT                ," JO   ," JNO  ," JB   ," JNB  ," JE   ," JNE  ," JBE  ," JNBE ," JS   ," JNS  ," JP   ," JNP  ," JL   ," JNL  ," JLE  ," JNLE ," SJMP ," JCXZ ," LOOP ," LOOPE ," LOOPNE ," CALLI ," JMPI     ," RETI ," RETFI  ," ENTER ," CALLFI ," JMPFI  ," DB            -->                                                                                                                             \ BIT SET OF SECONDARY OPCODE BYTE      PAGE 3                                                                                  : INSET CREATE DOES> OVER R>M + C@ SWAP 7 AND 2^ AND ;          INSET SECOP HEX  F0F , F0F , F0F , F0F , 0  ,  0 , A0C , 0 ,     -1 ,   0 ,   0 ,   0 , F3 ,  F ,   0 , C0C0 ,  DECIMAL                                                                         : _OP. OPNAMES 1+ SWAP TO SCLST ". ;                            0 VALUE SRCADR  0 VALUE ^REG    0 VALUE CNTR                    0 VALUE OPCODE  0 VALUE RMF     0 VALUE OPNAME                  0 VALUE IMMED   0 VALUE WFLAG   0 VALUE DIRFLAG                 0 VALUE REGNUM  0 VALUE OFFSET  0 VALUE STARTADR                : @CHAR+ SRCADR  COUNT SWAP TO SRCADR ;                         : C>B 0 OVER PACK S>D NIP UNPACK NIP PACK ;                     : @BYTE+ @CHAR+  C>B ;                                          : @WORD+ SRCADR WCOUNT SWAP TO SRCADR ;     -->                                                                                 <%                                                              : IND? OPNAMES COUNT ROT SCLST ;                                : WORD? BLWORD IND? 1+ ?DUP IF 1- ;THEN 1 ?? ; : OP, WORD? C, ; : MO,  OP, 1- FOR  HERE 1- C@ C, NEXT ;                         : ROW,  8 FOR OP, NEXT ;                                        : RDUP,  8 FOR HERE 8 - C@ C, NEXT ;                            %>         =' DB" IND?  1+ OPNAMES C!                           EXIT -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ( DISASM TABLE SCR 1                                   HEX   )  0 BARY OPTBL                                                    <% : ?OP CR BLK . HERE 0 OPTBL - DUP . H. ;  %>                  4 MO, ADD   2 MO, ADDI   OP, PUSHS    OP, POPS  ( 08)           4 MO, OR    2 MO, ORI    OP, PUSHS    OP, PROT  ( 10)           4 MO, ADC   2 MO, ADCI   OP, PUSHS    OP, POPS  ( 18)           4 MO, SBB   2 MO, SBBI   OP, PUSHS    OP, POPS  ( 20)           4 MO, AND   2 MO, ANDI   OP, ES       OP, DAA   ( 28)           4 MO, SUB   2 MO, SUBI   OP, CS       OP, DAS   ( 30)           4 MO, XOR   2 MO, XORI   OP, SS       OP, AAA   ( 38)           4 MO, CMP   2 MO, CMPI   OP, DS       OP, AAS   ( 40)          \ ?OP                                                            8 MO, INCR  8 MO, DECR   8 MO, PUSHR 8 MO, POPR ( 60)                                                                                         -->                                                                                                              ( DISASM TABLE SCR 2                                   HEX   )  ROW,  <PUSH>  <POP>  BOUND  ARPL   FS  GS  OFS  ADR      ( 68)  OP, PUSHI OP, IMULMI OP, PUSHI  OP, IMULMI                      OP, INSB  OP, INSW   OP, OUTSB  OP, OUTSW                ( 70)  ROW,   JO    JNO   JB   JNB     JE  JNE   JBE  JNBE      ( 78)  ROW,   JS    JNS   JP   JNP     JL  JNL   JLE  JNLE      ( 80)  ROW,  0    0    1    1   TEST   TEST    XCHG    XCHG     ( 88)  ROW,  MOV   MOV   MOV  MOV   MOVMS   LEA   MOVMS   POP   ( 90)    OP, NOP   7 MO, XCHGR                                  ( 98)  ROW, CBW  CWD  CALLFI WAIT   PUSHF  POPF  SAHF  LAHF     ( A0)  4 MO, MOVA  OP, MOVSB OP, MOVSW  OP, CMPSB OP, CMPSW     ( A8)  2 MO, TESTA   OP, STOSB OP, STOSW  OP, LODSB OP, LODSW             OP, SCASB OP, SCASW ( B0)   16 MO, MOVRI                     ROW,  2  2  RETI  RET      LES  LDS  MOVMI  MOVMI        ( C8)  ROW, ENTER  LEAVE  RETFI  RETF  INT3  INT  INTO  IRET --> ( D0)                                                                         ( NN = ESC 6)                                           ROW,   3   3   4   4   AAM   AAD  DB   XLAT          ( D8)      ROW,   ESC  ESC  ESC  ESC  ESC  ESC   ESC   ESC      ( E0)      ROW, LOOPNE LOOPE LOOP JCXZ  INP  INP  OUTP  OUTP    ( E8)      ROW, CALLI  JMPI JMPFI SJMP  IN   IN   OUT   OUT     ( F0)      ROW,  LOCK   DB    REP    REPZ   HALT   CMC   5   5  ( F8)      ROW,  CLC    STC    CLI   STI    CLD    STD   6   7  ( 100)      ?OP                                                            ROW,   ADD  OR   ADC  SBB  AND  SUB  XOR  CMP                   ROW,   ADD  DB   ADC  SBB  DB   SUB  DB   CMP                   ROW,   ROL  ROR  RCL  RCR  SHL  SHR  DB   RAR  RDUP, RDUP,      ROW,   TEST DB   NOT  NEG  MUL  IMUL DIV  IDIV                  ROW,   INC  DEC CALL CALLF JMP  JMPF PUSH  DB  RDUP,            WORD? AL  TO ^REG   ?OP                                         -->                                                                                                                             : 7AND 7 AND ;  : ;SPC CO SPACE ;  : REG. ^REG + _OP. ;         : REGNUM! 7AND TO REGNUM ; : WFLAG! 8 AND TO WFLAG ;            : ;[] C" [ EMIT CO C" ] EMIT ;     : WRG. 7AND 8 + REG. ;       : _NREG. REGNUM WFLAG + ;SPC REG. ;    : .# ." #, " ;           0 BARY ATBL  30 C, 31 C, 46 C, 47 C, 6 C, 7 C, 5 C, 3 C,        : R/A. 7AND ATBL C@ 8 U/MOD ?DUP IF WRG. C" + EMIT THEN WRG. ;  : [M]. ;SPC 191 OVER < 0= IF  OFFSET H. 199 OVER AND 6 =               ;[] IF DROP ;THEN  R/A. ;THEN 7AND WFLAG + REG. ;        : _M. RMF [M]. ;                                                : _RM. DIRFLAG 0= IF _NREG. _M. ;THEN _M. _NREG. ; \ ADD XOR SU : _IB @CHAR+ 1B. SPACE ; ( INT IN OUT )                         : _DB. STARTADR TO SRCADR  _IB ;           -->                                                                                                                                                                                                                                                                                  : _WADR. @WORD+ H. ;       : >WFLAG 8 TO WFLAG ;                : _IW _WADR. .# ;          : _SINT. @BYTE+ H. ;                 : _I?WB WFLAG IF _WADR. ;THEN _IB ;  \ PUSHI                    : _AROP1 _I?WB .# _M. ;    : _AROP2 _SINT. .# _M. ;             : _#RM. _IW  _RM. ;                                             : ADR+. SRCADR + DUP TO IMMED H. ;                              : _DADR. @WORD+ _WADR. H. ;  \ FAR ABS                          : _WREL @WORD+ ADR+. OPCODE 232 = 0;  IMMED $ 2E0 = 0;                1 TO CNTR     SRCADR @HACK ;                              : _BREL @BYTE+ ADR+. ;   \ BRANCH & CALL                        : _ADR_AR _WADR. _NREG. ; \  TST                                : _IMM_AR _I?WB _NREG. ;  \ ADDI                                : _WREG  OPCODE REGNUM! >WFLAG _NREG. ;                         : _LIR.  OPCODE DUP REGNUM! WFLAG! _I?WB _NREG. ;  \ LIR        -->                                                                                                                             : _1,[ 1 . .# _M. ;  : _IWB _IW _IB ;  \ ENTER                  : _CL,[ 1 REG. SPACE .# _M. ;   : _N,[ _IB .# _M. ;             : SEGR   8 / 7AND 3 AND 8 + TO REGNUM 8 WFLAG! ;                : _LS.    >WFLAG _RM. ;                                         : _SEGOP OPCODE SEGR _NREG. ;                                   : _SMOVE. RMF SEGR _RM. ;                                       : _D?WB DIRFLAG IF _SINT. ;THEN _WADR. ;  \ PUSHI               : _,MUL _D?WB .# _RM. ;                                          0 WARY EX_TBL ] ??  _LS.  _DB.                                    _IB   NOOP  _SEGOP  _SMOVE. _LIR. _IWB  _I?WB _WREL             _BREL _DADR. _IMM_AR _ADR_AR _NREG. _WREG _RM.  _M.             _1,[   _CL,[  _N,[  _AROP1 _AROP2 _D?WB _,MUL _WADR.          [   HERE 0 EX_TBL - 2/  CONSTANT EX_LEN                        -->                                                                                                                                                                                             256 BARY OP_TYPE                                                <% : DOWITH TO REGNUM TO OPCODE                                        0 EX_TBL  EX_LEN OPCODE  TO SCAN DUP                               1+ 0= A" WHAT TO DO ? "                                      TO WFLAG                                                        REGNUM FOR WORD? TO REGNUM                                        256 FOR R@ OPTBL C@ REGNUM =                                        IF R@ OP_TYPE C@ A" DUPLICATED ! "                                 WFLAG R@ OP_TYPE C! THEN                                 NEXT                                                          NEXT                                                         ;                                                            : OP_TEST 256 FOR R@ OP_TYPE C@ 0= IF R@ . THEN NEXT ;          %>                                       -->                                                                                                                                                   ' _RM. 12 DOWITH  ADD ADC AND XOR OR SUB SBB CMP                                MOV LEA TEST XCHG                               ' _WREG 5 DOWITH  PUSHR POPR INCR DECR XCHGR                    ' NOOP 55 DOWITH   MOVSB CMPSB SCASB LODSB STOSB INSB OUTSB      MOVSW CMPSW SCASW LODSW STOSW INSW OUTSW                        CBW CWD INTO INT3 XLAT LEAVE NOP                                CLI STI CLD  STD  CMC  CLC   STC                                AAA DAA DAS  AAS  HALT WAIT  LAHF                               OFS ADR LOCK REP REPZ PROT SAHF                                 <POP> <PUSH> POPF PUSHF RET RETF IRET  ES  CS SS  DS GS FS                                                                     ' _BREL 21 DOWITH  JO JNO JB JNB JE JNE JBE JNBE LOOPNE LOOPE                    JS JNS JP JNP JL JNL JLE JNLE SJMP JCXZ LOOP             -->                                                                                                                                                                                   ' _IB 5 DOWITH  INT  AAM  AAD  INP  OUTP                                                                                                                                                                                                                         ' _IMM_AR 8 DOWITH  ADDI ADCI ANDI XORI ORI  SUBI SBBI CMPI    ' _NREG. 2 DOWITH  IN OUT                                       ' _ADR_AR 2 DOWITH  MOVA TESTA                                                                                                  ' _LS. 5 DOWITH  LES  LDS   ESC     ARPL  BOUND                                                                                                                                                 -->                                                                                                                                                                                                                                                                                                                             ' _LIR. 1 DOWITH  MOVRI                                         ' _WREL  2 DOWITH   CALLI  JMPI ' _DADR.  2 DOWITH CALLFI JMPFI ' _WADR. 2 DOWITH  RETI  RETFI  ' _IWB    1 DOWITH ENTER        ' _AROP1 2 DOWITH 0 MOVMI       ' _D?WB   1 DOWITH PUSHI        ' _AROP2 1 DOWITH 1             ' _SEGOP  2 DOWITH PUSHS  POPS  '   _N,[ 1 DOWITH 2             ' _SMOVE. 1 DOWITH MOVMS         '  _1,[ 1 DOWITH 3             ' _,MUL  1 DOWITH IMULMI         ' _CL,[ 1 DOWITH 4             ' _DB. 1 DOWITH DB               '  _M. 4 DOWITH  5  6  7 POP    OP_TEST                        : OPNAME! OPTBL C@ TO OPNAME ;  \ NAME INDEX                     : ?SECOP SECOP 0; @CHAR+ DUP TO RMF  8 / 7AND TO REGNUM           OPNAME 8 U< IF OPNAME 8 * 256 + REGNUM + OPNAME! THEN           RMF 192 < 0;  RMF 199 AND 6 =                                   RMF C>B 0< OR IF  @WORD+ TO OFFSET  ;THEN                       RMF 2* C>B 0< IF  @BYTE+ TO OFFSET  THEN  ;          -->                                                                     : OPNAME.  OPNAME _OP. C" ,  EMIT ;                             : OP!  -1 TO RMF      0 TO OFFSET    \ ASSUME NO OFFSET                 0 TO IMMED    0 TO REGNUM    \ ASSUME A REG                SRCADR TO STARTADR  @CHAR+        \ FETCH OPCODE                   DUP TO OPCODE   DUP OPNAME!    \ NAME INDEX                      DUP 2 AND TO DIRFLAG          \ DIRECTION FLAG                  DUP 1 AND 8 * TO WFLAG  ?SECOP ;                         : 1INST CR SRCADR H. OP!  OPCODE OP_TYPE C@ EX_TBL  PERFORM       OPNAME. STARTADR SRCADR OVER -   ."   -  "                        FOR COUNT 1B. SPACE NEXT DROP ;                             \  CR RMF 1B. SPACE WFLAG . DIRFLAG . REGNUM . OFFSET H. ;      | : NINST SKIP BEGIN TO CNTR 1INST CNTR 1- THEN ?DUP 0= UNTIL ; : LI 7 NINST ;                                                  : @DIS TO SRCADR LI ;  : DIS ' @ @DIS ;                                                                                                                                                         .....................................                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0 QUAN P  0 VALUE CSTEP 0 QUAN PTABLE  0 QUAN PW  0 VALUE PT    0 VALUE PWORD : .=? C" . = ; : C@+ @1+! C@ ; : C@+. C@+ .=? ;   : .@PW+ AT PW C@+ .=? ; : .# BEGIN .@PW+ UNTIL ;                : .= BEGIN .@PW+ WHILE REPEAT PW 1- ; : END? AT PTABLE C@+. ;   : INITF [ 150    ] LITERAL BLOCK PAD 1K CMOVE  PAD TO PW .= DUP  TO PTABLE PAD - TO CSTEP .# .= TO PWORD ; INITF                : PRINT CR CSTEP . PTABLE PAD - [ CSTEP ] LITERAL                  /MOD SWAP . 1- . BEGIN AT P C@+ EMIT P C@ .=? UNTIL ;        0 WARY FARY    CSTEP DUP , DUP 1+ , DUP 1- ,  1 ,  -1 ,                       NEGATE DUP , DUP 1+ ,     1- ,                    : FWORD FARY @ TO CSTEP  PWORD TO PW  BEGIN   PW TO P            PTABLE TO PT   BEGIN PT C@ AT PW C@+ = WHILE PW C@  .=?          IF PRINT ;THEN  PT CSTEP + TO PT REPEAT  .# PW C@ .=? UNTIL ; : FIND-WORDS INITF BEGIN 8 0 DO I FWORD LOOP  END? UNTIL ;      : SHOW-WORDS INITF BEGIN CR CSTEP 0 DO AT PTABLE C@+ EMIT LOOP            PTABLE C@ .=? UNTIL ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 .....................................                                                                                    10 8 5        12 0 6     10 8 7         12 0 8         -11 10 111 1 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ DSTACK RSTACK         CARRY                  IP - INST PNTR   \ TDR - TOP OF STACK    NDR - NEXT BELOW       TRR - TOP RETURN \ AREG - ADR REGISTER   OP# - OPER NUMBER      IR - INSR REGIST 0 VALUE TDR   0 VALUE NDR  0 VALUE IP  0 VALUE IR 0 VALUE OP#   0 VALUE AREG  0 VALUE TRR  0 VALUE CRY 0 VALUE CB 0 VALUE OPTBL : !+ SWAP OVER ! 2+ ;   : @+ DUP @ SWAP 2+ ; : OP#0 0 TO OP# ;  : IR!  TO IR  4 TO OP# ;     : OP- OP# 1- TO OP# ;                                                                              : STACK, 2* DUP 2- , 2+ CLARY ;         : ODD 1 AND ;           : ;CARRY CRY ODD EX ODD TO CRY ;  : ;HERE HERE EX TO HERE ;     0 NM: WCOUNT PUSH DUP @ 2- POP AND OVER ! @+ + ! ;              1 NM: WCOUNT PUSH @+ OVER 2+ POP AND OVER 2- ! + @ ;            2 MAKER STACK: STACK,   16 DUP STACK: DSTK    STACK: RSTK                                                                                                                                                                                                       : ;IP IP EX  TO IP ;   : @P+ ;IP @+ ;    : !P+ ;IP !+ ;         : IP! TO IP  0 TO OP# ;  : IP+  IP + IP! ;                      : _DUP  NDR TO DSTK  TDR TO NDR ;       : S+1  _DUP TO TDR ;    : _DROP NDR TO TDR   DSTK TO NDR ;      : S-1   TDR  _DROP ;    : ;A AREG EX S+1 ;      : _A   ;A ;     : _@A+ ;A @+ TO AREG ;  : ;A! S-1 EX TO AREG ;  : _A! ;A! ;     : _!A+ ;A! AREG !+ ;    : 2OP S-1 TDR EX TO TDR ;       \ : _+ 2OP + ;                  : R-1   TRR  RSTK TO TRR ;      : R+1   TRR TO RSTK  TO TRR ;   : _PUSH S-1 R+1 ;               : _POP  R-1 S+1 ;    : _NOP ;   : _SWAP NDR TDR  TO NDR  TO TDR ;  : _OVER NDR S+1 ;            CREATE MASKS  0 , M1 , M2 , M3 ,  : ?MASK OP# 2* MASKS + @ ;    : ?ADR IR ?MASK AND DUP ?MASK 1+ 2/ AND IF ?MASK NOT OR THEN ;  : 1OP TDR EX TO TDR ;  : _NIP 1OP _DROP ;  : _NOT 1OP NOT ;     : _XOR 2OP XOR ;        : _AND 2OP AND ;   : _- 2OP - ;                                                                                                                                         : _LIT  @P+ S+1 ;        : _LIT! S-1 !P+ ;                      : _EXIT R-1 IP! ;        : _EX TRR  IP TO TRR IP! ;             : _JUMP ?ADR IP! ;       : _RJUMP ?ADR  IP+ ;                   : _CALL  IP R+1 _RJUMP ; : _ACALL IP R+1 _JUMP ;                : _IF   TDR      IF OP#0 ;THEN _RJUMP ;                         : _-IF  TDR 0<   IF OP#0 ;THEN _RJUMP ;                         : _NEXT TRR ?DUP IF 1- TO TRR _RJUMP ;THEN R-1 DROP OP#0 ;      : _+ 2OP 0 SWAP ;CARRY 2/ D+ ;                                  : _U2/C ;CARRY 1OP SWAP 15 SHIFT OVER 2/ XOR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  HERE TO OPTBL   ] _NOP _+    _A   _IF _EXIT _JUMP _LIT _-IF             _A! _AND _U2/C _XOR _PUSH _@A+  _POP _!A+ _ACALL [      : OPC OP- IR OP# 2* 2* 1- NEGATE SHIFT 15 AND DUP 2* ;          : OP1 OPC OPTBL + @ ?ID. 2^ M4 AND                                       IF IP ?ADR 2* + H. OP#0 THEN ;                         : OPW. DUP H. DUP 0< IF 2* ." _CALL " H. ;THEN \ EMUL CALL          IR!  BEGIN OP# WHILE OP1  REPEAT ;                          : EXOP1 DUP 0< IF 2* IP R+1 IP! ;THEN   \ EMULATE CALL ?            IR!  BEGIN OP# WHILE OPC OPTBL + PERFORM REPEAT ;           : H_CMD TO IP BEGIN @P+ EXOP1 AGAIN ;                           : NL SWAP TO IP FOR CR IP H. @P+ OPW. NEXT ;                                                                                                                                                                                                                                                                                                                                                    $ 8000  CONSTANT HI-BIT         : ALIGNED ;HERE DUP ODD + ;     : L: HERE <% CONSTANT %> ;   : (IR)! SHIFT IR XOR! ;            : ;OP! OP# EX OP- OP# 2* 2* 1- (IR)! ;  : !. HERE IR! 0 , ;     : OP, ;OP! ?DUP IF 1- IF ;THEN DUP ODD IF !. THEN ;THEN !. ;    : 'CB ' OPTBL 17 ROT SCANW DUP 1+ IF ;THEN A" NOT OPCODE !" ;   : .CALL OP#0 2/ HI-BIT OR , ;   : ., CREATE C, DOES> C@ OP, ;   : .J CREATE C, DOES> OP#0 C@ OP, HERE - $ FFF AND                                    -1 (IR)! OP#0 ;                            'CB _NOP ., .NOP  'CB _+  ., .+  'CB _A ., .A  'CB _EXIT ., .;  'CB _IF  .J .IF   'CB _JUMP  .J .JUMP   'CB _-IF .J .-IF        'CB _AND ., .AND  'CB _U2/C ., .U2/C   'CB _LIT ., .LIT         'CB _XOR ., .XOR  'CB _A! ., .A!    'CB _PUSH ., .PUSH          'CB _@A+ ., .@A+  'CB _POP ., .POP  'CB _!A+ ., .!A+            : #, .LIT , ;                                                                                                                                                                                   PRUNE           MARKER -VCPU                                                 \ 7 CONSTANT M1  255 CONSTANT M2 8191 CONSTANT M3  7 CONSTANT M1 127 CONSTANT M2 2047 CONSTANT M3 168 CONSTANT M4                                        151 155 THRU              ALIGNED OP#0  -HEAD                                             L: L1 .NOP  .+  .A   .;                     L1 .IF                      1 #, -1 #, 100 #,                                       L: L2 .AND  .U2/C   .LIT     .A!            L2 .JUMP            L: L3 .!A+  .POP    .@A+                    L3 .-IF             L: L4 .@A+  .+      .!A+     .PUSH                                    L1 .CALL   L2 .CALL  L4 .CALL  L3 .CALL                                                                                   PAGE 156 LIST 12 AT-XY                                          L1 11 NL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        : ;ZZ TO ZZ EX ZZ ; 0 VALUE NPOS  0 VALUE NCOUNT   0 VALUE NBLK : @+ ;ZZ @+ ; : !+ ;ZZ !+ ;   : -@ 2- @+ 2- ; : -! 2- !+ 2- ;                                                                   0 VALUE PC   0 VALUE A   0 VALUE W                                                                                                                                                              : NEXTI  PC @+ TO PC  PERFORM NEXTI ;                                                                                           CALL:    W = MEMW[PC++];                                        NEST:    MEMW[--RSP] = PC; PC = W;                              NEXTI:   W = MEMW[PC++];  A = MEMW[W++];   GOTO A;              JUMP:    W = MEMW[PC++];  PC = W;    NEXTI;                                                                                                                                                                                                                                                                                     $ 8000  CONSTANT HI-BIT         : ALIGNED ;HERE DUP ODD + ;     : OP- OP# 1- TO OP# ; : .: 4 TO OP# 0 TO IR ; : .. 2/ , .: ;    : 'CB ' OPTBL 17 ROT SCANW DUP 1+ IF ;THEN A" NOT OPCODE !" ;   : ;CB OP- IR 4 SHIFT EX TO IR ; : SH1 ;CB OP# SWAP ;            : ... OP# 4 - IF BEGIN SH1 0= UNTIL IR .. THEN ;                : .CALL ... 2/ HI-BIT OR , ;                                    : J, ... PUSH HERE 2+ - $ FFF AND POP 12 SHIFT OR 2/ , ;        : .J CREATE C, DOES> C@ J, ; : L: ... HERE <% CONSTANT %> ;     : COP, ( COP --) ;CB  OP# IF OR  ;THEN OVER ODD                    IF .. OP- ;THEN  OR .. 0 ;   : ., CREATE C, DOES> C@ COP, ;  'CB _NOP ., .NOP  'CB _+  ., .+  'CB _A ., .A  'CB _EXIT ., .;  'CB _IF  .J .IF   'CB _JUMP  .J .JUMP   'CB _-IF .J .-IF        'CB _AND ., .AND  'CB _U2/C ., .U2/C   'CB _LIT ., .LIT         'CB _XOR ., .XOR  'CB _A! ., .A!    'CB _PUSH ., .PUSH          'CB _@A+ ., .@A+  'CB _POP ., .POP  'CB _!A+ ., .!A+                                                                            OBJECT CLASS                                                      CELL VAR TEXT                                                   CELL VAR LEN                                                    CELL VAR X                                                      CELL VAR Y                                                      METHOD INIT                                                     METHOD DRAW                                                   END-CLASS BUTTON                                                                                                                :NONAME ( O -- ) >R                                              R@ X @ R@ Y @ AT-XY  R@ TEXT @ R> LEN @ TYPE ;                  BUTTON DEFINES DRAW                                            :NONAME ( ADDR U O -- ) >R                                       0 R@ X ! 0 R@ Y ! R@ LEN ! R> TEXT ! ;                          BUTTON DEFINES INIT                                                                                                            OBJECT CLASS                                                      CELL VAR TEXT                                                   BYTE VAR X                                                      BYTE VAR Y                                                      METHOD INIT                                                     METHOD DRAW                                                     METHOD POS!                                                   END-CLASS BUTTON                                                                                                                :NONAME ( O -- )      DUP >R  X C@  R@ Y C@ AT-XY  R> TEXT ". ;  BUTTON DEFINES DRAW                                            :NONAME ( ADDR U O -- ) >R   0 R@ X C! 0 R@ Y C!  R> TEXT ! ;    BUTTON DEFINES INIT                                            :NONAME ( X Y O - ) DUP >R  Y C!  R> X C! ;                      BUTTON DEFINES POS!                                                                                                            MARKER -CAPS                                                    : ?LO_CAPS C" a  C" {  WITHIN ;   0 QUAN X-CAPS                 : ?HI_CAPS C" A  C" [  WITHIN ;  : C!BACK OVER 1- C! ;          : X!ADR POP TO X-CAPS ;          : DO-X X-CAPS PUSH ;           : >DO SWAP TO X-CAPS ;                                          : >LO X!ADR DUP ?HI_CAPS IF bl + C!BACK ;THEN DROP ;            : >HI X!ADR DUP ?LO_CAPS IF bl - C!BACK ;THEN DROP ;            : UPCASE ( ADR LEN --) >HI FOR COUNT DO-X NEXT DROP ;           : LOCASE ( ADR LEN --) >LO FOR COUNT DO-X NEXT DROP ;           : TIMES  ( XT  CNT --) >DO FOR X-CAPS EXEC NEXT ;                                                                                                                                                                                                                                                                                                                                                                                                               : :NONAME HERE SMUDGE DO: TO CO ;      \ MINI-OOF               : METHOD ( M V -- M' V ) CREATE  OVER , SWAP CELL+ SWAP           DOES> ( ... O -- ... ) @ OVER @ + @ EXEC ; \ !!! EXECUTE ;    : VAR ( M V SIZE -- M V' ) CREATE  OVER , +                       DOES> ( O -- ADDR ) @ + ;                                     : CLASS ( CLASS -- CLASS METHODS VARS ) DUP 2@ ;                : END-CLASS  ( CLASS METHODS VARS -- )                            CREATE  HERE >R , DUP , 2 CELLS ?DO ['] NOOP , 1 CELLS +LOOP    CELL+ DUP CELL+ R> ROT @ 2 CELLS /STRING MOVE ;               : DEFINES ( XT CLASS -- ) ' >BODY @ + ! ;                       : NEW ( CLASS -- O )  HERE OVER @ CLARY SWAP OVER ! ;  \ ALLOT  : :: ( CLASS "NAME" -- ) ' >BODY @ + @ COMPILE, ;               CREATE OBJECT  1 CELLS , 2 CELLS ,                                                                                                                                                                                                                              \ _+   _1+   _+C   _2/   _AND  _XOR  _NOT   _U2/C               \ _@A  _!A   _@A+  _!A+  _@+   _!+   _@P+   _!P+                \ _IF  _-IF  _;    _EX   _NEXT _JUMP _CALL  _NOP                \ _DUP _DROP _SWAP _OVER _A    _A!   _PUSH  _POP                \ ??? NOP OBJ   / .LIT .CALL NOP .@+    3.5.5.3                 \ ??? NOP CALL  / 1.4.4.4.3                                                   : 2*C DUP +C ; : D2* PUSH 2* POP 2*C ;            : D2/ 2/ SWAP U2/C SWAP ;     : ;0+C EX 0 +C ;                  : D+  PUSH A! PUSH A + POP POP +C ;                             : DNEGATE ;0+C PUSH NEGATE POP ;                                : D1+ ;0+C PUSH 1+ POP ;                                        : +* A U2/C U2/C -IF DROP +                                     \ : EX POP POP SWAP PUSH PUSH ;         \ : 1- NOT 1+ NOT ;     \ : ROT PUSH SWAP POP SWAP ;    \ : -ROT SWAP PUSH SWAP POP ;   \ : NEGATE NOT 1+ ;     \ : - NEGATE + ;        \ : 2* DUP + ;                                                                  CREATE LASTWORD 256 ALLOT  : EX POP POP SWAP PUSH PUSH ;        : EX1 POP POP ROT PUSH SWAP PUSH PUSH ;                         : ;HERE HERE LASTWORD TO HERE  EX1 POP TO HERE ;                : SMOVE OVER C@ 1+ CMOVE ;      : GWORD ;HERE bl WORD ;         : GFIND LASTWORD HERE SMOVE GWORD FIND ;                                                                                        DEFINE-EDIT        COMPILE        EXECUTE                       LASTWORD ADR:      LASTWORD ADR ,  LASTWORD ADR #               ;HERE    WORD:     CMOVE  WORD,    HERE     WORD                ;        MACRO:    ;      MACRO,   ;        MACRO               123      NUM       123    NUM ,                                 "SGHSDG" STRING    "L"    STR,                                  (XFADFG) COMMENT                                                WORD NUMBER MACRO COMMENT                                       : N! C!+ ! ; : N@ C@+ @ SWAP ; : L@ @+ @ SWAP ; : L! !+ ! ;                                                                     16 WARY REGS ( AX BX CX DX FL BP SI DS DI ES SP SS IP CS IC WR) : REGISTER CREATE C, DOES> C@ REGS @ ; 0 REGISTER RAX           1 REGISTER RBX  2 REGISTER RCX   3 REGISTER RDX  4 REGISTER RFL HERE 0 REGS !  ASM  SP 10 REGS /// MOV, SS 11 REGS /// MOV,              21 #, INT,  HERE 1- 1 REGS !                           CS: 11 REGS /// SS MOV, CS: 10 REGS /// SP MOV, RET, END-CODE   CODE >CALL BX 12 REGS /// MOV, AX POP, BX POP, CX POP, DX POP,  SI PUSH, BP PUSH, DS PUSH, CS: 12 REGS /// CALL, ES PUSH,        DI PUSH, DS PUSH, SI PUSH, BP PUSH, PUSHF, DX PUSH, CX PUSH,    BX PUSH, CS PUSH, ES POP, 0 REGS #, DI MOV, CLD,  STOSW,        9 #, CX MOV, BEGIN, AX POP, STOSW, CXNZ, NOT, UNTIL,            DS POP, BP POP, SI POP, BX POP, NEXT, END-CODE                 CODE >INT   BL  1 REGS @ /// MOV,  0 REGS @ #, BX MOV,                  ' >CALL CELL+ JMP, END-CODE                             CODE >DOS BX PUSH, $ 21 #, BX MOV, ' >INT CELL+ JMP, END-CODE                                                                   MARKER -ZZ  VOCABULARY BLIST BLIST  TO BLIST     167 LOAD                                                                       HEX     : D0 0 0 ROT ;         : ;IO? EX >DOS RFL ODD A" IO?" ; : FileSeek ;IO? 4200 ;         : FileSize ;IO? D0 4202 ;        : FileRead ;IO? 3F00 ;         : FileWrite ;IO? 4000 ;          : FSEEK 1K M* SCRH FileSeek ;  : FRW FSEEK 1K SCRH ;            : FSIZE SCRH FileSize RAX RDX 1K TO U/MOD NIP ;                 : FCUT ( SCR -) FSEEK SCRH D0 FileWrite ;                       : FRBLK FRW   FileRead ;       : FWBLK FRW FileWrite ;          \ VARIABLE CBUF   0 VALUE INFILE   0 VALUE OUTFILE              \ : CF>READ  CBUF 1 INFILE  F>READ ;                            \ : CF>WRITE CBUF 1 OUTFILE F>WRITE ;                           DECIMAL -->                                                                                                                                                                                                                                                      VARIABLE COUNTER  : ?QUIT KEY 255 AND 27 = IF QUIT THEN ;       : ?STOP COUNTER 1-!@ #IF 1+ 0= 0; 19 COUNTER !                         ;THEN DROP ?QUIT ;                                      ' < LIKE <= -1 C, -1 C, 0 C,       : PLACE OVER C@ 1+ CMOVE ;   ' SELF 4 + @ DUP  CODE, @SELF+      2+  CODE, SELF+             ' >< 2+ @ DUP     CODE, >@!<   ( ADR NUM -- NUM2 == ADR @ )                   2-  CODE, @!     ( NUM ADR -- NUM2 == ADR @ )     : C!+ TUCK C! 1+ ;   : !+  TUCK ! 2+ ;  MAC: !BU ! UPDATE ;       0 VALUE BLAST    3 CONSTANT NSIZE  MAC: NADR PAD NSIZE - ;      : OFFSET POP @+ PUSH CELL+ @ ;  : BSAVE UPDATE SAVE-BUFFERS ;   0 VECTOR BROOT    : BE_ROOT CONSTANT DOES> @ TO BROOT ;         : FIELD: OVER CONSTANT + DOES> @SELF+ ;                         : BFIELD: PUSH FIELD: POP , DOES> @+ @ BSELF SELF+ ;     -->                                                                                                                                                                                                  184 CONSTANT CLIST  0 VALUE WMEM  0 VALUE BFROM  0 VALUE BTO     1006  2 CELLS CLIST BFIELD: MBLK   2 CELLS CLIST BFIELD: FBLK         2 CELLS CLIST BFIELD: BFREE  3 BYTES CLIST BFIELD: RCNT  BYTE FIELD: WCNT    CELL FIELD: WPOS    CELL FIELD: BLNK  DROP                                                                  ' FBLK BE_ROOT >FORTH  >FORTH   ' MBLK BE_ROOT >MACRO           : ?WADR WPOS @SELF+ WCNT C@ ROT 1+ - TO SCLST ;                 : WORD? BLWORD 1+ C@ 0= A" NULL?" HERE PAD PLACE ;              MAC: NOFS NSIZE * ;     : >LINK DUP TO BLAST BSELF BLNK ;       MAC: NPOS NOFS SELF+ ;  MAC: NMOVE NSIZE CMOVE ;                : IN-BLK? WPOS @SELF+ WCNT C@ PAD SCLST ;                         : WGET  ( IND --) WCNT C@ OVER <= A" INDEX?" DUP PUSH              NPOS NADR NMOVE POP ?WADR PAD PLACE ;                      : W. WGET NADR COUNT . WCOUNT . ". ;          -->                                                                                                                                                 : NEW_BLK  DUP BSELF  SELF 1K ERASE                                    [ WCNT SELF - ] LITERAL WPOS !BU ;                       : ?BLK ( -- NB) BFREE @                                               #IF   DUP    >LINK @  BFREE !BU NEW_BLK                         ;THEN DROP   FSIZE              NEW_BLK BSAVE ;                                                                           : +BLK ?BLK DUP BROOT UPDATE @! SWAP >LINK ! BSAVE ;            : BTOP   BROOT @ ?DUP 0= IF  +BLK ;THEN >LINK DROP ;                                                                            : >W?  WPOS @ WCNT C@ 1+ NOFS -  PAD C@ 1+ < IF +BLK THEN ;     : >W BTOP >W? PAD DUP C@ 1+ WPOS -@! SELF+ PLACE                       NADR WCNT @1+! B>W NPOS NMOVE BSAVE ;                  : FPUSH ( N C --) NADR C!+ ! WORD? >W ;                                                                                         -->                                                                                                                                                                                                                                                                          173 LOAD    \ PRUNE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  : LIST_VIEW  WCNT C@ FOR CR R@ W. ?STOP NEXT ;                  : VBLOCK BSELF LIST_VIEW  CR WCNT C@ . WPOS @ . BLNK @ . ;      : ;DROP EX DROP ;   MAC: ?PREV >LINK ? ;                        : N> BLNK @ VBLOCK ;                                            : ;COUNTER COUNTER OFF BTOP EX COUNTER @ ;                      : >BLK? BLNK @ #IF >LINK DROP ;THEN DROP RDROP ;              \ : VLIST  ;DROP ;COUNTER BEGIN LIST_VIEW >BLK? AGAIN ;           : VCOUNT ;COUNTER BEGIN  WCNT C@  COUNTER +! >BLK? AGAIN ;                                                         RECOVER      : ?W  BTOP BEGIN IN-BLK? CR S.                                                                 DUP COUNTER !                                 1+ 0=  S. 0; >BLK? AGAIN ;                              RECOVER                                                  : FSEARCH WORD? ?W ;                                             -->                                                                                                                              0 VALUE TOTALCNT                                                : ?TOTAL  TOTALCNT ~IF DROP COUNTER @                                      VCOUNT DUP TO TOTALCNT SWAP COUNTER !  THEN ;        : ?NW ?TOTAL SWAP -  BTOP  BEGIN   WCNT C@ 2DUP                 <= IF SWAP - ;THEN - >BLK?  AGAIN ;   RECOVER                                                                                 : NW. ?TOTAL BTOP OVER <= A" TOO_MANY" ?NW W. ;                 : ALL ?TOTAL 0 DO CR I . I NW. ?STOP LOOP ;                                                                                     \ TODO                                                          \                                                               \  FIND BY TYPE                                                 \  FIND BY NUMBER                                               \  FIND BY NAME                                                 \  DELETE WORD                                                  \                                                                                                                               1000 11 FPUSH .1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-  2000 12 FPUSH .2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-    3000 13 FPUSH .3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-     4000 14 FPUSH .4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-    5000 15 FPUSH .5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-    6000 16 FPUSH .6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-     7000 17 FPUSH .7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890-   8000 18 FPUSH .8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-   9000 19 FPUSH .9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-   10000 20 FPUSH .10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-   11000 21 FPUSH .11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-                                                                                                                                                                                                                                                                @(#'*pX@(#'*       ..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-C  pX@(#'*pX@(#'*       -.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-C  pX@(#'*pX@(#'*      0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-B  pX@(#'*pX@(#'            ..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-H  *A90                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  GAGA3(FGKL;'FGHJKLDFGHJKIOPDFGYHUIOPDFGYHUIOP[1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 DC !Y -" $# &% (' *) ,+ .- 0/ 21 p<`FXP@Z(#d' NESTAGARGAMEL23456789WERTYUIODFGHJKXCVBNM,?ZXCVBNMASDFGHJKLQWERTYUIO123456789VBNMSDFGHWERTYQWERTYU12345678<ASDFGHJKL;'ZXCVBNM,.ASDFGHJKLWERTYUIOP23456789SDFGHJKXCVBNM,=1234567890123456789023456789012345678902345678902345678912345CZXCVBNM,.XCVBNM,.XCVBNM,XCVBNM,.XCVBNM,XCVBNM,XCVBNMZXCVBNM,ZXVBZXC;QWERTYUIOPQWERTYUIOQWERTYUIOQWERTYUIOQWERTYUIOQWERTYUQWERTY912345678912345678901234567890-=1234567890345678234567890-81234567890QWERTYUIOSDFGHJKZXCVBNMWERTYUI45678DFGHJXCVBNM9XCVBNMSDGHJKWERTYU2345678WERTYUSDFGHXCVBNMBNM,DFGHJKLSDFG'0123456789-QWERTYUIOP-ASDFGHJKL-ZXCVBNM.QWERTYUIOASDFGHJKLXCVBNM,SDFGHJWERTYUI3456789091234567890-=QWERTYP[]=-=ASDFGHJKL;'-ZXCVBNM,./1234567890-DERTYUIOP[DFGHJKL;XCVBNM,.ASDFGHJKQWERTYUIO12345678_ZXCVBNM,.ASDFGHJK LATIN_ABCDEFGHIJKLMNOPQRSTUVWXYZ$KIRILIK_ABWEVZIJKLMNOPRSTUFHC`[]YX'Q0QWERTYUIOASDFGHJKLXCVBNM,234567890ASDFGHJKXCVBNMGENKA'NEPROTIVOKONSTITUCIONSTVUVATELSTVUVAJTELISICHARNICITE	OKSIMORONDILANGAGAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "/.9./\-01234567890-SDFGHJKL-ZXCVBNM-012345(#90-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-*-01234567890-SDFGHJKL-ZXCVBNM-01234567890-.XCVBNM,XCVBNMXCVBNMBNMCVBNMXVBNM,.XCVBNMSDFGHJ3ASDFGHJKLDFGHJKL;'SDFGHJKL;SDFGHJKL;DFGHJKL;SDFGHJK  oWpX"pX@(#'*pX                                                  /.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-1.11.___-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..10.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.9./\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.8.__-01234567890-SDFGHJKL-ZXCVBNM-01234567890-/.7.\/-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.6.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..5._-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..4.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890--.3.-01234567890-SDFGHJKL-ZXCVBNM-01234567890-..2.\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-0.1.\\\-01234567890-SDFGHJKL-ZXCVBNM-01234567890-$DFGHJKL;ERTYUIOP4567890SDFGHJKXCVBNM	WERTYUIOPGAGA2q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ASDF   {90                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1234567PET
1234567890 (  0 $MEM  )     0000000000000001 ,                             (  1 $ACC  )     0000000000000010 ,                             (  2 $REG  )     0000000000000110 ,                             (  4 $SEG  )     0000000000010000 ,                             (  6 $IMM  )     0000000001000000 ,                             ( 0D $M/R  )     0010000010001111 ,                             0B CONSTANT $BYTE                                                1 CONSTANT $ACC        $W $ACC OR  CONSTANT W$ACC               2 CONSTANT $REG        $W $REG OR  CONSTANT W$REG              80 CONSTANT $W                    \ require word reg or operand 66 CONSTANT OP16PFX                \ 16 bit operand prefix byte 67 CONSTANT ADR16PFX               \ 16 bit address prefix byte 0F CONSTANT INS0FESC              \ 0F 80386-instruction escape                                                                 WSIZE 2 * EQU 2WSIZE                                                                                                            0 NM: POP SWAP! ;M                                              1 NM: @ PUSH ;M HERE 2- CONSTANT NONE                           2 MAKER DOER ,   : UNDO NONE ' 2+ 2+ ! ;                                                                                        NONE DOER WHAT                                                                                                                  : TRY   TO WHAT  ." SAY SOMETHING"                                      TO WHAT  ." SAY NOTHING"                                        TO WHAT  ." SAY HELLO" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ BIT ARRAYS  BITGET BITSET                                     MARKER -BITS                                                     0 VALUE MASK    0 VALUE ?A \ ADDRESS                           : ?MA ( IND BASE - ?A MASK )                                    \   SWAP 16 /MOD SWAP 2^ PUSH  2* + POP ;                       OVER 2/ 2/ 2/ + TO ?A   7 AND 2^ TO MASK ;                      : CLARYB 8 /MOD SWAP IF 1+ THEN CLARY ;                         0 NM: ?MA MASK NOT ?A C@ AND ?A C! ;M  \ CLEAR                  1 NM: ?MA ?A C@ MASK OR ?A C! ;M  \ SET                         2 NM: ?MA ?A C@ MASK AND 0<> ;M  \ GET                          3 MAKER BITS: CLARYB                                                                                                            32 BITS: 32B                                                    : SHOW 32 0 DO I 32B . LOOP ;                                                                                                                                                                   \ BIT ARRAYS  BITGET BITSET                                     MARKER -BITS                                                    ' SELF 4 + @ DUP  CODE, @SELF+      2+  CODE, SELF+             CODE ?16/MOD 1 #, AX MOV, 15 #, CX MOV,  BX CX AND,  AX SHL,     CX BX XOR,  AX PUSH,  3 #, CL MOV,   BX SHR, NEXT, END-CODE    : ?B ?16/MOD SELF+ @ AND 0<> ;                                  : XB ?16/MOD SELF+ XOR! ;                                       : 0! DUP ?B IF XB ;THEN DROP ;                                  : 1! DUP ?B IF DROP ;THEN XB ;                                  : SHOW 0 DO I ?B . LOOP ;                                       VARIABLE 16B        16B TO SELF                                 VARIABLE 32B 0 ,                                                                                                                                                                                                                                                                                                                \ BIT ARRAYS  BITGET BITXOR                                     MARKER -BITS  ' SELF 4 + @ DUP CODE, @SELF+    2+  CODE, SELF+  : ;SELF POP SELF PUSH PUSH TO SELF CO POP TO SELF ;             CODE ?8/MOD 1 #, AX MOV, 7 #, CX MOV,  BX CX AND,  AX SHL,       CX BX XOR,  AX PUSH,  3 #, CL MOV,   BX SHR, NEXT, END-CODE    : ?B ?8/MOD SELF+ C@ AND ;      : XB ?8/MOD SELF+ XOR! ;        : 0! DUP ?B IF XB ;THEN DROP ;  : 1! DUP ?B IF DROP ;THEN XB ;  : CLARYB 8 /MOD SWAP IF 1+ THEN CLARY ; : ?B. ?B 0<> NEGATE . ; 0 NM: ;SELF XB ;M ( XOR)        1 NM: ;SELF ?B ;M ( GET)        2 MAKER BITS: CLARYB    210 BITS: P210   \ STEP END             : BMP CREATE , DOES> @ SWAP 0 DO I OVER EXEC OVER +LOOP 2DROP ; ' ?B. BMP BSHOW ' XB BMP BNEG ' 1! BMP BSET  ' P210 4 + TO SELF 2 210 BSET  3 210 BSET  5 210 BSET  7 210 BSET  1 210 BNEG      : ?P, 0 DO I ?B IF I C, THEN LOOP ;  0 BARY OFS210  210 ?P,     -->                                                                                                                              256 BITS: P256    ' P256 4 + TO SELF  2 256 BSET  3 256 BSET    5 256 BSET 7 256 BSET  11 256 BSET  13 256 BSET  17 256 BSET   1 256 BNEG  11 1!  13 1!  17 1!  3 1! 5 1!  7 1!   2 1!  1 1!   4 BARY B4  : B4@ 0 B4 2@ SWAP ;  : B4! SWAP 0 B4 2! ;           : ;B4 POP B4@ PUSH PUSH PUSH B4!  CO POP POP B4! ;              : UNLOOP POP RDROP RDROP  RDROP PUSH ; : ;NIP CO NIP ;          : UMIN 2DUP U< IF DROP ;THEN NIP ;                              : HIBIT SWAP ;SELF FOR R@ SELF+ C@ ?DUP IF R@ UNLOOP 8 *        SWAP BEGIN 2/ ?DUP WHILE PUSH 1+ POP REPEAT ;THEN NEXT -1 ;     : B4MAX 0 B4 4 HIBIT ;  : B4MOD PUSH B4@ POP UM/MOD 2DROP ;     : BSQRT ;NIP DUP 1+ 0;  2DUP OR 0; RDROP  ;B4 B4MAX                  2/ 1+ 2^ 1- DUP BEGIN +2/ PUSH  B4@ R@ TO U/MOD NIP             DUP R@ - ABS 2 U< IF POP UMIN ;THEN POP AGAIN ;   -->                                                                                                                                                                                                      : ISPRIME ;B4 B4MAX 8 < IF 0 B4 C@ P256 ;THEN                        210 B4MOD P210 0= IF 0 ;THEN  B4@ BSQRT ;SELF                 11 BEGIN DUP  SELF 256 < IF  P256 ELSE  DUP 0 RECURCE THEN      IF DUP B4MOD 0= IF DROP 0 ;THEN THEN                            SELF OVER - 0;  2+ SELF OVER < UNTIL ;                       : ?PRIME B4@ ISPRIME ;                                          : >PRIME B4MAX 7 < IF BEGIN 1 0 B4 +! B4@ DROP P256 UNTIL ;THEN   BEGIN BEGIN B4@ 2. D+ B4! 210 B4MOD P210 UNTIL ?PRIME UNTIL ; : PRIME. 67 OUTC < IF CR THEN  B4@ UD. ;                        : PRIMES  FOR >PRIME PRIME. NEXT ;                              : NPRIMES PUSH B4! POP ?PRIME IF 1- PRIME. THEN PRIMES ;                                                                                                                                                                                                                                                                                                                                        \ ' P209 4 + TO SELF       11 209 BSET  19 209 BSET             \ ' P221 4 + TO SELF       13 221 BSET  17 221 BSET             : SQRT 1 BEGIN 2DUP / OVER - 2 / DUP WHILE + REPEAT DROP NIP ;                                                                  : USQRT 1 BEGIN 2DUP U/ OVER - 2 / DUP                                   WHILE + REPEAT DROP NIP ;                                                                                              : SQRT 1 BEGIN 2DUP / OVER - 2 / DUP WHILE + REPEAT DROP NIP ;  : SPRIME ;SELF SELF 256 U< IF SELF  P256 ;THEN                        SELF 210 MOD P210 0= IF 0          ;THEN  SELF SQRT 11    BEGIN DUP P256 IF SELF OVER MOD 0= IF 2DROP 0 ;THEN THEN        2+ 2DUP < UNTIL ;                                                                                                               \ : ;MM 2DUP CO IF DROP ;THEN NIP ;   : MIN ;MM < ;             \ : MAX ;MM < 0= ; : UMIN ;MM U< ; : UMAX ;MM U< 0= ;                                                                           MARKER -PRIM                                                    : MAXBIT 0 SWAP BEGIN ?DUP WHILE 2/ PUSH 1+ POP REPEAT 1- ;     : DMAXBIT ?DUP IF NIP MAXBIT 16 + ;THEN MAXBIT ;                : UDSQRT 2DUP OR 0= IF DROP ;THEN DUP 1+ 0= IF NIP ;THEN           2DUP DMAXBIT  2/ 2^ DUP 1- OR DUP  BEGIN +2/ PUSH                 2DUP R@ TO U/MOD NIP      DUP R@ - ABS 2 U<                   IF NIP NIP POP 2DUP U< IF DROP ;THEN NIP ;THEN POP AGAIN ;   : NMOD PUSH 2DUP POP UM/MOD 2DROP ;                             : ?30  DUP 16 U< IF 2^ 10370 AND ;THEN 16 - 2^ -24438 AND ;     : PRIM DUP 0= IF DROP DUP 16 U< IF 2^ 10414 AND ;THEN              DUP 32 U< IF ?30 ;THEN  0  THEN       30 NMOD ?30 0=            IF 2DROP 0 ;THEN 2DUP UDSQRT  5 DO  I 30 MOD ?30 IF I NMOD     0= IF 2DROP RDROP RDROP RDROP 0 ;THEN    THEN 2 +LOOP OR ;    : NP DO I 0 PRIM IF I . THEN LOOP ;  : N. FOR . NEXT ;          : -NP DO I 0 PRIM IF I NEGATE 0 PRIM IF I . THEN THEN LOOP ;                                                                    ( 'KuLB C&' E0n[ Z e"[ '"rO! RM<s '#iY ${%w: 4W                     )   MARKER -SUDOKU            \ SUDOKU                        VOCABULARY SUDOKU  SUDOKU  TO SUDOKU                          \ : LOOPS POP CSP PUSH TO CSP FOR CSP EXECUTE NEXT POP TO CSP ; \ : X. ;DROP SZDOK CR LOOPS WCOUNT . ;                          CODE ?8/MOD+    BX DX MOV, BX POP,  1 #, AX MOV, 7 #, CX MOV,        BX CX AND,  AX SHL,  CX BX XOR,  AX PUSH,  3 #, CL MOV,         BX SHR, DX BX ADD, NEXT, END-CODE                          CODE OR! AX POP,  AX 0 /BX OR, BX POP, NEXT, END-CODE           CODE CLR! AX POP, AX COM, AX 0 /BX AND, BX POP, NEXT, END-CODE                                                                  : 1! ?8/MOD+ OR! ;      : 0! ?8/MOD+ CLR! ;                     : ARYB CREATE C, DOES> C@ PUSH 8 /MOD HERE OVER R@ FILL ALLOT          ?DUP IF 2^ 1- POP AND C, ;THEN RDROP ;                   -1 ARYB STARYB           0 ARYB CLARYB                                                                                          \ >MATRIX    \ SUDOKU MATRIX  \ 0 0 0  0 0 0  0 0 0             \ : EMITER CREATE C, DOES> C@ EMIT ;                            \ FINDER: NN?   2^ M AND ;                                      \ FINDER: FF?   NQ C@ 0= ;                                      : ;SPACE CO SPACE ;                                             : X. ;SPACE ;SPACE ;DROP SZDOK CR LOOPS WCOUNT 4 .R ;           : Y.    0 BITX X.  ." X,P= " X . P .                                    0 BITY X.  ." Y,M= " Y . M .                                    0 BITQ X.  ." Q,T= " Q . T .                              DISPLAY                                                       ;                                                                                                                                                                                                                                                                                                                                                                                               >MATRIX                                                                                                                                                                                           3 0 0  0 9 5  0 8 0                                             0 0 9  0 0 0  2 5 0                                             8 5 0  7 0 0  0 0 0                                                                                                             0 8 1  0 0 0  0 0 5                                             9 0 0  0 0 0  0 0 2                                             6 0 0  0 0 0  3 1 0                                                                                                             0 0 0  0 0 9  0 3 1                                             0 4 6  0 0 0  5 0 0                                             0 9 0  2 1 0  0 0 6                                                                                                                                                                           MARKER -SUDOKU            \ SUDOKU                                VOCABULARY SUDOKU  SUDOKU  TO SUDOKU      3 CONSTANT SUBDOK   SUBDOK DUP *  CONSTANT SZDOK     SZDOK DUP *  CONSTANT QSUD      0 VALUE Q  0 VALUE P  0 VALUE M  0 VALUE T   0 VALUE FDISK      0 VALUE X  0 VALUE Y  0 VALUE N  0 VALUE C   QSUD QARY NQ      SZDOK WARY QP        SZDOK BARY QT  : C+ C 1+ TO C ;            SZDOK WARY BITQ      SZDOK WARY BITX      SZDOK WARY BITY       : X!  PUSH 8 /MOD PUSH 2^ POP POP +  XOR! ;     \ XOR BITS      : LOOPS POP CSP PUSH TO CSP FOR CSP EXECUTE NEXT POP TO CSP ;   : ;EXIT? CO KEY UNPACK DROP $ DF AND C" S = IF PAGE QUIT THEN ; : ;P POP P PUSH PUSH TO P CO POP TO P ;   : ;DROP CO DROP ;     : P+ P 1+ TO P ;   : @P+ P NQ C@ P+ ;     : !P+ P NQ C! P+ ;    : FINDER: : DOES> CSP PUSH TO CSP FOR R@ CSP EXECUTE               IF POP RDROP RDROP 1 POP TO CSP ;THEN NEXT 0 POP TO CSP ;    FINDER: IN?   2^ M AND ;  FINDER: EMPTY? NQ C@ 0= ;  -->                                                                        ' EMIT VECTOR 'EMIT  : QT>P Q QP @  T QT C@ + TO P ;            : NUMSET   X BITX @  Y BITY @  AND  Q BITQ @ AND  TO M ;        : @QXY! P NQ COUNT SWAP  COUNT TO Q  COUNT TO X  C@ TO Y ; \ CNT0 VECTOR DISPLAY FINDER: T? TO T QT>P @QXY! 0= ;    200 LOAD    FINDER: FULL? NQ C@ ;   FINDER: INQ? BITQ @ ;                   : XFIX P NQ C!  N X BITX X!  N Y BITY X!  N Q BITQ X! ;         : FIX   DUP TO N  1+ XFIX ;  : UNFIX  @QXY! 1- TO N  0 XFIX ;   : TRY QSUD EMPTY? IF  TO P  @QXY! DROP  SZDOK TO N                 BEGIN NUMSET  N IN?  WHILE   P PUSH  FIX  C+                    RECURCE  POP TO P     UNFIX  REPEAT ;THEN DISPLAY ;          : TRYQ SZDOK INQ? IF TO Q  SZDOK T? IF DROP  SZDOK TO N            BEGIN NUMSET N IN?  WHILE T Q PACK PUSH FIX C+ RECURCE POP    UNPACK TO Q TO T QT>P  UNFIX REPEAT THEN ;THEN DISPLAY ;       : ;BASE POP BASE PUSH PUSH TO BASE CO POP TO BASE ;             : ;FDISK  FDISK  CO  1K 1- AND TO FDISK ;          -->          \ N Q X Y  ORDER  ->   BYTE BYTE BYTE BYTE                      : ;QT Y SUBDOK /MOD SZDOK * PACK CO UNPACK + Y ; : T>P ;QT ;    : ?- DUP IF 1- ;THEN DROP SUBDOK 1- ; : Q>P ;QT SUBDOK * ;      : SUD-INI  SUBDOK DUP DUP  TO N  TO Q  TO M    QSUD NQ ;P         SZDOK DUP TO Y   LOOPS Y 1- TO Y ( Y) SZDOK 2^ 1- DUP DUP       Y BITX !  Y BITY !  Y BITQ !   Q ?- TO Q  SZDOK DUP TO X ( X)   Q>P QP !   T>P QT C!    LOOPS X 1- TO X                         0 ( N) M ?- DUP TO M 1+ SUBDOK =    IF N ?- TO N THEN                Y Q - N + ( Q) X Y  4 LOOPS  P 1- DUP TO P C! ;            SUD-INI  \ TRY                                                : SPACE bl 'EMIT ; : CR cr 'EMIT lf 'EMIT ;                     : TYPE ;DROP LOOPS COUNT 'EMIT ;  : ". COUNT TYPE ;             : UM+ 0 SWAP 0 D+ ;     : DM+ SWAP PUSH UM+ POP + ;             : DM* TUCK UM* DROP PUSH UM* POP + ;                            : M*+ PUSH BASE DM* POP DM+ ;   : >NUMBER bl WORD NUM DROP ;    -->                                                                                                                             : C. C . 0 TO C ;                                               : MATRIX.  CR C. 0 ;P                                                              SUBDOK LOOPS CR SUBDOK   LOOPS CR  SUBDOK        LOOPS  SPACE  SUBDOK LOOPS  SPACE @P+  ALPHA 'EMIT ;        : SUD. ;EXIT? MATRIX. ;        ' SUD. TO DISPLAY                                                                                : N!+ ( N UMBER )  \ AT  POSITION  P                            DUP SZDOK 1+ U< 0= A" NUMBER NOT IN RANGE!"   @QXY!               2DUP = IF 2DROP P+ ;THEN         \ SAME - NOTHING TO DO         ?DUP   IF 1- TO N  0 XFIX THEN  \ REMOVE OLD NUMBER             ?DUP  IF  1- TO N                                                   NUMSET  N 2^ M AND 0= A" NUMBER DON'T FIT!"                    N 1+ XFIX  THEN    P+ ;                                    -->                                                                                                                                                                                             : LINE# ;DROP ;DROP SZDOK LOOPS BASE UM/MOD ;                   : LINE! [ SZDOK 1+ ] LITERAL ;BASE LINE# SZDOK LOOPS N!+ ;      : LINE@ 10 ;BASE 0 0 SZDOK LOOPS @P+ M*+ ;                      : >D94 bl WORD ;DROP 94 ;BASE  PUSH  0 0 POP COUNT                              LOOPS COUNT C" ! - SWAP PUSH M*+ POP ;          : D94. 94 ;BASE S# HLD FOR C" ! + 'EMIT NEXT SPACE ;            : BOARD.  0 TO P  SZDOK LOOPS LINE@ D94. ;                      : >BOARD  SUD-INI  0 TO P  SZDOK LOOPS >D94 LINE! ;             : >MATRIX SUD-INI 10 ;BASE 0 TO P  SZDOK LOOPS                         SZDOK LOOPS >NUMBER DROP N!+ ;                                                                                                       -->                                                                                                                                                                                                                                                                                                                 : ON-BLK  201 BLOCK FDISK + UPDATE ;                            : TO-DISK DUP bl U<    IF CASE                                          cr OF ;FDISK 1L NEGATE AND EXIT  ENDOF                          lf OF ;FDISK 1L +          EXIT  ENDOF                     ENDCASE bl   THEN     ON-BLK C! ;FDISK 1+ ;                                                                                  : ;EMIT POP [ ' 'EMIT 4 + ] LITERAL @    PUSH PUSH  TO 'EMIT         0 TO FDISK  ON-BLK 1K BLANK  CO  FLUSH POP TO 'EMIT ;      : BOARD> ['] TO-DISK ;EMIT " >BOARD " ". BOARD. ;               : MATRIX> ['] TO-DISK ;EMIT " >MATRIX " ". MATRIX. ;            : EMPTY> SUD-INI MATRIX> 201 EDIT ;                                                                                             -->                                                                                                                                                                                                                                                             \ SUDOKU EVRISTIKI                                              : ONE? DUP DUP 1- AND 0= AND ;  0 QUAN CNT : CNT+ 1 AT CNT +! ; : ;CNT POP CNT PUSH PUSH 0 TO CNT CO  CNT  POP TO CNT ;         : REG+ N 1+ XFIX CR P . CNT . DISPLAY ;                         : BIT8? 0 SWAP BEGIN 2/ ?DUP WHILE PUSH 1+ POP REPEAT ;         : BITPOS UNPACK ?DUP IF NIP BIT8? 8 + ;THEN BIT8? ;             FINDER: EV?  TO P @QXY! 0= NUMSET  M ONE? AND ;                 : FULL. ;CNT QSUD BEGIN FULL? WHILE DUP . CNT+ REPEAT ;         : EMPTY. ;CNT QSUD BEGIN EMPTY? WHILE CNT+ DUP . REPEAT ;       : EVTRY ;CNT BEGIN QSUD EV?                                        WHILE DROP CNT+ M BITPOS TO N REG+ REPEAT ;                  : EVTRY2 ;CNT QSUD BEGIN  EV?   WHILE CNT+ DUP .  REPEAT ;      -->                                                                                                                                                                                                                                                             : ON-LINE?  @QXY! DROP  N 2^  Y BITY @ AND  0;  P ;P               SUBDOK LOOPS  @QXY! P+ 0=                                         IF  NUMSET M N 2^ AND IF CNT+ THEN  THEN ;                 : ONLY1?N  P ;P  ;CNT  Q QP @ TO P    SUBDOK LOOPS                   ON-LINE?  P SUBDOK + TO P ;                                : EVTRY3 ;CNT BEGIN  QSUD EMPTY?                                      WHILE TO P @QXY! DROP  SZDOK TO N                           BEGIN  NUMSET  N IN?  WHILE  TO N ONLY1?N 1- 0=                     IF REG+ THEN REPEAT   REPEAT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ SUDOKU   EASY                                                 \ >BOARD  "1c "*TD4 &5"Wo {Ark (flQ7 n"a jJ`o $4zwe $yp_Q       \ >BOARD *'u(\ >!I2 kM i8(/ (+4c -(X.) du} &S--? (in0!          \ >BOARD )dYj< %mm% #W*BX *I/K *\N{ (18:' $pp3Q -ha5 &,[S"                                                                      \ SUDOKU   MIDDLE                                               \ >BOARD "#>sk D;c= )?#] ""{ %*^' "0?.K (Ea *'SME E,4W           >BOARD $p=iq +oXA +u5Y! "$R%2 ,RW%+ (aE'# "#( XE$# "/ZCw                                                                       \ SUDOKU   HARD                                                 \ >BOARD eM1 &,Z[? "+jN' *\GU #nfk "B[L# &gq %fN;^ Nz/          \ >BOARD  'KuLB C&' E0n[ Z e"[ '"rO! RM<s '#iY ${%w:            \ >BOARD V; "/K_[ ")AJ; "E#zK +wQU Yai "V1a 9)Z= +8uZ;                                                                                                                                                                                                          \ : OBJECT: VOCABULARY 0 , 0 , ;                                \ : ;OBJECT ;                                                   \ : FIELD                                                       \ CLASS: REGS:      F: _SP ;F 2Z,  F: _DS ;F   ,  F: _ES ;F   , \  0 F: _BP ;F 2Z,  F: _DI ;F 2Z,  F: _SI ;F 2Z,  F: _DX ;F 2Z, \  0 F: _CX ;F 2Z,  F: _BX ;F 2Z,  F: _AX ;F 2Z,  F: _FL ;F 2Z, \ ;CLASS                                                                                                                        \ CLASS: REGS:  0  WREG _SP  WREG _DS  WREG _ES ;F              \  0 F: _BP ;F 2Z,  F: _DI ;F 2Z,  F: _SI ;F 2Z,  F: _DX ;F 2Z, \  0 F: _CX ;F 2Z,  F: _BX ;F 2Z,  F: _AX ;F 2Z,  F: _FL ;F 2Z, \ ;CLASS                                                        CREATE OBJ 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 ,                                                                                                                                                                                                        ' IOB @  1 NM:                                                  : FIELD                                                         : WREG                                                          : BREG                                                          : DREG                                                                                                                          CLASS: REGS:  0 8 FAMYLY BREG _AL _AH _BL _BH _CL _CH _DL _DH                0 14 FAMYLY WREG _AX _BX _CX _DX _SI _DI _BP _SP                                   _ES _CS _DS _SS _FL _IP         ;CLASS                                                                                                                                                                                                                                                                                                                                                                                                                                                          : ;SELF POP SELF PUSH  TO SELF  PUSH CO  POP TO SELF ;          : SEND NOOP  SWAP ;SELF EXEC ;  ' SEND 1-!                      M: POP DUP 2+ PUSH @ SEND ;M  ' SEND 2+ !                       : @SELF+ @ SELF + ; : XEP XCHG EXECUTE POP ;                    1 NM: @SELF+ ;M   : INTRO 2@ XEP @SELF+ ;  1 NM: INTRO CMOVE ;M 2 NM: INTRO ;M     \ WHERE IS DATA OF THE FIELD + SIZE          : FINIT ( OFFSET SIZE - NEWOFFSET)   2DUP , , + ;               3 MAKER FIELD FINIT                                             : CLASS: COMPILE [ MHP , ] ALSO HERE COMPILE [ ' FORTH @ 1+ , ]   COMPILE [ 1 C, bl C, ] 2Z, WORDLIST EXEC DEFINITIONS  ;       : ;CLASS   ;METHOD  DROP ;                                      : [SEND] METHOD: ' COMPILE TO SEND , ;METHOD ;  IMMEDIATE       : ACTOR CREATE METHOD: ' , ;METHOD , DOES> 2@ SEND ;                                                                                                                                                                                                            CODE BSWAP CX POP,  AX AX XOR,  CX BX XCHG,                        BEGIN, 1 # BX SHR, 1 #, AX RCL,  CXZ, UNTIL,                                                                                                                                                 \ 6 3 **                                                        100 CONSTANT 1.                                                 : 1* 1. * ;                                                     : /. PUSH PUSH 1* 1. POP POP */ + ;                             : ./. 1. /MOD . . ;                                                                                                             3 5 6 /.   1 65 100 /. + ./.                                                                                                    : ALPHA 9 OVER U< 7 AND + 48 + ;                                                                                                                                                                                                                                ' EMIT VECTOR 'EMIT  : UM/MOD TO U/MOD ;                        : DM/MOD TUCK U/MOD PUSH SWAP UM/MOD POP ;                      : 1# BASE DM/MOD  AT HLD 1+! ;                                  : S# AT HLD  0! BEGIN 1# 2DUP OR 0= UNTIL 2DROP ;               : LOOPS POP CSP PUSH TO CSP FOR CSP EXECUTE NEXT POP TO CSP ;   : ;BASE POP BASE PUSH PUSH TO BASE CO POP TO BASE ;             : SPACE bl 'EMIT ; : CR cr 'EMIT lf 'EMIT ;                     : TYPE ;DROP LOOPS COUNT 'EMIT ;  : ". COUNT TYPE ;             : UM+ 0 SWAP 0 D+ ;     : DM+ SWAP PUSH UM+ POP + ;             : DM* TUCK UM* DROP PUSH UM* POP + ;                            : M*+ PUSH BASE DM* POP DM+ ;                                   : D94. 94 ;BASE S# HLD FOR C" ! + 'EMIT NEXT SPACE ;                                                                                                                                                                                                                                                                            \ NOP ; @+ !+ PUSH POP DUP XCHG +2/ AND XOR LIT IF JUMP NEXT CAL0 VALUE HP  0 VALUE EP  0 VALUE KP  : DROP IF THEN ;    : NOP ; CREATE (EMIT ] EMIT EXIT [  CREATE (KEY ] KEY EXIT [            : EMIT EP PUSH ; : KEY KP PUSH ; (EMIT TO EP  (KEY TO KP        : @+ @+ ;  : !+ DUP 2+ PUSH ! POP ;    \ MAC: #BASE 10 ;        : XCHG POP POP ROT PUSH SWAP PUSH ;  : SWAP PUSH XCHG POP ;     : @ @+ DROP ;  : ! !+ DROP ;    : EX POP XCHG PUSH ;            : XEP XCHG EXECUTE POP ; : ;SWAP EX SWAP ; : ;DROP EX DROP ;    : +2/ 2DUP +2/ PUSH + POP ; : LIT POP @+ PUSH ;  : + +2/ DROP ; : OVER PUSH DUP XCHG POP ; : NOT -1 XOR ;  : ODD 1 AND ;        : CAL POP @+ PUSH PUSH ; : JUMP POP @ PUSH ; : SKIP POP 2+ PUSH ; : 1-IF 1- DUP 0< TO (BR TO JUMP  (BR TO SKIP ;                ' >MARK  ' CAL (( ?CALL         ' >MARK ' NXT  (( ?FOR          ' <MARK  ' >R  (( FOR           ' ,<MARK  ' NXT  (( NEXT                          -->                                                                                                           : 1- PUSH ?FOR -1 ;THEN POP ;  : NEGATE 1- NOT ;                : - NEGATE + ;  : UM+ +2/ 0< ODD ;                              : D+ ROT + PUSH UM+ POP + ; : S>D DUP 0< ;   : DM+ S>D D+ ;     : DNEGATE OVER IF NOT XEP THEN NEGATE ; : D- DNEGATE D+ ;       : R POP POP DUP PUSH PUSH XCHG ;  : UR POP R PUSH XCHG ;        : TIMES 1- DUP 0< IF DROP RDROP ;THEN                                                           FOR UR EXECUTE NEXT RDROP ;     : _NAND  AND NOT ;  : _NOT DUP _NAND ;                          : _AND _NAND _NOT ; : _OR _NOT SWAP _NOT _NAND ;                : _XOR OVER OVER _NAND DUP PUSH _NAND XCHG _NAND POP _NAND ;    : TEST 20 TIMES UR . ;                                                                                                                                                                                                                                                                                                                                                                          MARKER HARABI  : COMPILE R> STR , >R ;                          TO ASSEMBLER : BE ' ! ; : AT' ' @ ;    : X, SP BP XCHG, ;         : /CODE NEXT, END-CODE ; TO FORTH                             0 CODE, XCHG 0 CODE, AND  0 CODE, XOR 0 CODE, (?BR 0 CODE, (LIT 0 CODE, (BR  0 CODE, (SKP 0 CODE, I   0 CODE, J  0 CODE, DUP    CODE (-BR BX DEC, 0<, IF,  HERE BE (BR 0 /SI SI MOV, NEXT,            HERE BE (?BR  BX BX OR, BX POP, AT' (BR JZ,               THEN, HERE BE (SKP  SI INC, SI INC, NEXT,                             HERE BE XCHG  0 /BP BX XCHG, NEXT,                              HERE BE AND   AX POP, AX BX AND, NEXT,                          HERE BE XOR   AX POP, AX BX XOR, NEXT,                     HERE BE DUP BX PUSH, NEXT, HERE BE (LIT BX PUSH, LODSW,              HERE BE I     BX PUSH, 0 /BP BX MOV, NEXT,                      HERE BE J     BX PUSH, 2 /BP BX MOV, NEXT,  END-CODE      ' >MARK  ' (-BR  (( +IF       ' >MARK  ' (BR   ((  AHEAD        ' ,<MARK ' (BR   ((  AGAIN    ' ,<MARK ' (?BR  ((  UNTIL  -->   ' >MARK  ' (?BR  ((  IF       ' ,<MARK ' (-BR  ((  +UNTIL       \ CODE PUSH   X, BX PUSH,  X, BX POP, /CODE                     \ CODE POP    BX PUSH, X, BX POP,  X, /CODE                     : FOR [',] BEGIN [',] +IF COMPILE PUSH ; IMMEDIATE              : NEXT COMPILE POP [',] AGAIN [',] THEN ; IMMEDIATE             : TEST 20 FOR I . NEXT ;                                        CODE @+ 0 /BX PUSH, 2 #, BX  ADD, /CODE                         CODE !+ 0 /BX POP,  2 #, BX  ADD, /CODE                         CODE +2/   AX POP, AX BX ADD, BX PUSH, 1 #, BX RCR,  /CODE      CODE OVER  AX POP,  AX PUSH,  BX PUSH,  AX BX XCHG,  /CODE      CODE (#    BX PUSH, LODSW,   AX BX  XCHG, /CODE   \ LIT         CODE ;;    X, SI POP, X, /CODE                                  CODE CAL   LODSW, X, SI PUSH, X, AX SI XCHG, /CODE              : ELSE [',] AHEAD  SWAP [',] THEN ; IMMEDIATE                   ' +IF ALIAS   +WHILE  IMMEDIATE                                                                                                 MARKER -ASM -MAC F83    232 LOAD                                                            39 42 THRU                          \ : ;BASE POP BASE PUSH PUSH  TO BASE EX POP TO BASE ;          \ : .. 10 ;BASE . ;   : BDUMP DO I C@ 1B. SPACE LOOP ;          : BK1 HERE 1- TO HERE ;  \ : Q BLK .. >IN .. DECIMAL QUIT ;     \ : TEST 2DUP - DUP . 5 U< IF BDUMP ;THEN 2DROP ;               \ : IN. >IN PUSH BLWORD COUNT TYPE SPACE POP TO >IN ;           128 CONSTANT bSGN  \ : ?SHOW .TEST IF S. DUP 2- ?ID.  THEN ;    : >NEXT< PUSH -2 ALLOT   TO >MARK   2 ALLOT POP DW, ;           : F83 ONLY  S0 TO SP F83 FORTH ALSO ; F83   222 LOAD                                                                                                                                                                                                                                                                                                                                                                                                            0 VALUE TMPT : T. SP TMPT - H. SP TO TMPT BLK 4 .. CR ;         : ;BASE POP BASE PUSH PUSH  TO BASE EX POP TO BASE ;            : CODE, HEADER DW, ;    : SAVE2 AT ALLOT ;  : 0, 0 C, ;         : OR! DUP PUSH @ OR POP ! ; : 0; IF ;THEN RDROP ;               : (MAKER SAVE2 HERE @ CODE, ;    CREATE TT ' TT @ FORGET TT     ' IF @ CODE, CREATE   DW,  ' (MAKER DW,                          4 TO HEADER 0 VECTOR VC : TOKEN BLWORD ; : ;2DROP EX 2DROP ;   \ : J POP POP R@ -ROT PUSH PUSH ;                               : ?-CREATE ;2DROP >IN TOKEN 1+ @ $ 2D2D XOR 0; TO >IN RDROP VC ; : LOOPS  SKIP BEGIN R@ SWAP PUSH EXECUTE POP  THEN                           1- DUP 0< UNTIL  POP 2DROP ;                       236 LOAD  \ NUMBER                                             : (DNUM TOKEN ATOI ;                                            : FAMILY   ' TO VC  ;2DROP LOOPS DUP ?-CREATE OVER + ;          : NFAMILY  ' TO VC 1H ;BASE  LOOPS (DNUM ?-CREATE ;                                                                              221 LOAD      233 LOAD  \ ASSEMBLER                             0 0 10 FAMILY VALUE  .SHOW .PUSH .SWAP                                 .RST .DOES .PC .NOP .START  .RSOP .OS                   : TESTER CURRENT @ SWAP FOR DUP                                     IF DUP ID. COUNT 31 AND + STR SWAP @ .H THEN NEXT DROP ;    : NEXT, .NOP JMP, ;  : END-CODE ?CSP ;  : /ASM END-CODE ;       : /JMP JMP, END-CODE ;  : /CODE .NOP /JMP ;                                                                                     F83     PRUNE     \   -HEADERS                                  : OS, .OS LCAL, ;                                                                                                               \ 32 TESTER CR  \ OR ;. +* -/ NIP A! B! A@ B! C!+  C@+ AHED     -->             \ (V (C (S (E (OF UC@+ U@+  STR  CSTR                                                                                                                                                                                                           VOCABULARY  VFORTH   VFORTH ALSO  TO VFORTH                     HERE TO .START  ASM/ CALL?, DW?,  0 DW,                                  CALL?, DW?,  0 DW,  HERE TO .RST  -2 DW, $ 0FE00 DW,   SWAP,  \ -HEADERS                                               0 0 53 FAMILY CODE,   ;-   (DZ  (:   EXEC XCHG EX   DROP; (":     (-NX (?BR (BR  (FOR (-BR (CAL (#BR EXIT 0;   0<;  IF;  AHED     (#   POP  PUSH SWAP OVER TUCK DUP  DROP NOP  I    J    NIP      @+   !+   A!   A@   @R   !R+  @R+                               0<   U<   0=   OR   XOR  AND  ABS  NEG  NOT  +2/                (DK  (DE  (OS  (DL                                                  \ HEADERS                                                 THEN,  3 SET, $ 1000 DW,  $ 4A #FN, DOS,                                                                                        THEN, IDROP, CLD,  LDA, .RST DW, 5 ><,  LDA, .RST 2+ DW,  4 ><,                 /ASM     -->                                                                                                    ASM/ J?, .BE (FOR  LDW, ISWP, .BE PUSH X, DUP, X,               .BE DROP DROP, J?,  .BE IF; 1 #-, CARRY?, .BE 0; 1 #-, CARRY?,        SKIP2,  .BE 0<; 2*, LIKE DROP U<, N, J,  .BE DROP; DROP,   .BE EXIT  0 (R>I,       .BE ;-  R+, R+, J?,                     .BE (-NX  LDW, 0 (R-,  LIKE ;-  0<, J, ISWP,  J?,               .BE +2/   ADROP, +, DUP, 2/C, J?,  .BE OR ADROP, |,    J?,      .BE TUCK ADROP, DUP, ADUP, J?,  .BE XCHG  0 (XCHG,  J?,         .BE NIP  ADROP, SKIP1, .BE DUP DUP, J?, .BE AND ADROP, &, J?,   .BE SWAP  ADROP,  SKIP2,        .BE OVER  ADROP, ADUP,                HERE TO .PUSH  DUP,  HERE TO .SWAP  SWP,      J?,         .BE POP   DUP, X, DROP, X,  J?,       SCW, SCW, SCW,            .BE (DZ SCW, ADROP, DUP, W@, HERE TO .PC ISWP, X, ADUP, X,      .BE NOP THEN, THEN, THEN, THEN, THEN, THEN, THEN, THEN, THEN,           THEN, THEN, THEN, LDW, WSWP, (DJP,  SCW, SCW, SCW,      .BE (: SCW, WSWP,   .PC /JMP LIKE NOP TO .NOP -->                                                                              ASM/   .BE I     0  (R@, .PUSH JMP,                              .BE J     2  (R@, .PUSH JMP,                                    .BE A!    T>A, DROP, NEXT,      .BE A@    DUP, A>T,  NEXT,      .BE (CAL  LDW, .PC JMP,                                         .BE (#    LDW, .PUSH JMP,                                       .BE EXEC  ADROP, SWP, .NOP 1+ JMP,                              .BE (-BR  0-,  0<, N, IF,                                       .BE (BR   LDW, ISWP, NEXT,      .BE (#BR  DUP,                  .BE (?BR  0-, DROP, LIKE (BR 0=, J, THEN,                       .BE AHED  LDW, /CODE   ASM/ HERE TO .RSOP                                        CNT!, 0 (EX,  CALLC, .BE EX 0 (EX, NEXT,       .BE (":   0 #FN,  DUP, .RSOP LCAL,  T=I, LDB, I+=A, RET,        .BE !R+   ADROP, .RSOP LCAL, (I=T, SWP, LDW, RET,               .BE @R+   DUP, .RSOP LCAL, LDW, SWP, RET,                       .BE @R    DUP, .RSOP LCAL,  T=(I, RET,    END-CODE   -->                                                                       ASM/  HERE TO .OS DST@, T>A, DOS, DST!, RET,                     .BE 0=    1 #-, SKIP2,          .BE 0<    2*, CARRY?, NEXT,     .BE U<    ADROP, SWP, -,       LIKE 0< 2+ JMP,                  .BE !+    (!,  SKIP2,           .BE @+   (@, 1+, 1+, NEXT,      .BE ABS   0-, 0<, IF,   .BE NEG   1-,   .BE NOT  -1 #@, SKIP1,  .BE XOR   ADROP, ^, THEN, /CODE                                ASM/ \ .BE H/% SWP,                                              .BE (DE   2 #FN, OS, LIKE DROP JMP,                             .BE (DL  10 #FN, OS, LIKE @+  3 + JMP,                          .BE (DK  8 #FN, DOS, 0 #FN, .PUSH JMP,                          .BE (OS SWP, DROP, CNT!, DST!, DOS, ADUP, DST@, CARRY?, /CODE  \ 4 TO HEADERS                                                    LIKE @+ 2+  CODE, 2+   LIKE 2+ 1+   CODE, 1+                   0  CODE, 1-   CODE 2- 1-,    .BE 1-  1-, /CODE   -->                                                                                                                                           <%  TO FORTH                                                        : NMS> CREATE DW, DOES> @ [',] NM: ;                            0 NMS> 0M]    1 NMS> 1M]    2 NMS> 2M]                      %>  TO VFORTH     237 LOAD   \ PACH COMPILER                                                                                    : + +2/ DROP; ; SAVE2 : W>B 255 AND ;  : COUNT @+ 1- SWAP W>B ; : ! !+  DROP; ; SAVE2         : @ @+ DROP; ; SAVE2              : @;! DUP XCHG PUSH @ EX POP ! ;  : XEP XCHG PUSH EX POP ;      : C@ @ W>B ;  : C! @;! $ FF00 AND SWAP W>B OR ;                                                                                 \ : -: \ DOES> HERE 'N-NUMBER ':-HEADER '?-FIND PARSE C@+ @+    \ EXEC @EXEC ;BASE-@BASE->BASE-ATBASE IF THEN ; CMOVE> LAST     \ CORA-COMPARE.MEM , ,A COMPILE I J NEXT +C KEY 'E EMIT CSTR    \ ABORT ;code                                                   -->                                                                                                                               : (EXP OVER ! (DL COUNT ;         : ;DROP EX DROP; ; SAVE2      ' (DE DEFER 'E   : EMIT 'E CNTC 1+ TO CNTC ;  : N>L COUNT + ;   ' (DK DEFER KEY    ' (EXP DEFER EXPECT    : EXECUTE PUSH ;      0 DEFER 'INT    0 DEFER 'ERR.    0 DEFER 'OK   0 DEFER SOURCE : - NEG + ;   : TIMES FOR J EXECUTE NEXT ;- ; : (" I N>L XCHG ;                 : (TYP  TIMES COUNT EMIT ;   : (". COUNT (TYP ; : TYPE ;DROP (TYP ;      : ". (". DROP ; : (." POP (". PUSH ;   : (A" POP SWAP IF ". 'ERR. ABORT THEN N>L PUSH ;                : CORA FOR PUSH @+ 1- SWAP XCHG @+ 1- SWAP POP XOR W>B                 IF ;- DROP DROP $ 0 ;THEN NEXT DROP DROP $ -1 ;                                                                          : S= DUP C@ 1+ CORA ;                                           META (A" A"  META (" "  META (." ."        -->                                                                                                                                                                                                                  : DEC XEP J @;! 1- ; : INC XEP J @;! 1+ ; AT FORTH  VALUE LTOP    0 VALUE >IN   0 VALUE TIB<   : C+  OVER N>L ! INC ;             : T^ >IN TIB< + ;   : IN1+ >IN 1+ TO >IN ; : = XOR 0= ;       : (SCAN SKIP BEGIN IN1+ THEN >IN IF I EXECUTE UNTIL THEN ;- ;   : =? A@ 32 = 0; (SCAN T^ C@ A@ XOR ; : #? (SCAN T^ C@ A@ = ;    : PARSE SOURCE DUP A! =?  T^ #? T^ OVER - >IN 0; IN1+ ;         : S+  SWAP FOR PUSH COUNT XCHG POP C+ NEXT NIP ;                CREATE TIB 132 ALLOT : S!  $ 0  OVER ! S+ ; : , H !+ TO H ;     CREATE TBUF 34 ALLOT : TOKEN 32 PARSE 31 AND TBUF S! C@ ;       : HEAD TOKEN 0= A" TOK?" LTOP H TO LTOP                                TBUF COUNT H S! N>L TO H , ;  : HEAD, HEAD , ;           : WITHIN OVER - PUSH - POP U< ;         : 2/  $ 0  +2/ NIP ;    : ODD  $ 1  AND ;  : UM+ +2/ 0< ODD ;         : ,R @R+ , ;      : ;INT BLK XCHG  >IN PUSH  TIB< PUSH PUSH  CALL  EX POP POP POP  THEN TO BLK  TO >IN  BLK  $ -1  $ 1  WITHIN AND TO TIB< ;  -->                                                                 : ERRDIG EX 1 A" ?" ;  : ;RDROP EX ;- ;                         : -DIGIT ERRDIG 64 OVER < IF  223 AND 7 - ELSE                       DUP 58  < 0; THEN  48 - DUP 0 BASE WITHIN 0; ;- ;          : ;NEG? DUP 0; OVER C@   45 = 0; 1- PUSH 1+ POP EX NEGATE ;     : NUMBER 0 SWAP COUNT ;NEG? ;DROP TIMES                                 PUSH BASE * POP COUNT -DIGIT SWAP PUSH + POP ;                                                                          : ;L LTOP @ SKIP  BEGIN  EX N>L @ THEN DUP 0= UNTIL ;- ;        : BL 32 EMIT ;  : CR 13 EMIT 10 EMIT $ 0 TO CNTC ;              : WFIND ;L AHED BEGIN EX OVER OVER S= UNTIL ;- NIP N>L 2+ DUP ;                                                                 : .WORDS CR ;DROP ;L  BEGIN PUSH BL I .H I ". 60 CNTC U< IF CR   THEN  KEY DROP POP   EX AGAIN ;                        -->                                                                                                                                                                                                     0 VALUE BLK     0 VALUE CSP    : CSP! CSP 1+ DUP TO CSP ;       : ?CSP  CSP XOR A" PAIR?" CSP 1- TO CSP ;                       : OK BLK IF; ."  OK1" CR ;  ' OK IS 'OK  0 VALUE >INT           : (INT BEGIN >IN 0; TOKEN 0; TBUF >INT EXECUTE AGAIN ; SAVE2    : EVAL TUCK + SWAP NEG $ 0 ;INT (INT ;  0 DEFER 'INIT           : SYS 'INIT BEGIN TIB 128 EXPECT CR BL  [ HERE TO >INT ]               EVAL 'OK AGAIN ; SAVE2   : SWITCH_INT POP TO >INT ;      : [` SWITCH_INT  WFIND  IF EXEC ;THEN NUMBER ;                  : ]  SWITCH_INT  C" ` C+  WFIND IF EXEC ;THEN  DEC WFIND IF ,     ;THEN NUMBER ,R (# , ; : SYS0 'INIT (BR [ >INT DW, ] ; SAVE2  : (;; ?CSP [` ;   : (:: HEAD, CSP! ] ;                          ' EXIT  0M] STR , @ EXEC ;M    CODE, ;` DW,  ' (;; DW,          LIKE (: 0M] @+ @ EXEC ;M       CODE, :  DW,  ' (:: DW,                                                                                                                                                                                                          ' C, ALIAS DB, ' , ALIAS DW, 0 VALUE .TEST                      \ DROP 4 + ALIAS     RDROP                                      : ' ' [ ' DB, @ ] LITERAL OVER @ = IF 2+ @ THEN ;               : BE ' ! ;  \ : ;: HERE DUP .TEST TEST TO .TEST IN. ;                                                                           : LIKE ' @ ; : .BE HERE BE ; : IS ' 2+ ! ; : META ' IS ;        : 3COPY STR CODE,  STR DW,  @ DW, IMMEDIATE ;                   <%   : W!+ OVER ! 2+ ;  %>                                      LIKE BE 1- ' SEE OVER   W!+  SWAP W!+  ' ' W!+  ' bs  W!+  DROP                                                                                                                                                                                                                                                                                                                                                                                                                                                                 : ?SHOW ; IMMEDIATE                                             | : C,: CREATE C, ; | : DB> ?SHOW C@ DB, ; : @B> ?SHOW C@ ;     | : W,: CREATE >< , ; | : DW> ?SHOW @ DW, ;                     HEX : SHORT? -80 80 WITHIN ; DECIMAL                                                                                            | : HP HERE 2+ ; : ASM/ CSP! ;   : CODE HEADER HP DW, ASM/ ;    | : BOP C,: DOES> DB> ;          | : WBO W,: DOES> DW> DB, ;    | : BWO C,: DOES> DB> DW, ;      | : WOP W,: DOES> DW> ;        | : WWO W,: DOES> DW> DW, ;      | : BBO C,: DOES> DB> DB, ;    | : REL C,: DOES> DB> HP - DW, ; | : OPC C,: DOES> @B> ;        | : ROP C,: DOES> @B> OR C, ;      : /ASM  ?CSP ;               \ BLK .                                                                                       -->                                                                                                                                                                                                                               HEX  1 E8 2 FAMILY REL LCAL, LJMP,  : N, 1 XOR ;                     1 E8 2 FAMILY BOP  CALL?, JMP?,  : DW?, 0 DW, HERE ;       2 70 8 FAMILY OPC  O?, U<, 0=, U<=, 0<, P?, <?, <=,             3 NFAMILY OPC  E0 C#Z,  E3 CXZ,  EA ?,                                                                                          | : ?A DUP SHORT? 0= A" SHORT?" ;  | : -?A - ?A EX 1- C! ;      : IF,  N, DW, HERE ; | : AGN, DUP HP - SHORT? ;  : J?, ?, IF, ; : WHILE, IF, SWAP ;  | : UNTL, IF, -?A HERE ; : J, N, UNTL, ;   | : (THEN,  HERE OVER -?A SWAP ; : SJMP, ?, UNTL, ;             : JMP, AGN, IF SJMP, ;THEN LJMP, ; : ELSE, ?, WHILE, (THEN, ;   : UNTIL, PUSH AGN, IF POP  UNTL, ;THEN                           POP  N, WHILE, LJMP, (THEN, ; : BEGIN, HERE ; : AGAIN, JMP, ;  : THEN, 2- DUP @ IF 2+ (THEN, ;THEN HERE OVER                       1- C@ $ FE AND E8 = IF OVER 2+ - THEN SWAP! ;               : SWAP, SWAP ; -->                                                                                                              HEX                                                             1 58 8 FAMILY BOP ADROP, CNT!, DST!, DROP, -- -- IDROP, WDROP,  1 50 8 FAMILY BOP ADUP,  CNT@, DST@, DUP,  -- -- IDUP,  WDUP,   1 93 5 FAMILY BOP SWP,   --    --    ISWP, WSWP, DECIMAL        12 NFAMILY BOP  AC LDB, AD LDW, AF SCW, F8 CLC,  45 R+, C3 RET,    A1 LDA, FC CLD, 4B 1-, 43 1+, B1 SKIP1, B9 SKIP2,  DECIMAL   25 NFAMILY WOP FF25 (DJP,  8F07 (!,  FF37 (@, 03D8 +, D1DB 2/C,        33D8 ^, D1E3 2*,  8905 !W, 89FB W@, 891C (I=T, 89DA T>A,        89D3 A>T, FFD1 CALLC,  89F3 T=I, 01C6 I+=A, 8B1C T=(I,          87E5 X, 2BD8 -, 1BDB CARRY?, 0BDB 0-, 8B05 @W, 23D8 &,          0BD8 |, 33D8 .W, 89DA T>A,                               HEX 6 NFAMILY WBO FF4E (R-, 8B46 (R@, 83EB #-, 8B76 (R>I,              875E (XCHG,  8776 (EX,    B8 ROP SET,  90 ROP ><,        2 NFAMILY BBO B4 #FN, CD #INT, B8 BWO #@, : DOS, 21 #INT, ;     0 TO .TEST     DECIMAL                                                                                                          : XEP POP SWAP PUSH PUSH EX POP ; | : ;EX EX A" ?" DROP ;       : IN_NUM PUSH : POP C, DOES> COUNT SWAP PUSH PUSH OVER C@ POP     XOR IF RDROP ;THEN DUP 2 U< IF RDROP THEN ; : ;DROP EX DROP ; : DIGIT? 64 OVER < IF 223 AND 7 - THEN 48 - DUP 0 BASE WITHIN ; | : M*+ -ROT XEP XEP SWAP BASE * + ;                            : TXT- 1- PUSH 1+ POP ;    | : ;RDR OVER C@ EX RDROP ;          | 45 IN_NUM ;NEG? TXT- EX NEGATE ;                              | 36 IN_NUM HEX?  RDROP 16 TO BASE ;                            | 37 IN_NUM BIN?  RDROP 2 TO BASE ;                             | 35 IN_NUM DIEZ? ROT 1 OVER U< IF RDROP TO BASE 0 THEN -ROT ;  | 94 IN_NUM ?C^    TXT- ;RDR 31 AND M*+ ;                       | 39 IN_NUM ?C'    TXT- ;RDR M*+ ;  |                           : 1CHAR HEX? BIN? DIEZ? ?C^ ?C' ;RDR DIGIT? IF M*+ RDROP THEN ; : ATOI 0 SWAP COUNT ;NEG? 10 ;BASE ;EX                              BEGIN DUP WHILE 1CHAR TXT- REPEAT ;                                                                                         META EXIT ;M    META (# [LIT] LIKE (: IS DO:  META (-BR -IF     META (BR SKIP   META (?BR IF  META (BR AGAIN  META (?BR UNTIL   TO FORTH                                                        ' IF  3COPY CALL  ' IF   3COPY #IF  META (CAL CALL              ' DO  3COPY FOR   ' NEXT 3COPY NEXT  -2 ALLOT ' >NEXT< DW,      META (FOR FOR   META (-NX NEXT      META (#BR #IF               META (?BR WHILE  LIKE (DZ   $ 12DE !                             0M] @+ DROP #IF EXEC ;THEN DROP; ;M  SAVE2     \ DEFER          0M] ;M    DUP 1M] !+ DROP; [   2M] @+ DROP; [  \ QUAN           0M] !+ DROP; [      1M] @+ DROP; [             \ VALUE          0M] @+ DROP; [                                 \ CONSTANT      <% 1 MAKER CONSTANT ,   2 MAKER VALUE ,     3 MAKER QUAN ,         IS CREATE  1 MAKER DEFER , : VARIABLE CREATE 0 DW, ; %>      TO VFORTH                                                         : ;code POP TO CFA ;   0 VALUE LATEST     : STR @+ SWAP ;       0 QUAN H      0 VALUE CFA    0 VALUE CNTC                     : F_KEY 1 SP@ OVER HREAD ;        : F_EMIT SP@ 1 HWRITE NIP ;   : STD_?KEY  D0 D0 DO_DOS ;                                                                                                       0 VALUE HANDLE                                                  0 VALUE AXREG   0 VALUE DXREG                                  : D0 0 0 ;  \ IO KERNEL FUNCTIONS                               : DO_DOS A PUSH DOS TO AXREG  A TO DXREG  POP A! ;              : DO_HANDLE PUSH HANDLE POP DO_DOS ;                            : HFSIZE D0 $ 4202 DO_HANDLE ;  : HCLOSE D0 $ 3E00 DO_HANDLE ;  : HREAD $ 3F00 DO_HANDLE ;        : HWRITE $ 4000 DO_HANDLE ;   : BLKPOS 1K M* $ 4200 DO_HANDLE ; : FOPEN A D0 $ 3D02 DO_DOS ;  : RBLK BLKPOS 1K HREAD ;          : WBLK BLKPOS 1K HWRITE ;                                                                                                                                                                                                                                                                     TO ASSEMBLER        : +, AX BX ADD, ;     : X, $ E587 , ;       : 1+, BX INC, ;     : 1-, BX DEC, ;       : ADROP, AX POP, ;    : ADUP, AX  PUSH, ; : DROP, BX POP, ;     : ZCARRY, CLC, ;      : #-, #, BX SUB, ;  : -, AX BX SUB, ;    : CARRY?, BX BX SBB, ; : DST!, DX POP, ;   : DST@, DX PUSH, ;    : CNT!, CX POP, ;     : DUP, BX PUSH, ;   : @, 0 /BX AX MOV, ;  : !, AX  0 /BX MOV, ; : WSWP, AX DI XCHG, ;  : &, AX BX AND, ;  : ^, AX BX XOR, ;     : @I+, LODSW, ;     : SWP, AX BX XCHG, ;  : R@, 0 /BP AX MOV, ; : R-, 0 /BP DEC, ;  : 0-, BX BX OR, ;     : #@, #, AX MOV, ;    : #FN, #, AH MOV, ; : C@I+, AL LODS, ;    : 2*, 1 #, BX SHL, ;  : |, AX BX OR, ;    : DOS, $ 21 INT, ;    : @W, 0 /DI AX MOV, ; : W+, SCASW, ;      : 2/C, 1 #, BX RCR, ; : ISWP, AX SI XCHG, ; : DJP, 0 /DI JMP, ; : .W, 0 /DI AX LEA, ; : !W, AX 0 /DI MOV, ; : /CODE NEXT, END-CODE ; TO FORTH                                                                                                                                                               ( ASM FORWARD)   | 80 CONSTANT 2L                               2L | WARY BRANCHES  | : ASM-RESET 2 TO FLAGS  0 TO DISP ;       | : FBI 0 2L                                                        FOR I BRANCHES 0 @SWAP IF I 4 #. WHAT? 1+ THEN NEXT                ?DUP IF DUP CR 4 #. A" UNRESOLVED !" THEN ;              | : ^BRANCH TOKEN (DNUM DUP 2L U< 0= A"  BR#? " BRANCHES ;      | : FB, ^BRANCH DUP 0 @SWAP A" REDEFINED! " HP SWAP! DW, ;      | : ^< ^BRANCH 0 @SWAP ;        : L,? HP FB, ;                  : JMP,? E9 DB, L,? ;     : CALL,? E8 DB, L,? ;                  : FB: ^< THEN, ;  ( RESOLVE FORWARD BRANCH NUMBER)              | : FL?      ( A - A) 2- @ OVER - A" LBL? " ;                   | : WREL-FIX?  ( A -) BEGIN,  OVER  3 - C@ FE AND E8 =                      IF  OVER - THEN SWAP 2- ! ;                         : FL: ^< DUP  FL?  WREL-FIX? ;  : J,? NOT FB, ;                                                                                                                                                 CODE XCHG 0 /BP BX XCHG, NEXT, END-CODE : X, $ E587 , ;         \ CODE XPE X, AX POP, BX PUSH, SI PUSH, X,                      \            AX SI XCHG, BX POP, NEXT, END-CODE                 CODE XPE X, AX POP, AX SI XCHG, AX BX XCHG,                                AX PUSH, BX PUSH, X, BX POP, NEXT, END-CODE          : XEP XPE POP ;                                                 \ : XEP XCHG PUSH EX POP ;                                      \ : XEP POP SWAP PUSH PUSH EX POP ;                             : STR+ TUCK - XEP + ;                                                                                                           : MSCAN BLWORD DROP $ 100  HERE OVER -                              BEGIN HERE COUNT TO -TEXT DUP 1+ WHILE STR+ OVER .H               1 STR+ REPEAT DROP 2DROP ;                                                                                                                                                                                                                                267 LOAD                                                        247 LOAD PRUNE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -HEADERS : INCLUDES DUP PUSH AND POP = ;                        : LIKE ' @ ;  0 0 4 FAMILY VALUE  WP NP NAM TARG                : BITS. 2 ;BASE . ; : FLD CREATE , DOES> @ WP + @ ;             2 -2 4 FAMILY FLD  LNK COD DAT FLG                              CREATE STAB LIKE W| DW,  LIKE CLC, DW, LIKE ROL, DW,   |        : .OP  DAT .H FLG BITS. ;  : ?FIND STAB 3 ROT TO SCAN 1+ ;      : ;L BEGIN ?DUP WHILE DUP TO NP N>C TO WP EX LNK REPEAT RDROP ; : .WORDS  CONTEXT @ ;L  BEGIN EX COD ?FIND  2- 0=                   IF NP ID. .OP  KEY DROP THEN   AGAIN ;                      : .IN DUP TO TARG 0; CONTEXT @ ;L BEGIN EX COD ?FIND                FLG TARG INCLUDES AND IF NP ID. THEN AGAIN ;                : .UNUSED CONTEXT @ ;L BEGIN EX COD ?FIND 2- 0= FLG 1 AND 0=        AND IF NP ID. .OP THEN AGAIN ;                              : HLP ' DUP TO WP @ ?FIND 0; .OP ;   PRUNE                                                                                                                                                      CREATE TT   PPR, AX|    NOT, AX| R| W|                              TESTA,  1 DB,  J, Z|                                            NIF, ADD, W| AX| BX'| R| THEN,                                                                                                  RCR, W| BX| R|      RCR, W| R| AX|                              SHL, W| DX| R|      RCL, W| BX| R|  J, N| C|                                                                                        NIF, SUB, W| BX| AX'| R|  INCR, DX| THEN,                                                                                  INCR, AX|   INCR, CX|   INCR, DX|  INCR, BX|                    INC, W| AX| R|     POP, AX| R|                               \ TT $TEST                                                      \ EADD, /BX CX'| W|                                             \ 4 NFAMILY QUAN 4 CHETRI 5 PET 6 SHEST  7 SEDEM  EXIT                                                                                                                                               ADD, OR, ADC, SBB, AND, SUB,                               ADDA, 0, ORA, 0, ADCA, 0, SBBA, 0, ANDA, 0,   SUBA, 0,          XORA, 0, CMPA, 0,                                               EXA, INCR, DECR, PPR, PHR,                                      RET+, Z, RETF+, Z,                                                                 J, 0, JS, 0, LPNZ, 0,  LPZ, 0, LP, 0,        JCXZ, 0, CALL, Z,  JMP, Z,  JMPFI, Z, Z, CALLFI, Z, Z,                                                                          TESTI, 0,   INT, 0, IN|P, 0,  OUT|P, 0, IN|D, OUT|D,            ADD#, 0, ADC#, 0, SBB#, 0,  SUB#, 0, CMP#, 0,                   AAM,  AAD,  ROL, ROR, RCL, RCR, SHL, SHR, SAR, INC,             DEC, NOT, NEG, MUL, IMUL, DIV, IDIV, TEST, XCHG, MOV, XOR, CMP, -->                                                                                                                                                                                                                                                                      ADDI, 0, ORI, 0, ADCI, 0, SBBI, 0, ANDI, 0,            SUBI, 0, XORI, 0, CMPI, 0,                                      LD#, 0, LDI, Z,  LDA, Z, STA, Z,     POP,                       TESTA, 0,                         PUSH, CALLFO, JMPFO, CALLO,   JMPO, LES, LDS,  LEA, MVSG,                                     MOVS, CMPS, STOS, LODS, SCAS,                                   CLC, STC, CLI, STI, CLD, STD, HLT, CMC, IRET, SAHF, LAHF, INTO, RET, RETF, CBW, CWD, WAIT, PHF, PPF, INT3, XLAT,                PH|ES, PH|CS, PH|SS, PH|DS,     PP|ES, PP|CS, PP|SS, PP|DS,     ES:, CS:, SS:, DS:,  DAA, DAS, AAA, AAS, LOCK, REPNZ, REPZ,     Z, Z, Z, Z, Z, Z, Z,                                                                                                                                                                                                                                                                                                                                                                            ( 15.11.2014  ASM DESA1)     MARKER -ASM F83   : ', ' , ;       : DW, , ;  : ASM/ CSP! ; : DB, C, ;     : @+ STR SWAP ;         : ;GO POP STR PUSH PUSH ;   : (CALL POP @+ PUSH PUSH ;          ' IF @ CODE, CALL  ', (CALL    ', ,                             \ OPF OPERATION OPA/ADDRESS OPF/FLAGS OPST/START                221 LOAD HEX : LIKE ' @ ;                                       0 0 4 FAMILY QUAN OPA OPFR OPSF CNT                             | : W,: CREATE DW, OPF DW, ; | : HP HERE 2+ ; : RW, HP - DW, ;  : CODE HEADER HP DW, ASM/ ;          : SHORT? -80 80 WITHIN ;   | : ;OP DUP 2+ TO OPSF @ EX  HERE 2- TO OPA AT CNT 1+! ;        | : DW> ;OP DW, ; | : DB> ;OP DB, ;  | : WOP W,: DOES> DW> ;    | : FIX| W,: DOES> @ OPA XOR! ;                                 | : BOP W,: DOES> DB> ;                                         -->                                                                                                                                                                                             \ DFGHDFGHDFG                                                   LIKE bs   1 NM: @ OPF XOR TO OPF ;M | 2 MAKER (FOP DW,          | : FOP (FOP 2* ;   0 1 0C FAMILY FOP                               ?W ?D ?R ?O ?I ?B ?M ?S ?' ?" ?RM ?USED \ .( !!!)           ?D     0 FIX| A|   2 FIX| F|   ?D ?W ?R ?'                      ?R 100 0 8 FAMILY FIX| AX| CX| DX| BX| SP| BP| SI| DI| ?' ?"       800 0 8 FAMILY FIX| AX'| CX'| DX'| BX'| SP'| BP'| SI'| DI'|  ?W 800 0 8 FAMILY FIX| AL'| AH'| CL'| CH'| DL'| DH'| BL'| BH'|     ?" ?' 100 0 8 FAMILY FIX| AL| AH| CL| CH| DL| DH| BL| BH| ?' ?W ?S ?" 800 0 4 FAMILY FIX| ES| CS| SS| DS| ?" ?W ?R ?S        -->                                                                                                                                                                                                                                                                                                                                                                                             ?O ?R 4000 0 4 FAMILY FIX| D0| DB| DW|  R|     600 FIX| /M             100 0 8 FAMILY FIX| X/S X/D P/S P/D /SI /DI /BP /BX      ?O ?R ?B ?I   70 BOP J,  EB BOP JS,                                1 E0 4 FAMILY  BOP  LPNZ, LPZ, LP, JCXZ,                     200 00 8 FAMILY  FIX| O| C| Z| CZ| S| P| L| LE|                          100 FIX| N|       0 FIX| Y|                            ?B 1 E8 2 FAMILY  BOP CALL, JMP,                                        ?M  EA BOP JMPFI,     9A BOP CALLFI,  ?M  ?I                                                                            | : ?A DUP SHORT? 0= A" SHORT?" ;  | : -?A - ?A EX 1- C! ;      | : AGN,   DUP HP - SHORT? ;  : NIF,  0 DB, HERE ;              : THEN,  HERE OVER -?A SWAP ; : RB, HERE 1+ - ?A DB, ;                                                                          -->                                                                                                                                                                                             ( --assembler_i86_opcodes_1 )                  \ A4sep27 AvdH   1 98 8 FAMILY  BOP CBW, CWD, -- WAIT, PHF, PPF, SAHF, LAHF,     08 27 4 FAMILY  BOP DAA, DAS, AAA, AAS,                         1 CC 4 FAMILY  BOP INT3, -- INTO, IRET,  D7 BOP XLAT,           8 C3 2 FAMILY  BOP RET, RETF,   1 AD4 2 FAMILY  WOP AAM, AAD,   01 F0 0E FAMILY  BOP LOCK, -- REPNZ, REPZ, HLT, CMC,  -- --                         CLC, STC, CLI, STI, CLD, STD,               ?W       100 FIX| W'|   0 FIX| B|  1 FIX| W|                      2 A4 6 FAMILY  BOP MOVS, CMPS, -- STOS, LODS, SCAS,           ?D    EC BOP DATA,                                              ?B ?I E4 BOP PORT, ?W ?D          0CD BOP INT,                  ?B  8 C2 2 FAMILY BOP RET+, RETF+,  ?I        -->                                                                                                                                                                                                                                                                               ( --assembler_i86_opcodes_2 )                  \ A4sep27 AvdH   ?M ?D                                                                 02 A0 2 FAMILY  BOP LDA, STA,                             ?M ?D ?I ?W                                                     8 4 8 FAMILY BOP                                                         ADDA, ORA, ADCA, SBBA, ANDA, SUBA, XORA, CMPA,               A8 BOP TESTA,                                             ?W ?R ?I B8 BOP LDI,                                                8 40 4 FAMILY  BOP INCR, DECR, PHR, PPR,                                  90 BOP EXA,                                       ?W    ?B      B0 BOP LD#,                                             ?B                                                        ?S ?I  3 NFAMILY  BOP 06 PHS,  07 PPS,  26 SEG,                 ?S ?R                                                           -->                                                                                                                             ?O ?S     008C WOP MVSG, ?S                                     ?W ?R     1 C4 2 FAMILY  WOP LES, LDS,  8D WOP LEA,              8 00 8 FAMILY WOP ADD, OR, ADC, SBB, AND, SUB, XOR, CMP,        2 84 2 FAMILY WOP TEST, XCHG,   88 WOP MOV,  ?R 8F WOP POP, ?R  ?I     800   80 8 FAMILY  WOP                                             ADDI, ORI, ADCI, SBBI, ANDI, SUBI, XORI, CMPI,    ?B 800 82 8 FAMILY  WOP  ADD#, -- ADC#, SBB#, -- SUB#, -- CMP#, ?B  800 10F6 6 FAMILY WOP  NOT, NEG, MUL, IMUL, DIV, IDIV,          ?I F6 WOP TESTI, ?I 800 FE 2 FAMILY  WOP  INC, DEC, ?W          800 10FF 5 FAMILY  WOP  CALLO, CALLFO, JMPO, JMPFO, PUSH,   ?W  800 00D0 8 FAMILY  WOP  ROL, ROR, RCL, RCR, SHL, SHR, -- SAR,  ?B 800 C0 8 FAMILY WOP                                                  ROL#, ROR#, RCL#, RCR#, SHL#, SHR#, -- SAR#,            ?B ?O  PRUNE DECIMAL                                                                                                                                                                            : U2/ 0 +2/ NIP ;   $ 8000 CONSTANT #SGN                        | : ?S2/  IF CALL #SGN XOR ;THEN THEN U2/ ;                     : ;SWAP EX SWAP ;  1H CONSTANT 1H  0 CONSTANT 0 : 2/ S>D ?S2/ ; : D+ ROT + CALL SWAP 0;  1+ ;THEN XEP +2/ 0< ;                  : DNEGATE OVER IF NOT SWAP ;SWAP THEN NEG ; : D- DNEGATE D+ ;                                                                   : UM*  0 SWAP ;DROP 1H TIMES   \ ?FOR +* NEXT THEN  DROP ;               XEP OVER ODD #IF DROP J THEN +2/ XEP ODD ?S2/ ;        | : D2* CALL XOR ;THEN 2* XEP DUP UM+ ;                         : UM/MOD ;SWAP ;DROP 1H TIMES   \ ?FOR -/ NEXT THEN DROP SWAP ;         XEP D2*  J NEGATE +2/ 0< IF XEP 1+ ;THEN  J + ;         : M+ S>D D+ ;  : D0 0 0 ; : US>D XEP S>D ;                                                                                                                                                                                                                                                                                      : U/MOD 0 SWAP UM/MOD ; : U/ U/MOD NIP ;  : UMOD U/MOD DROP ;   : MU/MOD TUCK U/MOD XEP TO U/MOD ;                              | : *?- 2DUP XOR 0< 0; ABS SWAP ABS EX DNEGATE ;                | : /?- -IF ABS PUSH DNEGATE POP EX DNEGATE THEN ;              : M* *?- UM* ;  : * M* DROP; ; SAVE2 : M/MOD /?- MU/MOD ;       : M/ M/MOD ROT DROP; ; SAVE2   : /MOD US>D M/MOD DROP; ; SAVE2  : / /MOD NIP ; : MOD /MOD DROP; ; SAVE2                         : M*/ PUSH M* POP M/ ; : */ M*/ DROP; ; SAVE2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0 VALUE II        0 VALUE JJ                                    0 VALUE KEYADDR   0 VALUE KEYLEN                                CREATE SARRAY   256 ALLOT   \ STATE ARRAY OF 256 BYTES          : KEYARRAY      KEYLEN MOD   KEYADDR ;                                                                                          : GET_BYTE      + C@ ;                                          : SET_BYTE      + C! ;                                          : AS_BYTE       255 AND ;                                       : RESET_IJ      0 TO II   0 TO JJ ;                             : I_UPDATE      1 +   AS_BYTE TO II ;                           : J_UPDATE      II SARRAY GET_BYTE +   AS_BYTE TO JJ ;          : SWAP_S_IJ                                                         JJ SARRAY GET_BYTE                                                 II SARRAY GET_BYTE  JJ SARRAY SET_BYTE                       II SARRAY SET_BYTE                                          ;                                                               : UP_CHAR DUP  C" a  123 WITHIN IF 32 - THEN ;                  : BLK_UP  BLOCK DUP 1K + SWAP DO I C@ UP_CHAR I C! LOOP             UPDATE FLUSH ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              : RC4_INIT ( KEYADDR KEYLEN -- )                                    256 MIN TO KEYLEN   TO KEYADDR                                  256 0 DO   I I SARRAY SET_BYTE   LOOP                           RESET_IJ                                                        BEGIN                                                               II KEYARRAY GET_BYTE   JJ +  J_UPDATE                           SWAP_S_IJ                                                       II 255 < WHILE                                                  II I_UPDATE                                                 REPEAT          RESET_IJ ;                                  : RC4_BYTE                                                          II I_UPDATE   JJ J_UPDATE                                       SWAP_S_IJ                                                       II SARRAY GET_BYTE   JJ SARRAY GET_BYTE +   AS_BYTE SARRAY GET_BYTE  XOR                                                    ;                                                               HEX                                                             CREATE AKEY   61 C, 8A C, 63 C, D2 C, FB C,                     : TEST   CR   0 DO  RC4_BYTE . LOOP  CR ;                       AKEY 5 RC4_INIT                                                 2C F9 4C EE DC  5 TEST   \ OUTPUT SHOULD BE: F1 38 29 C9 DE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     CREATE TT  HEX      ADD,  ADD, W|  ADD, F|  ADD, F| W|                  ADDA, 0,  ADDA, W'| Z,  PH|ES,  PP|ES,                  OR,    OR, W|   OR, F|   OR, F| W|                                      ORA, 0, ORA, W'| Z,     PH|CS,  0F DB,                  ADC,  ADC, W|  ADC, F|  ADC, F| W|                                      ADCA, 0,  ADCA, W'| Z,  PH|SS,  PP|SS,                  SBB,  SBB, W|  SBB, F|  SBB, F| W|                                      SBBA, 0,  SBBA, W'| Z,  PH|DS,  PP|DS,                  AND,  AND, W|  AND, F|  AND, F| W|                                      ANDA, 0,  ANDA, W'| Z,  ES:, DAA,                       SUB,  SUB, W|  SUB, F|  SUB, F| W|                                      SUBA, 0,  SUBA, W'| Z,  CS:, DAS,                       XOR,  XOR, W|  XOR, F|  XOR, F| W|                                      XORA, 0,  XORA, W'| Z,  SS:, AAA,                       CMP,  CMP, W|  CMP, F|  CMP, F| W|                                      CMPA, 0,  CMPA, W'| Z,  DS:, AAS,     -->               INCR, AX|  INCR, CX|  INCR, DX|  INCR, BX|                      INCR, SP|  INCR, BP|  INCR, SI|  INCR, DI|                      DECR, AX|  DECR, CX|  DECR, DX|  DECR, BX|                      DECR, SP|  DECR, BP|  DECR, SI|  DECR, DI|                       PHR, AX|   PHR, CX|   PHR, DX|   PHR, BX|                       PHR, SP|   PHR, BP|   PHR, SI|   PHR, DI|                       PPR, AX|   PPR, CX|   PPR, DX|   PPR, BX|                       PPR, SP|   PPR, BP|   PPR, SI|   PPR, DI|                      PUSHA, POPA, BOUND,   APRL,   FLG0, FLG1, FLG2, FLG3,           PUSHI, Z,  IMULI, Z,  PUSH#, 0, IMUL#, 0,   INS,  INS, W'|      OUTS,  OUTS, W'|  J, O| 0,  J, N| O| 0,  J, C| 0,  J, N| C| 0,  J, Z| 0,  J, N| Z| 0,  J, CZ| 0,    J, N| CZ| 0,   J, S| 0,     J, N| S| 0,  J, P| 0,  J, N| P| 0,  J, L| 0,       J, N| L| 0,  J, LE| 0,       J, N| LE| 0,                                    -->                                                                                                                             ADDI, 0,  ADDI, W| Z,  ADD#, 0,  ADD#, W| 0,                    TEST,  TEST, W|  XCHG, XCHG, W|                                 MOV, MOV, W|  MOV, F|  MOV, W| F| MVSG, LEA, MVSG, F| POP,      EXA,  EXA, CX|  EXA, DX| EXA, BX|                               EXA, SP| EXA, BP|  EXA, SI| EXA, DI|                            CBW, CWD,  CALLFI, Z, Z, WAIT, PHF, PPF, SAHF, LAHF,            LDA, Z, LDA, W'| Z,  STA, Z,  STA, W'| Z,                       MOVS,  MOVS, W'|  CMPS,  CMPS, W'|                              TESTA, 0,  TESTA, W'| Z,  STOS,  STOS, W'|                      LODS,  LODS, W'|  SCAS,  SCAS, W'|                              LD#, 0,         LD#, CL| 0,     LD#, DL| 0,     LD#, BL| 0,     LD#, AH| 0,     LD#, CH| 0,     LD#, DH| 0,     LD#, BH| 0,     LDI, Z,         LDI, CX| Z,     LDI, DX| Z,     LDI, BX| Z,     LDI, SP| Z,     LDI, BP| Z,     LDI, SI| Z,     LDI, DI| Z,     -->                                                                                                                             ROL#, 0,  ROL#, W| 0,   RET+, Z,  RET,  LES, LDS,               MOVI, 0,  MOVI, W| Z,                                           ENTER, Z, 0,  LEAVE,  RETF+, Z, RETF, INT3, INT, 0, INTO, IRET, ROL, 1|   ROL, 1| W|  ROL, V|   ROL, V| W|                      AAM,  AAD,  0D6 DB,  XLAT,                                      SK0, SK1, SK2, SK3, SK4, SK5, SK6, SK7,                         LPNZ, 0,  LPZ, 0,  LP, 0,  JCXZ, 0,                             IN|P, 0,   IN|P, W'| 0,  OUT|P, 0,  OUT|P, W'| 0,               CALL, Z,  JMP, Z,  JMPFI, Z, Z,  JS, 0,                         IN|D,  IN|D, W'|  OUT|D,  OUT|D, W'|                            LOCK,  0F1 DB,  REPNZ, REPZ, HLT, CMC,  NOT,  NOT, W|           CLC, STC, CLI, STI, CLD, STD,  INC,   INC, W|                                                                                   DECIMAL                                                                                                                                                                                         MARKER -ASM F83 : DW, , ; 221 LOAD HEX : ASM/ CSP! ; : DB, C, ; 0 0 4 FAMILY QUAN OPA OPF OPST CNT                              | : W,: CREATE DW, OPF DW, ;    | : HP HERE 2+ ;   : Z, 0 , ;   : CODE HEADER HP DW, ASM/ ; : RW, HP - DW, ;                    | : ;OP DUP TO OPST @ EX HERE 2- TO OPA AT CNT 1+! ;            | : DW> ;OP DW, ; | : DB> ;OP DB, ;  | : SHORT? -80 80 WITHIN ; | : WOP W,: DOES> DW> ; | : BOP W,: DOES> DB> ;                 | : FIX| W,: DOES> @ OPA XOR! ;                                 ' bs @  1 NM: @ OPF XOR TO OPF ;M                               | 2 MAKER (FOP DW,  | : FOP (FOP 2* ;                           0 1 1H FAMILY FOP  ?W ?D ?B ?RM ?M ?' ?" ?BO ?WO                               ?I ?IB ?IW  ?G0 ?G1 ?G2 ?G3                      : ?S ?G1 ?G2 ?G3 ;                                               -->                                                                                                                                                                                            VOCABULARY DESA         ALSO DESA  TO DESA   \ IW IMMEDIATE WORD\ ?" SECOND REGISTER    \ ' FIRST REGR ONLY  \ IB IMMEDIATE BYTE\ M MEMORY WORD OFFSET  \ RM REG MEMORY  \ S SEGMENT            ?S ?G0  2 0 2 FAMILY FIX|  1| V|  ?S ?G0                            ?D   2 0 2 FAMILY FIX|  A| F|  ?D                           ?M ?' 800 0 8 FAMILY FIX| X/S X/D P/S P/D /SI /DI /BP /BX          600 FIX| /M ?M ?' ?RM  FIX| D0| ?BO 4000 FIX| DB| ?BO        ?WO  8000 FIX| DW| ?WO  ?M ?" 0C000 FIX| R|  ?" ?RM ?W          ?W ?B 100 0 2 FAMILY FIX| B'| W'| ?B 1 0 2 FAMILY FIX|  B| W|   ?' 100 0 8 FAMILY FIX| AX| CX| DX| BX| SP| BP| SI| DI| ?'       ?" 800 0 8 FAMILY FIX| AX'| CX'| DX'| BX'| SP'| BP'| SI'| DI'|  ?W ?S 800 0 4 FAMILY FIX| ES| CS| SS| DS| ?W ?S ?B                 800 0 8 FAMILY FIX| AL'| CL'| DL'| BL'| AH'| CH'| DH'| BH'|  ?" ?' 100 0 8 FAMILY FIX| AL| CL| DL| BL| AH| CH| DH| BH|       ?' ?B                              -->                                                                                          ?B ?G0 ?S                                                       200 00 8 FAMILY FIX|  O| C| Z| CZ| S| P| L| LE|                 100 00 2 FAMILY FIX|  Y| N|   ?IB  70 BOP J,                    ?B    EB BOP JS,                                                   1 E0 4 FAMILY  BOP  LPNZ, LPZ, LP, JCXZ,                     ?IB  ?IW   1 E8 2 FAMILY  BOP CALL, JMP,                                ?WO  EA BOP JMPFI,     9A BOP CALLFI,  ?WO ?IB                                                                          | : ?A DUP SHORT? 0= A" SHORT?" ;  | : -?A - ?A EX 1- C! ;      | : AGN,   DUP HP - SHORT? ;  : NIF,  0 DB, HERE ;              : THEN,  HERE OVER -?A SWAP ; : RB, HERE 1+ - ?A DB, ;                                                                           -->                                                                                                                                                                                                                                                            ?B                                                              1 60 8 FAMILY  BOP  PUSHA, POPA, -- -- FLG0, FLG1, FLG2, FLG3,  8 06 4 FAMILY  BOP  PH|ES, PH|CS, PH|SS, PH|DS,                 8 07 4 FAMILY  BOP  PP|ES, -- PP|SS, PP|DS,                     8 26 4 FAMILY  BOP  ES:, CS:, SS:, DS:,                         8 27 4 FAMILY  BOP  DAA, DAS, AAA, AAS,    0C9 BOP LEAVE,       1 98 8 FAMILY  BOP CBW, CWD, -- WAIT, PHF, PPF, SAHF, LAHF,     1 CC 4 FAMILY  BOP INT3, -- INTO, IRET,  D7 BOP XLAT,           8 C3 2 FAMILY  BOP RET, RETF,   1 AD4 2 FAMILY  WOP AAM, AAD,   01 F0 0E FAMILY  BOP LOCK, -- REPNZ, REPZ, HLT, CMC,  -- --                         CLC, STC, CLI, STI, CLD, STD,               ?W ?WO   02 A0 2 FAMILY  BOP LDA, STA,  ?WO ?I  A8 BOP TESTA,   8 4 8 FAMILY BOP                                                         ADDA, ORA, ADCA, SBBA, ANDA, SUBA, XORA, CMPA,         ?I -->                                                                                                                          2 A4 6 FAMILY  BOP MOVS, CMPS, -- STOS, LODS, SCAS,             2 EC 2 FAMILY  BOP IN|D, OUT|D,                                 2 6C 2 FAMILY  BOP INS, OUTS,      ?IB                          2 E4 2 FAMILY  BOP IN|P, OUT|P,    ?W                                      0CD BOP INT,                                                    06A BOP PUSH#,          ?IW ?W                                  0C8 BOP ENTER,          ?IB                          8 C2 2 FAMILY  BOP RET+, RETF+,                                            068 BOP PUSHI,                                                                                                                  062 WOP BOUND, ?IW                                              063 WOP APRL,                                                                                                        -->                                                                                                                                                                                             ( --assembler_2 )                  \ A4sep27 AvdH               ?I              B8 BOP LDI,                                         8 40 4 FAMILY  BOP INCR, DECR, PHR, PPR,                                    90 BOP EXA,                                     ?W            B0 BOP LD#,                                            -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1 0D8 8 FAMILY WOP SK0, SK1, SK2, SK3, SK4, SK5, SK6, SK7,                    ?S     008C WOP MVSG, ?S                          ?W      1 C4 2 FAMILY  WOP LES, LDS,  8D WOP LEA,                8 00 8 FAMILY WOP ADD, OR, ADC, SBB, AND, SUB, XOR, CMP,        2 84 2 FAMILY WOP TEST, XCHG,                                              88 WOP MOV,                                                     8F WOP POP,                                          2 69 2 FAMILY WOP IMULI, IMUL#,  0C6 WOP MOVI,                 ?W ?I  800 80 8 FAMILY  WOP                                             ADDI, ORI, ADCI, SBBI, ANDI, SUBI, XORI, CMPI,    ?B                                                                    -->                                                                                                                                                                                                                                                                                                                             800   82 8 FAMILY  WOP  ADD#, -- ADC#, SBB#, -- SUB#, -- CMP#,  ?B                                                                800 10F6 6 FAMILY WOP  NOT, NEG, MUL, IMUL, DIV, IDIV,   ?I                    F6 WOP TESTI, ?I                                800   FE 2 FAMILY  WOP  INC, DEC, ?W                            800 10FF 5 FAMILY  WOP  CALLO, CALLFO, JMPO, JMPFO, PUSH,   ?W ?G0 ?S                                                           800 00D0 8 FAMILY  WOP  ROL, ROR, RCL, RCR, SHL, SHR, -- SAR,  ?IB ?S                                                           800 C0 8 FAMILY WOP                                                    ROL#, ROR#, RCL#, RCR#, SHL#, SHR#, -- SAR#,                                                                               PRUNE DECIMAL                                                                                                                                                                                                                                                